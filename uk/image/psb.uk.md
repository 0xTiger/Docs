{
  "date" : "2019-10-11",
  "keywords" :[ "файл psb", "формат файлу psb", "що таке файл psb", "файл", "приклад psb", "розширення файлу psb", "розширення", "формат" ],
  "author" : {
    "display_name" : "Kashif Iqbal"
},
  "draft" : "false",
  "toc" : true,
  "title" :"PSB - формат великого файлу зображення Photoshop",
  "description":"Дізнайтеся про формат файлу PSB та API, які можуть створювати та відкривати файли PSB.",
  "linktitle" : "PSB",
  "menu" : {
    "docs" : {
      "parent" : "image"
}
},
  "lastmod" : "2019-09-10"
}

## Що таке файл PSB?
Adobe Photoshop зберігає файли у двох форматах. Файли розміром 30 000 на 30 000 пікселів зберігаються з розширенням PSD, а файли розміром понад PSD до 300 000 на 300 000 пікселів зберігаються з розширенням PSB, відомим як «Photoshop Big». Більш конкретно, файли PSB можуть мати розмір до 4 EB (понад 4,2 мільярда ГБ) із зображеннями, які мають висоту та ширину до 300 000 пікселів. З іншого боку, PSD-файли можуть мати максимальний розмір до 2 ГБ і розміри зображення 30 000 пікселів.

PSB також відомий як великий формат для Photoshop і підтримує всі функції Photoshop, такі як шари, ефекти та фільтри. Photoshop може конвертувати файл PSB у [PSD](/uk/image/psd/), [JPG](/uk/image/jpeg/) , [PNG](/uk/image/png/), [EPS](/uk/page-description-language/eps/), [GIF](/uk/image/gif/) та інші формати. Великий формат документа Photoshop доступний, якщо ввімкнено функцію панелі обробки файлів у діалоговому вікні налаштувань Photoshop.

## Інформація про формат файлу ##

Формат файлу Photoshop поділено на п’ять основних частин із багатьма маркерами довжини для переходу між розділами.

|Формат файлу
---|
|Заголовок файлу
|Дані режиму кольору
| Ресурси зображень
|Інформація про шар і маску
|(((
Дані зображення
)))

### Заголовок файлу ###

Заголовок файлу має фіксовану довжину 26 байт і містить основні властивості зображення.

Підпис BYTE [4] – дорівнює «8BPS».

Версія WORD [2] – Номер версії, PSD № 1, PSB № 2.

BYTE Reserved [6] – зарезервований і завжди нульовий.

WORD Channels [2] – кількість каналів кольору в зображенні, включаючи альфа-канали. Його значення коливається від 1 до 56.

LONG Rows [4] – висота зображення в пікселях, PSD 1-30 000, PSB 1-300 000.

LONG Columns [4] – ширина зображення в пікселях, PSD 1-30 000, PSB 1-300 000.

WORD Depth [2] – кількість бітів на канал. Підтримувані значення: 1,8,16 і 32.

Режим WORD [2] – колірний режим файлу.

#### Опис режиму ####


|Режим|Опис
---|---|
|0|Растрове зображення (монохромне)
|1|Відтінки сірого
|2|Індексовано
|3|RGB
|4|CMYK
|7|Багатоканальний
|8|Двутональний (півтоновий)
|9|лаб

### Дані режиму кольору ###

Після розділу заголовка файлу слідує розділ даних колірного режиму. Блок починається з ДОВГОГО числа, яке вказує довжину блоку в байтах. Структура даних колірного режиму така:

4 байти – довжина наведених нижче даних кольору.

Змінна – колірні дані

Якщо значення поля режиму в розділі заголовка не є індексованим кольором або дуотоном, довжина блоку буде 0, а після поля довжини не буде даних.

Для індексованих кольорових зображень довжина становитиме 768 байтів, які міститимуть палітру з 256 кольорів. Для duotone дані міститимуть параметри екрана та іншу пов’язану інформацію.

### Ресурси зображень ###

Третій блок після розділу даних колірного режиму – це розділ ресурсів зображення. Перші чотири байти є ДОВГИМ числом, що визначає довжину блоку, за яким слідує ряд блоків ресурсів. Структура блоку ресурсів зображення така:

Тип BYTE [4] – підпис «8BIM»

WORD ID [2] – ID ресурсу зображення. Існує список ідентифікаторів ресурсів, який можна переглянути за довідковим посиланням.

BYTE Ім’я [Змінна] – Ім’я: Рядок Pascal з парною довжиною. ** **

LONG Size [4] – Фактичний розмір даних ресурсу, які слідують.

BYTE Data [Variable}] – дані ресурсу. Він підбитий для рівного розміру.

Нижче наведено короткий опис деяких форматів ресурсів.

**Формат ресурсу сітки та напрямних: ** Інформація про сітку та напрямні зберігається в блоці ресурсів. Ці блоки ресурсів містять 16-байтову сітку та довідковий заголовок, за яким слідують 5-байтові блоки довідкової інформації.

**Формат ресурсу мініатюри:** Інформація про мініатюри зберігається в блоці ресурсів зображення для попереднього перегляду, який складається з 28-байтового заголовка та мініатюри JFIF у RGB.

**Формат ресурсу семплерів кольорів:** Інформація про семплери кольорів зберігається в блоці ресурсів зображення з 8-байтовим заголовком, за яким слідує блок змінної довжини інформації семплерів кольорів.

### Інформація про шар і маску ###

Четвертий блок — це блок інформації про шар і маску, який містить інформацію про шари та маски. Спочатку зберігається інформація шару, а потім інформація маски.

**Інформація про шар:** Інформація про шар починається зі значення LONG, яке показує довжину інформації про шар. Після цього відбувається підрахунок значень WORD, який показує кількість записів шару, які потрібно виконати.

[8] – довжина шарів

[2] – кількість шарів

[Змінна] – інформація про кожен шар.

[Змінна] – Дані зображення каналу.** **

**Інформація про маску:** Структура маски має такий формат:


|Структура даних|Назва поля| опис
---|---|---|
|СЛОВО| Колірний простір накладання| (Не документовано)
|БАЙТ[8]| Компоненти кольору| Компоненти кольору 4x2 байта
|СЛОВО| Непрозорість| 0#прозорий, 1#непрозорий
|БАЙТ| Вид| 0#інвертовано, 1#захищено, 128#використовувати збережене значення
|БАЙТ| прокладка| встановити на нуль

### Дані зображення ###

Останній розділ містить піксельні дані зображення. Дані зображення зберігаються як серія послідовностей у площинах, тобто спочатку всі червоні дані, потім усі зелені дані тощо. WORD на початку кожного рядка показує розмір у байтах, пов’язаний з кожним рядком сканування.

[2] – Метод стиснення:

[Змінна] – дані зображення в плоскому порядку, тобто RRRR, GGGG, BBBB тощо.

Методи стиснення:

0 – Raw Дані зображення

1 – RLE стиснутий

2 – Zip без передбачення

3 – Zip з прогнозом

## Посилання ##

* [Формат файлу PSB – від Adobe](https://www.adobe.com/devnet-apps/photoshop/fileformatashtml/)
* [PSB – Вікіпедія](https://en.wikipedia.org/wiki/Adobe_Photoshop#File_format)

