{
  "date" : "2019-10-11",
  "author" : {
    "display_name" : "Kashif Iqbal"
},
  "draft" : "false",
  "toc" : true,
  "title" :"MSG - формат електронної пошти Microsoft Outlook",
  "description":"Дізнайтеся про формат файлу MSG та API, які можуть створювати та відкривати файли MSG.",
  "linktitle" : "MSG",
  "menu" : {
    "docs" : {
      "parent" : "email"
}
},
  "lastmod" : "2019-09-10"
}

## Що таке файл MSG?

MSG – це формат файлу, який використовується [Microsoft Outlook](https://products.office.com/en-us/outlook/email-and-calendar-software-microsoft-outlook?rtc#1) і Exchange для зберігання електронних повідомлень , контакти, зустріч або інші завдання. Такі повідомлення можуть містити одне або кілька полів електронної пошти з відправником, одержувачем, темою, датою та тілом повідомлення або контактною інформацією, відомостями про зустрічі та однією чи кількома специфікаціями завдань. Властивості, які складають об’єкт Message, в тому числі також є частиною файлу MSG. Файл MSG містить заголовки, основний текст повідомлення та гіперпосилання у вигляді звичайного тексту ASCII. Файли MSG також підходять для програм, яким потрібен інтерфейс програмування повідомлень Microsoft (MAPI).

## Структура файлу MSG

Формат CFB_3 є основою файлу MSG. Парадигма заснована на концепціях сховищ і потоків, досить близьких до каталогів і файлів. Тому основною відмінністю в першому є вся ієрархія, упакована в окремий файл, який називається складеним файлом. Об’єкти складають файли повідомлень і складаються з однієї властивості або її колекцій. Ця здатність дозволяє програмам зберігати складні структуровані дані в одному файлі. Цей формат також визначає кілька сховищ, кожне сховище представляє об’єкт Message як головний компонент. Ці сховища містять ряд потоків, що представляють властивості цього компонента. Також можливе вкладене зберігання.

## Властивості Mapi

На верхньому рівні файлу .msg сховища містять потоки, у яких зберігаються властивості. Властивості можна класифікувати наступним чином:

* Властивості фіксованої довжини
* Властивості змінної довжини
* Багатозначні властивості

Незалежно від категорії, властивість або позначається, або має назву. Однак відповідна інформація про відображення потрібна для іменованих властивостей, як зазначено в їх сховищі відображення.

## Сховища

Сховища складають ключові компоненти об’єкта Message. Формат файлу MSG визначає такі сховища:

## Структура верхнього рівня

Об'єкт повідомлення представляє весь верхній рівень формату файлу MSG. Залежно від типу, властивостей, кількості об’єктів одержувача та вкладення об’єкт повідомлення може мати різні сховища потоку у відповідному файлі .MSG.

### Зв'язок з іншими структурами

Формат файлу Msg має такі зв’язки з іншими структурами:

* Основою .msg є двійковий формат складеного файлу.
* У цьому форматі використовуються властивості, які використовуються протоколом об’єктів повідомлень і вкладень.

## Варіанти уникнення форматів MSG

Об’єкт повідомлення можна спільно використовувати між клієнтами або сховищами повідомлень, які використовують файлову систему .msg. Є кілька обставин, за яких зберігання об’єкта повідомлення у форматі файлу .msg було б недоречним. Наприклад:

* У разі підтримки великого автономного архіву краще використовувати повнофункціональний формат, у якому перегляди можна відобразити точніше.
* Якщо одержувач невідомий, можливо, формат не підтримується одержувачем, і може бути доставлено приватне або нерелевантне.

## Приклад файлу MSG

Щоб отримати уявлення про те, як виглядає файл MSG, ви можете завантажити [зразок файлу MSG](https://products.conholdate.app/viewer/view/mL7cmq6qYbcNG329P/sample-msg-file.msg) і відкрити на своєму комп’ютер, щоб переглянути його вміст.

## Список літератури

* [[MS-OXMSG]: формат файлу Outlook MSG](https://msdn.microsoft.com/en-us/library/cc463912(v#exchg.80).aspx)

