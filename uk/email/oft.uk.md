{
  "date" : "2019-10-11",
  "author" : {
    "display_name" : "Kashif Iqbal"
},
  "draft" : "false",
  "toc" : true,
  "title" :"OFT - файл шаблону електронної пошти Microsoft Outlook",
  "description":"Дізнайтеся про формат файлу OFT та API, які можуть створювати та відкривати файли OFT.",
  "linktitle" : "OFT",
  "menu" : {
    "docs" : {
      "parent" : "email"
}
},
  "lastmod" : "2019-09-10"
}

## Що таке файл OFT?

Файли з розширенням .oft — це файли шаблонів, створені за допомогою Microsoft Outlook. Попередньо відформатований набір макетів для шаблонів повідомлень потім використовується для надсилання електронних листів із загальною інформацією для економії часу. Такі файли можна створити, створивши нове повідомлення електронної пошти, додавши необхідну інформацію, а потім використавши спадне меню «Зберегти як шаблон Office» (.oft) із Microsoft Outlook. Користувачі можуть відкривати файли OFT, двічі клацнувши їх, і вони відкриються у відповідній програмі в цій конкретній системі.

## Структура файлу OFT ##

В основі формату файлу .OFT використовується формат файлу [MSG](/uk/email/msg/). Єдина відмінність полягає в тому, що файли OFT мають CLSID_TemplateMessage ({0006F046-0000-0000-C000-000000000046}) як клас зберігання (WriteClassStg), тоді як файли MSG використовують CLSID_MailMessage ({00020D0B-0000-0000-C000-000000000046}).

Формат CFB_3 є основою файлу MSG. Парадигма заснована на концепціях сховищ і потоків, досить близьких до каталогів і файлів. Тому основною відмінністю в першому є вся ієрархія, упакована в окремий файл, який називається складеним файлом. Об’єкти складають файли повідомлень і складаються з однієї властивості або її колекцій. Ця здатність дозволяє програмам зберігати складні структуровані дані в одному файлі. Цей формат також визначає кілька сховищ, кожне сховище представляє об’єкт Message як головний компонент. Ці сховища містять ряд потоків, що представляють властивості цього компонента. Також можливе вкладене зберігання.

### Властивості OFT

На верхньому рівні файлу .msg сховища містять потоки, у яких зберігаються властивості. Властивості можна класифікувати наступним чином:

* Властивості фіксованої довжини
* Властивості змінної довжини
* Багатозначні властивості

Незалежно від категорії, властивість або позначається, або має назву. Однак відповідна інформація про відображення потрібна для іменованих властивостей, як зазначено в їх сховищі відображення.

### Сховища OFT

Сховища складають ключові компоненти об’єкта Message. Формат файлу MSG визначає такі сховища:

### Структура верхнього рівня

Об’єкт повідомлення представляє весь верхній рівень формату файлу повідомлення. Залежно від типу, властивостей, кількості об’єктів одержувача та вкладення об’єкт повідомлення може мати різні сховища потоку у відповідному файлі .MSG.

#### Зв'язок з іншими структурами

Формат файлу MSG/OFT має такі зв’язки з іншими структурами:

* Основою .msg є двійковий формат складеного файлу.
* У цьому форматі використовуються властивості, які використовуються протоколом об’єктів повідомлень і вкладень.

## Список літератури

* [[MS-OXMSG]: формат файлу Outlook MSG](https://msdn.microsoft.com/en-us/library/cc463912(v#exchg.80).aspx)

