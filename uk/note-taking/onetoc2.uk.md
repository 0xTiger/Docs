{
  "date" : "2019-10-11",
  "author" : {
    "display_name" : "Kashif Iqbal"
},
  "draft" : "false",
  "toc" : true,
  "title" :"ONETOC2 - формат файлу Microsoft OneNote",
  "description":"Дізнайтеся про формат файлу ONETOC2 та API, які можуть створювати та відкривати файли ONETOC2.",
  "linktitle" : "ONETOC2",
  "menu" : {
    "docs" : {
      "parent" : "note-taking"
}
},
  "lastmod" : "2019-09-10"
}

## Що таке ONETOC2? ##

Ті, хто працював із програмою [Microsoft OneNote](https://products.office.com/en-us/onenote/digital-note-taking-app), можливо, помітили наявність файлів .onetoc2 у папці блокнота. Microsoft OneNote створює двійковий файл .onetoc2 як зміст для збереження індексу про порядок різних розділів нотаток у блокноті. Блокнот — це набір файлів розділів, які зберігаються в одному каталозі. Файл .onetoc2 використовує набір властивостей для визначення таких параметрів, як порядок розділів у блокноті та колір блокнота.

Коли ви створюєте блокнот у OneNote 2016, він автоматично зберігається в новому форматі файлу 2010–2016. Цей формат знадобиться, якщо ви хочете, щоб усі функції OneNote 2016, як-от математичні рівняння та зв’язані нотатки, працювали належним чином.

## Формат файлу ONETOC2 ##

Формат файлу .onetoc2 представлено як формат файлу сховища версій OneNote і являє собою набір структур, які визначають сховище версій, організоване в простори об’єктів із перехресними посиланнями, що містить об’єкти з наборами властивостей і містить журнал транзакцій для забезпечення цілісності файлів у асинхронних пише. Повні специфікації для формату файлу .onetoc2 доступні [онлайн](https://msdn.microsoft.com/en-us/library/dd951288(v#office.12).aspx), і їх можна використовувати для розробки програм .

### Структура файлу ###

Файл сховища версій ПОВИНЕН починатися зі структури **Заголовка**. Залишок файлу розділено на блоки байтів, де розмір і структура кожного блоку вказуються полем, яке посилається на нього. Блок доступний, якщо на нього посилається структура **Header** або якщо на нього посилається поле в іншому доступному блоці. Дані поза структурою **Header** і будь-які доступні блоки ПОВИННІ ігноруватися.

Усі структури вирівнюються на межі 1 байт. Усі цілі числа мають знак, якщо не вказано інше. Усі поля мають формат [little-endian](https://msdn.microsoft.com/en-us/library/dd773246(v#office.12).aspx#gt_079478cb-f4c5-4ce5-b72b-2144da5d2ce7), якщо не вказано інше.

#### Заголовок ####

Заголовок файлу .ONE складається з фрагментів, які містять різні унікальні ідентифікатори та поля для представлення інформації про файл, як показано нижче:

`guidFileType (16 байтів):` GUID, який визначає тип файлу сховища версій. ПОВИННО бути одним із значень із наведеної нижче таблиці.

|Формат файлу|Значення
--- | --- |
|.one|{7B5C52E4-D88C-4DA7-AEB1-5378D02996D3}
|.onetoc2|{43FF2FA1-EFD9-4C76-9EE2-10EA5722765F}

`guidFile (16 байт):` GUID, який визначає ідентичність цього файлу сховища версій. ПОВИНЕН бути унікальним у всьому світі.

`guidLegacyFileVersion (16 байтів):` ПОВИНЕН бути "{00000000-0000-0000-0000-000000000000}" і ПОВИНЕН ігноруватися.

`guidFileFormat (16 байтів):` GUID, який вказує, що файл є файлом сховища версій. МАЄ бути "{109ADD3F-911B-49F5-A5D0-1791EDC8AED8}".

`ffvLastCodeThatWroteToThisFile (4 байти):` Ціле число без знаку. ПОВИННО бути одним із значень у наведеній нижче таблиці залежно від типу файлу.

|Формат файлу|Значення
--- | --- |
|.one|0x0000002A
|.onetoc2|0x0000001B

`ffvOldestCodeThatHasWrittenToThisFile (4 байти):` Ціле число без знаку. ПОВИННО бути одним із значень у наведеній нижче таблиці, залежно від формату цього файлу.


|Формат файлу|Значення
--- | --- |
|.one|0x0000002A
|.onetoc2|0x0000001B

`ffvNewestCodeThatHasWrittenToThisFile (4 байти):` Ціле число без знаку. ПОВИННО бути одним із значень у наведеній нижче таблиці залежно від формату цього файлу.
:


|Формат файлу|Значення
--- | --- |
|.one|0x0000002A
|.onetoc2|0x0000001B

`ffvOldestCodeThatMayReadThisFile (4 байти):` Ціле число без знаку. ПОВИННО бути одним із значень у наведеній нижче таблиці, залежно від формату цього файлу.


|Формат файлу|Значення
--- | --- |
|.one|0x0000002A
|.onetoc2|0x0000001B

## Посилання ##

* [[MS-ONESTORE] – формат файлу OneNote](https://msdn.microsoft.com/en-us/library/dd951288(v#office.12).aspx)
* [Microsoft OneNote – Вікіпедія](https://en.wikipedia.org/wiki/Microsoft_OneNote#References)

