{
  "date" : "2019-10-11",
  "keywords" :[ "файл mpx", "формат файлу mpx", "що таке файл mpx", "файл", "приклад mpx", "розширення файлу mpx", "розширення", "формат" ],
  "author" : {
    "display_name" : "Kashif Iqbal"
},
  "draft" : "false",
  "toc" : true,
  "title" :"MPX - Microsoft Project Exchange File Format",
  "description":"Дізнайтеся про формат файлу MPX та API, які можуть створювати та відкривати файли MPX.",
  "linktitle" : "MPX",
  "menu" : {
    "docs" : {
      "parent" : "project-management"
}
},
  "lastmod" : "2021-05-07"
}

## Що таке файл MPX? ##

Файл із розширенням .mpx є форматом файлу Microsoft Exchange. Формат файлу MPX був розроблений Microsoft Project (MSP) для полегшення обміну інформацією про проект між MSP та іншими програмами, що підтримують формат файлу MPX, зокрема Primavera Project Planner, Sciforma та Timerline Precision Estimating. Використовуючи файли MPX, ви можете передавати будь-яку інформацію з проекту в іншу систему, наприклад детальну інформацію про призначення ресурсів, інформацію календаря або інформацію з діалогового вікна «Інформація про проект».

Microsoft Project 4.0 представив підтримку для створення та читання форматів файлів MPX, які продовжували використовуватися в Microsoft Project 98. Однак підтримку створення файлів MPX було припинено у випуску Microsoft Project 2000, а версії до Microsoft Project 2010 підтримують лише читання MPX. Формат файлу MPX не підтримується у версіях, пізніших за MSP 2010.

## Формат файлу MPX ##

У цьому розділі наведено огляд специфікацій файлів MPX. Повні специфікації можна знайти в цій [базі знань](https://support.microsoft.com/en-us/office/file-formats-supported-by-project-desktop-face808f-77ab-4fce-9353-14144ba1b9ae) статтю, і можна звернутися за деталями.

### Записи ###

Запис файлу MPX містить інформацію про проект. Існують різні типи записів, де кожен запис має власний порядок. Кожен тип запису ідентифікується за номером запису. Для файлу MPX необхідно містити тип запису File Creation. Інші види записів не є обов'язковими. У наведеній нижче таблиці показано всі типи записів, їхні номери записів і кількість записів, які кожен тип може містити у файлі MPX. Включення записів до файлу MPX має відповідати порядку таблиці з коментарями, вставленими будь-де.

|Назва запису|Номер запису|Максимальна кількість записів
---|---|---|
|Створення файлу (обов'язково)|немає|1
|Налаштування валюти|10|1
|Налаштування за замовчуванням|11|1
|Налаштування дати та часу|12|1
|Визначення базового календаря|20|250
|Базові календарні години|25| 7 на запис визначення базового календаря
|Виняток базового календаря|26| 250 на запис визначення базового календаря
|Заголовок проекту|30|1
|Визначення таблиці текстових ресурсів|140|1- (Або ви можете використати запис визначення таблиці числових ресурсів)
|Визначення таблиці числових ресурсів|41|1
|Ресурс|50|9 999
|Примітки до ресурсів|51| 1 на запис ресурсу
|Визначення календаря ресурсів|55| 1 на запис ресурсу
|Ресурсний календар годин|56| 7 на Календар ресурсів
|Виняток календаря ресурсів| 57|250 на Календар ресурсів
|Визначення таблиці текстового завдання|60|1 (Або ви можете використати запис визначення таблиці числового завдання)
|Визначення таблиці числового завдання|61|1
|Завдання|70|9
|Примітки до завдань|71| 1 на запис завдання
|Повторюване завдання|72| 1 на запис завдання
|Призначення ресурсів|75| 100 за запис Завдання
|Поля робочої групи призначення|76| 1 на запис про призначення
|Назви проектів|80|500
|Клієнтські посилання DDE та OLE|81|500
|Коментарі|0|необмежено

### Структура файлу ###

MPX-файл складається із записів, згаданих вище, які впорядковані всередині файлу заздалегідь встановленим чином. Подробиці про ці типи записів обговорюються нижче.

**Запис про створення файлу (FCR):** Це обов’язковий запис, метою якого є ідентифікація:

* Формат файлу (MPX)
* Символ роздільника списку, який використовується у файлі
* Програма та номер версії, використані для створення файлу
* Номер версії формату файлу MPX, який використовується у файлі
* Кодова сторінка, використана для створення файлу

Це має бути перший запис у файлі. Під час експорту з Microsoft Project роздільник списку вказується в пункті регіональних налаштувань на панелі керування Windows. Запис FCR містить такі поля:

* MPX відразу після символу роздільника списку
* Назва/ідентифікатор програми
* Номер версії файлу
* Кодова сторінка (850, 437, MAC, ANSI)

Наприклад, запис може містити інформацію **MPX, Microsoft Project, 3.0**, яка вказує, що кома використовується як роздільник списку в цьому файлі MPX. Версія формату MPX, яка використовується у файлі, експортована з Microsoft Project версії 3.0.

**Параметри валюти** Цей запис із номером 10 визначає параметри для параметрів валюти в діалоговому вікні «Параметри». Якщо цей запис не включено, використовуються поточні налаштування в діалоговому вікні «Параметри». Роздільники тисяч і десяткових знаків вказуються в пункті регіональних налаштувань на панелі керування Windows.
Поля, включені в цей запис:

* Символ грошової одиниці
* Позиція символу (0 # після, 1 # перед, 2 # після з пробілом, 3 # перед з пробілом)
* Цифри валюти (0,1,2)
* Роздільник тисяч
* Десятковий роздільник

**Приклад:** 10,$,1,2,",",.
У цьому прикладі вказується, що значення валюти включають знак долара ($) перед ними, що дві цифри додаються після десяткової коми, що кома використовується для розділення тисяч, а крапка використовується як десяткова кома. Оскільки роздільник списку включено в поле «Роздільник тисяч», це поле взято в лапки.

**Параметри за замовчуванням:** Цей запис із номером 11 визначає параметри за замовчуванням у діалоговому вікні «Параметри». Якщо тривалість не вказана, для правильного обчислення одиниць тривалості потрібно встановити одиницю тривалості за замовчуванням. Якщо цей запис не включено, використовуються поточні налаштування в діалоговому вікні «Параметри».
Поля, включені в цей запис:

* Одиниці тривалості за замовчуванням (0 # хвилин, 1 # годин, 2 # днів, 3 # тижнів)
* Тип тривалості за замовчуванням (0 # не фіксований, 1 # фіксований)
* Робочі одиниці за замовчуванням (0 # хвилин, 1 # годин, 2 # днів, 3 # тижнів)
* Години/день за замовчуванням
* Години за замовчуванням на тиждень
* Стандартна ставка за замовчуванням
* Ставка понаднормової роботи за замовчуванням
* Оновлення статусу завдання оновлює статус ресурсу (0 # ні, 1 # так)
* Розділити поточні завдання (0 # ні, 1 # так)

**Параметри дати й часу:** цей запис із номером 12 визначає параметри параметрів дати й часу в діалоговому вікні «Параметри» та параметр «Формат дати текстової панелі» в діалоговому вікні «Макет». Якщо цей запис не включено, використовуються поточні налаштування в діалоговому вікні «Параметри».
\\Поля, включені в цей запис:

* Порядок дати (0 # місяць/день/рік, 1 # день/місяць/рік, 2 # рік/місяць/день)
* Формат часу (0 # 12 годин, 1 # 24 години)
* Час за умовчанням (кількість хвилин після півночі)
* Роздільник дати
* Роздільник часу
* 0:00 до 11:59 Текст
* 12:00 до 23:59 Текст
* Формат дати (0-14)*
* Формат дати текстової панелі (0 -194)*

**Визначення базового календаря:** Ці записи, що мають номер запису 20, визначають базові календарі та їхні робочі та неробочі дні тижня. Налаштування за замовчуванням використовуються, якщо немає запису протягом дня. Стандартні налаштування: з понеділка по п’ятницю для робочих днів і суботи та неділі для неробочих днів. У цьому записі поле Ім’я є обов’язковим. Для кожного з днів запис 0 означає, що день є неробочим, а запис 1 означає, що день є робочим.
Поля, включені в цей запис:

* Ім'я
* неділя
* понеділок
* вівторок
* Середа
* Четвер
* П'ятниця
* субота

**Базовий календарний час:** Ці записи, що мають номер запису 25, визначають робочі години для днів тижня, якщо вони відрізняються від налаштувань за замовчуванням. Робочі години за замовчуванням: з 8:00 до 12:00 і з 13:00 до 17:00. Кожен запис годин базового календаря відноситься до попереднього запису визначення базового календаря. За кожним записом визначення базового календаря може слідувати до семи таких записів.

* День тижня (1 - 7, де 1 # неділя і 7 # субота)
* З часу 1
* До часу 1
* З часу 2
* До часу 2
* З часу 3
* До часу 3

**Базовий календарний виняток:** Ці записи, що мають номер запису 26, визначають винятки для днів і годин, указаних у попередніх двох типах записів. До 250 із цих записів може слідувати за кожним записом визначення базового календаря. Ці записи повинні бути перераховані в хронологічному порядку. Якщо винятком є один день, ви можете залишити поле До дати пустим. Якщо час не вказано, використовується час за замовчуванням з 8:00 до 12:00 та з 13:00 до 17:00.
Поля, включені в цей запис:

* Від дати
* На сьогоднішній день
* Не працює/Працює (0 # не працює, 1 # працює)
* З часу 1
* До часу 1
* З часу 2
* До часу 2
* З часу 3
* До часу 3

**Заголовок проекту:** Цей запис із значенням запису 30 встановлює глобальні поля проекту, наприклад дату початку та дату завершення проекту. Поля в цьому записі відповідають інформації в діалогових вікнах «Інформація про проект» і «Статистика».
Поля та вкладки, включені в цей запис:

* Вкладка «Проект».
* Компанія
* Менеджер
* Календар (використовується стандартний, якщо немає запису)
* Дата початку (для імпортованого файлу обчислюється або це поле, або наступне поле, залежно від налаштування «Розклад з»)
* Дата закінчення
* Розклад з (0 # початок, 1 # фініш)
* Поточна дата*
* Коментарі
* Вартість
* Базова вартість
* Фактична вартість
* Робота
* Базова робота
* Реальна робота
* Робота
* Тривалість *
* Базова тривалість *
* Фактична тривалість
* Відсоток завершення
* Базовий початок
* Базова обробка
* Фактичний початок
* Фактична обробка
* Початкова дисперсія
* Фінішна дисперсія
* Тема
* Автор
* Ключові слова

**Визначення таблиці текстових ресурсів**: у цьому записі в порядку порядку перераховано поля ресурсів, які імпортуються чи експортуються. Для імпортованих файлів імена мають відповідати іменам полів, які використовуються в Microsoft Project. Для експортованих файлів цей запис надходить із таблиці експорту ресурсу. Необхідно використовувати або цей запис, або запис визначення таблиці числових ресурсів. Під час експорту з Microsoft Project обидва ці записи включені.

**Визначення таблиці числових ресурсів:** цей запис містить упорядкований перелік полів ресурсів, які імпортуються чи експортуються, використовуючи числа, а не імена. Це альтернативний метод ідентифікації полів ресурсу, включених до кожного запису ресурсу, і корисний під час визначення файлу MPX, створеного іншомовним продуктом.

**Ресурс:** ці записи містять інформацію про кожен імпортований або експортований ресурс. Кожен запис ресурсу описує один ресурс. Коли ви імпортуєте інформацію, включені поля визначаються записом визначення текстової таблиці ресурсів або записом визначення таблиці числових ресурсів. Під час експорту інформації включаються поля, перелічені в таблиці експорту ресурсу.

**Примітки щодо ресурсів:** ці записи містять примітки щодо безпосередньо попереднього запису ресурсу. Для нового рядка в нотатці використовується символ ASCII 127. Якщо примітка містить роздільник списку, візьміть примітку в лапки.

**Визначення календаря ресурсу:** ці записи визначають робочі дні для ресурсу, зазначеного в безпосередньо попередньому записі ресурсу. Для імпортованих файлів, якщо немає запису в полі «Назва базового календаря», використовується стандартний. Відсутність запису для певного дня вказує на те, що цей день встановлено за замовчуванням (2). Якщо немає записів визначення календаря ресурсу, стандартний використовується як базовий календар для ресурсу, а за замовчуванням використовується для днів. Для кожного дня запис 0 вказує на те, що день є неробочим, 1 вказує на те, що день є робочим, а 2 вказує на те, що використовується значення за умовчанням.

**Календарні години ресурсу:** ці записи визначають робочі години для ресурсу, які відрізняються від основного календаря, який використовує ресурс. Ці записи застосовуються до запису визначення календаря ресурсу, який безпосередньо передує цьому запису. За кожним записом визначення календаря ресурсу може слідувати до семи таких записів.

**Виняток календаря ресурсів:** Ці записи визначають винятки для днів і годин, указаних у попередніх двох типах записів. До 250 із цих записів може слідувати за кожним записом визначення ресурсного календаря. Ці записи повинні бути перераховані в хронологічному порядку. Якщо винятком є лише один день, ви можете залишити поле До дати пустим. Якщо час не вказано, використовується час за замовчуванням з 8:00 до 12:00 та з 13:00 до 17:00.

**Визначення таблиці текстових завдань:** Цей запис містить перелік полів завдань, які імпортуються чи експортуються. Для імпортованих файлів імена мають відповідати іменам полів, які використовуються в Microsoft Project. Якщо файл експортується, цей запис надходить із таблиці експорту завдання. Під час експорту з Microsoft Project обидва ці записи включені. Поля, які обчислює Microsoft Project, наприклад «Запланований початок» і «Заплановане завершення», ігноруються під час імпорту. Якщо у вас є фіксовані дати початку або завершення завдання, використовуйте поля Тип обмеження та Дата обмеження.

**Визначення числової таблиці завдань:** у цьому записі з використанням чисел, а не імен, упорядковано список полів завдань, які імпортуються чи експортуються. Це альтернативний метод ідентифікації полів завдання, включених до кожного запису завдання, і корисний під час визначення файлу MPX, створеного іншомовним продуктом.

**Завдання:** Ці записи містять інформацію про кожне завдання, яке імпортується або експортується. Кожен запис завдання описує одне завдання. Коли ви імпортуєте інформацію, включені поля визначаються записом визначення таблиці текстового завдання або записом визначення таблиці числового завдання. Коли ви експортуєте інформацію, включаються поля, перелічені в таблиці експорту завдання.

**Примітки до завдання:** ці записи містять примітки про безпосередньо попередній запис завдання. Використовуйте символ ASCII 127, щоб позначити новий рядок у нотатці. Якщо примітка містить роздільник списку, візьміть примітку в лапки.

**Призначення ресурсу**: ці записи містять інформацію про ресурси, призначені для завдання, яке було визначено в попередньому записі завдання. Якщо ви об’єднуєте файли та хочете зберегти інформацію про призначення ресурсів, вам потрібно включити цю інформацію у файл MPX. У разі об’єднання всі наявні призначення в об’єднаних завданнях буде видалено. Якщо ви об’єднуєте файли на основі унікальних ідентифікаторів, ресурси призначаються за допомогою унікальних ідентифікаторів ресурсу, а не ідентифікаторів.

**Поля робочої групи призначення ресурсів:** ці записи містять інформацію, яка зберігається з кожним призначенням для функцій робочої групи Microsoft Project 4.0 і 4.1. Якщо ви використовуєте функції робочої групи, вам потрібно включити цей запис, щоб гарантувати, що жодна інформація не буде втрачена.

**Назви проектів:** ці записи перераховують усі назви посилань DDE, які зберігаються в проекті.

**Клієнтські посилання DDE та OLE:** Ці записи перераховують посилання DDE на проект.

**Коментарі:** Ці записи можна використовувати для додавання коментарів до файлу та можуть відображатися в будь-якій позиції у файлі. Кожен запис коментарів має починатися з «0».

## Проблеми з відкриттям файлу MPX ##

Ось список деяких поширених проблем, які можуть виникнути та спричинити неправильну роботу формату MPX:

* Відсутність супровідного програмного забезпечення
* Пошкоджений файл
* Файл, заражений вірусом
* Немає права доступу в системі для відкриття файлів
* Застарілий диск у вашій системі
* Розширення файлу перейменовано

## Посилання ##

* [MPX – база знань Microsoft](https://support.microsoft.com/en-us/office/file-formats-supported-by-project-desktop-face808f-77ab-4fce-9353-14144ba1b9ae)

