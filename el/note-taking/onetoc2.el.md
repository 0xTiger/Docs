{
  "date" : "2019-10-11",
  "author" : {
    "display_name" : "Kashif Iqbal"
},
  "draft" : "false",
  "toc" : true,
  "title" :"ONETOC2 - Μορφή αρχείου Microsoft OneNote",
  "description":"Μάθετε σχετικά με τη μορφή αρχείου ONETOC2 και τα API που μπορούν να δημιουργήσουν και να ανοίξουν αρχεία ONETOC2.",
  "linktitle" : "ONETOC2",
  "menu" : {
    "docs" : {
      "parent" : "note-taking"
}
},
  "lastmod" : "2019-09-10"
}

## Τι είναι το ONETOC2; ##

Όσοι έχουν εργαστεί με την εφαρμογή [Microsoft OneNote](https://products.office.com/en-us/onenote/digital-note-taking-app) ενδέχεται να έχουν παρατηρήσει την παρουσία αρχείων .onetoc2 στο φάκελο του σημειωματάριου. Το Microsoft OneNote δημιουργεί δυαδικό αρχείο .onetoc2 ως Πίνακας Περιεχομένων για τη διατήρηση ενός ευρετηρίου σχετικά με τη σειρά των διαφορετικών ενοτήτων λήψης σημειώσεων σε ένα σημειωματάριο. Το σημειωματάριο είναι μια συλλογή αρχείων ενοτήτων που αποθηκεύονται στον ίδιο κατάλογο. Το αρχείο .onetoc2 χρησιμοποιεί μια συλλογή ιδιοτήτων για να καθορίσει ρυθμίσεις όπως η σειρά των ενοτήτων μέσα στο σημειωματάριο και το χρώμα του σημειωματάριου.

Όταν δημιουργείτε ένα σημειωματάριο στο OneNote 2016, αποθηκεύεται αυτόματα στη νέα μορφή αρχείου 2010-2016. Θα χρειαστείτε αυτήν τη μορφή εάν θέλετε όλες οι δυνατότητες του OneNote 2016, όπως οι μαθηματικές εξισώσεις και οι συνδεδεμένες σημειώσεις, να λειτουργούν σωστά.

## Μορφή αρχείου ONETOC2 ##

Η μορφή αρχείου .onetoc2 αντιπροσωπεύεται ως Μορφή αρχείου καταστήματος αναθεώρησης του OneNote και είναι μια συλλογή δομών που καθορίζουν έναν χώρο αποθήκευσης αναθεωρήσεων οργανωμένο σε χώρους αντικειμένων με διασταυρούμενη αναφορά, που περιέχει αντικείμενα με σύνολα ιδιοτήτων και περιέχει ένα αρχείο καταγραφής συναλλαγών για τη διασφάλιση της ακεραιότητας του αρχείου σε ασύγχρονες γράφει. Οι πλήρεις προδιαγραφές για τη μορφή αρχείου .onetoc2 είναι διαθέσιμες [online](https://msdn.microsoft.com/en-us/library/dd951288(v#office.12).aspx) και μπορούν να αναφερθούν για την ανάπτυξη εφαρμογών .

### Δομή αρχείου ###

Ένα αρχείο αποθήκευσης αναθεωρήσεων ΠΡΕΠΕΙ να ξεκινά με μια δομή **Header**. Το υπόλοιπο αρχείο χωρίζεται σε μπλοκ byte, όπου το μέγεθος και η δομή κάθε μπλοκ καθορίζεται από το πεδίο που το αναφέρει. Ένα μπλοκ είναι προσβάσιμο εάν αναφέρεται από τη δομή **Header** ή εάν αναφέρεται από ένα πεδίο σε άλλο προσβάσιμο μπλοκ. Δεδομένα εκτός της δομής **Header** και τυχόν προσβάσιμα μπλοκ ΠΡΕΠΕΙ να αγνοηθούν.

Όλες οι δομές είναι ευθυγραμμισμένες σε όρια 1 byte. Όλοι οι ακέραιοι αριθμοί είναι υπογεγραμμένοι εκτός εάν ορίζεται διαφορετικά. Όλα τα πεδία είναι [little-endian](https://msdn.microsoft.com/en-us/library/dd773246(v#office.12).aspx#gt_079478cb-f4c5-4ce5-b72b-2144da5d2ce7), εκτός εάν ορίζεται διαφορετικά.

#### Κεφαλίδα ####

Η κεφαλίδα του αρχείου .ONE αποτελείται από κομμάτια που περιέχουν διαφορετικά μοναδικά αναγνωριστικά και πεδία για την αναπαράσταση των πληροφοριών του αρχείου ως εξής:

`guidFileType (16 byte):` Ένα GUID που καθορίζει τον τύπο του αρχείου αποθήκευσης αναθεωρήσεων. ΠΡΕΠΕΙ να είναι μία από τις τιμές από τον παρακάτω πίνακα.

|Μορφή αρχείου|Τιμή
--- | --- |
|.one|{7B5C52E4-D88C-4DA7-AEB1-5378D02996D3}
|.onetoc2|{43FF2FA1-EFD9-4C76-9EE2-10EA5722765F}

`guidFile (16 byte):` Ένα GUID που καθορίζει την ταυτότητα αυτού του αρχείου αποθήκευσης αναθεώρησης. ΠΡΕΠΕΙ να είναι παγκοσμίως μοναδικό.

`guidLegacyFileVersion (16 byte):` ΠΡΕΠΕΙ να είναι "{00000000-0000-0000-0000-000000000000}" και ΠΡΕΠΕΙ να αγνοηθεί.

`guidFileFormat (16 byte):` Ένα GUID που προσδιορίζει ότι το αρχείο είναι αρχείο αποθήκευσης αναθεωρήσεων. ΠΡΕΠΕΙ να είναι "{109ADD3F-911B-49F5-A5D0-1791EDC8AED8}".

`ffvLastCodeThatWroteToThisFile (4 byte):` Ένας ακέραιος χωρίς υπογραφή. ΠΡΕΠΕΙ να είναι μία από τις τιμές στον παρακάτω πίνακα, ανάλογα με τον τύπο του αρχείου.

|Μορφή αρχείου|Τιμή
--- | --- |
|.ένα|0x0000002A
|.onetoc2|0x0000001B

`ffvOldestCodeThatHasWrittenToThisFile (4 byte):` Ένας ακέραιος χωρίς υπογραφή. ΠΡΕΠΕΙ να είναι μία από τις τιμές στον παρακάτω πίνακα, ανάλογα με τη μορφή αρχείου αυτού του αρχείου.


|Μορφή αρχείου|Τιμή
--- | --- |
|.ένα|0x0000002A
|.onetoc2|0x0000001B

`ffvNewestCodeThatHasWrittenToThisFile (4 byte):` Ένας ακέραιος χωρίς υπογραφή. ΠΡΕΠΕΙ να είναι μία από τις τιμές στον παρακάτω πίνακα, ανάλογα με τη μορφή αρχείου αυτού του αρχείου.
:


|Μορφή αρχείου|Τιμή
--- | --- |
|.ένα|0x0000002A
|.onetoc2|0x0000001B

`ffvOldestCodeThatMayReadThisFile (4 byte):` Ένας ακέραιος χωρίς υπογραφή. ΠΡΕΠΕΙ να είναι μία από τις τιμές στον παρακάτω πίνακα, ανάλογα με τη μορφή αρχείου αυτού του αρχείου.


|Μορφή αρχείου|Τιμή
--- | --- |
|.ένα|0x0000002A
|.onetoc2|0x0000001B

## Βιβλιογραφικές αναφορές ##

* [[MS-ONESTORE] - Μορφή αρχείου OneNote](https://msdn.microsoft.com/en-us/library/dd951288(v#office.12).aspx)
* [Microsoft OneNote - Wikipedia](https://en.wikipedia.org/wiki/Microsoft_OneNote#References)

