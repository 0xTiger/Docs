{
  "date" : "2019-10-11",
  "author" : {
    "display_name" : "Kashif Iqbal"
},
  "draft" : "false",
  "toc" : true,
  "title" :"ONETOC2 – Microsoft OneNote файлов формат",
  "description":"Научете за файловия формат ONETOC2 и API, които могат да създават и отварят файлове ONETOC2.",
  "linktitle" : "ONETOC2",
  "menu" : {
    "docs" : {
      "parent" : "note-taking"
}
},
  "lastmod" : "2019-09-10"
}

## Какво е ONETOC2? ##

Тези, които са работили с приложението [Microsoft OneNote](https://products.office.com/en-us/onenote/digital-note-taking-app) може да са забелязали наличието на .onetoc2 файлове в папката на бележника. Microsoft OneNote създава двоичен файл .onetoc2 като съдържание за поддържане на индекс за подреждането на различни раздели за водене на бележки в бележник. Бележникът е колекция от файлове със секции, които се съхраняват в една и съща директория. Файлът .onetoc2 използва колекция от свойства, за да зададе настройки като ред на секциите в бележника и цвета на бележника.

Когато създавате бележник в OneNote 2016, той автоматично се записва в новия файлов формат 2010-2016. Ще ви е необходим този формат, ако искате всички функции в OneNote 2016, като математически уравнения и свързани бележки, да работят правилно.

## Файлов формат ONETOC2 ##

Файловият формат .onetoc2 е представен като файлов формат на OneNote Revision Store и е колекция от структури, които указват ревизионно хранилище, организирано в обектни пространства с кръстосани препратки, съдържащо обекти с набори от свойства и съдържащо регистър на транзакциите, за да се гарантира целостта на файла в асинхронни пише. Пълните спецификации за файловия формат .onetoc2 са налични [онлайн](https://msdn.microsoft.com/en-us/library/dd951288(v#office.12).aspx) и могат да бъдат използвани за разработка на приложения .

### Файлова структура ###

Файлът за съхранение на ревизии ТРЯБВА да започва със структура **Header**. Останалата част от файла е разделена на блокове от байтове, където размерът и структурата на всеки блок се определят от полето, което го препраща. Един блок е достъпен, ако е посочен от структурата **Header** или ако е посочен от поле в друг достъпен блок. Данните извън структурата **Header** и всички достъпни блокове ТРЯБВА да се игнорират.

Всички структури са подравнени на 1-байтови граници. Всички цели числа са със знак, освен ако не е указано друго. Всички полета са [little-endian](https://msdn.microsoft.com/en-us/library/dd773246(v#office.12).aspx#gt_079478cb-f4c5-4ce5-b72b-2144da5d2ce7), освен ако не е указано друго.

#### Заглавие ####

Заглавката на .ONE файл се състои от части, които съдържат различни уникални идентификатори и полета за представяне на файлова информация, както следва:

`guidFileType (16 байта):` GUID, който указва типа на файла за съхранение на ревизии. ТРЯБВА да бъде една от стойностите от следващата таблица.

|Файлов формат|Стойност
--- | --- |
|.one|{7B5C52E4-D88C-4DA7-AEB1-5378D02996D3}
|.onetoc2|{43FF2FA1-EFD9-4C76-9EE2-10EA5722765F}

`guidFile (16 байта):` GUID, който указва самоличността на този файл за съхранение на ревизии. ТРЯБВА да бъде глобално уникален.

`guidLegacyFileVersion (16 байта):` ТРЯБВА да бъде "{00000000-0000-0000-0000-000000000000}" и ТРЯБВА да се игнорира.

`guidFileFormat (16 байта):` GUID, който указва, че файлът е файл за хранилище на ревизия. ТРЯБВА да бъде „{109ADD3F-911B-49F5-A5D0-1791EDC8AED8}“.

`ffvLastCodeThatWroteToThisFile (4 байта):` Цяло число без знак. ТРЯБВА да бъде една от стойностите в следващата таблица в зависимост от типа на файла.

|Файлов формат|Стойност
--- | --- |
|.one|0x0000002A
|.onetoc2|0x0000001B

`ffvOldestCodeThatHasWrittenToThisFile (4 байта):` Цяло число без знак. ТРЯБВА да бъде една от стойностите в следващата таблица, в зависимост от файловия формат на този файл.


|Файлов формат|Стойност
--- | --- |
|.one|0x0000002A
|.onetoc2|0x0000001B

`ffvNewestCodeThatHasWrittenToThisFile (4 байта):` Цяло число без знак. ТРЯБВА да бъде една от стойностите в следващата таблица, в зависимост от файловия формат на този файл.
:


|Файлов формат|Стойност
--- | --- |
|.one|0x0000002A
|.onetoc2|0x0000001B

`ffvOldestCodeThatMayReadThisFile (4 байта):` Цяло число без знак. ТРЯБВА да бъде една от стойностите в следващата таблица, в зависимост от файловия формат на този файл.


|Файлов формат|Стойност
--- | --- |
|.one|0x0000002A
|.onetoc2|0x0000001B

## Препратки ##

* [[MS-ONESTORE] – файлов формат на OneNote](https://msdn.microsoft.com/en-us/library/dd951288(v#office.12).aspx)
* [Microsoft OneNote – Уикипедия](https://en.wikipedia.org/wiki/Microsoft_OneNote#References)

