{
  "date" : "2019-10-11",
  "keywords" :[ "potm файл", "potm файлов формат", "какво е potm файл", "файл", "potm пример", "potm файлово разширение", "разширение", "формат" ],
  "author" : {
    "display_name" : "Kashif Iqbal"
},
  "draft" : "false",
  "toc" : true,
  "title" :"POTM – шаблонен файл на Microsoft PowerPoint с макроси",
  "description":"Научете за POTM файловия формат и API, които могат да създават и отварят POTM файлове.",
  "linktitle" : "POTM",
  "menu" : {
    "docs" : {
      "parent" : "presentation"
}
},
  "lastmod" : "2019-09-10"
}

## Какво е POTM файл?

Файловете с разширение POTM са шаблонни файлове на Microsoft PowerPoint с поддръжка на макроси. POTM файловете се създават с PowerPoint 2007 или по-нова версия и съдържат настройки по подразбиране, които могат да се използват за създаване на допълнителни презентационни файлове. Тези настройки могат да включват стилове, фонове, цветова палитра, шрифтове и настройки по подразбиране заедно с макроси, които се състоят от персонализирани функции за изпълнение на конкретна задача. Те могат също да бъдат отворени от предишна версия на PowerPoint с инсталирана поддръжка на Open XML документи. POTM файловете могат да се отварят в Microsoft PowerPoint за редактиране като всеки друг файл на PowerPoint.

## Спецификации на файловия формат ##

Файловият формат POTM е базиран на спецификациите на Office OpenXML и наподобява структурата на [PPTX](/bg/presentation/pptx/) файл, който е компресиран [ZIP](/bg/compression/zip/) архив.

Слайдовете в POTM файл могат да съдържат текст, снимки, видеоклипове, графики и други обекти, които могат да бъдат подредени свободно в рамките на страницата. След това POTM шаблоните се използват за създаване на множество файлове, които наследяват всички опции за форматиране на файла. Макросите, съдържащи се във файла POTM, следователно се наследяват и от други презентации. Вграждането им в структурата на документа се извършва чрез Macro Recorder, включен в MS Office, който може да записва командни последователности и да създава макроси, за да ги репликира автоматично.

Файловете, генерирани с Office Open XML файлов формат, са колекция от XML файлове заедно с други файлове, които осигуряват връзки между всички съставни файлове. Тази колекция всъщност е компресиран архив, който може да бъде извлечен, за да видите съдържанието му. За да направите това, просто преименувайте файловото разширение POTM с zip и го извлечете, за да наблюдавате съдържанието му.

Следващите раздели хвърлят малко светлина върху всеки един от тях.

### [Content_Types].xml ###

Това е единственият файл, който се намира на базово ниво при извличане на zip. Той изброява типовете съдържание за частите в пакета. Всички препратки към XML файловете, включени в пакета, са посочени в този XML файл. Следва тип съдържание за част от слайд:
```
<Override PartName#"/ppt/slides/slide1.xml" ContentType#"application/vnd.openxmlformats-officedocument.presentationml.slide+xml"/>
```
Ако трябва да се добавят нови части към пакета, това може да стане чрез добавяне на новата част и актуализиране на всички връзки в рамките на .rels файловете. Трябва да се има предвид, че за такава промяна трябва да се актуализира и Content_Types.xml.

### \_rels (папка) ###

Връзките между другите части и ресурсите извън пакета се поддържат от частта за връзки. Папката Relationships съдържа един XML файл, който съхранява връзките на ниво пакет. Връзките към ключовите части на презентационните файлове се съдържат в този файл като URI. Тези URI идентифицират типа връзка на всяка ключова част с пакета. Това включва връзката с основния офис документ, разположен като ppt/presentation.xml и други части в рамките на docProps като основни и разширени свойства.
```
<Relationship Id#"rId1" Type#"http:~/~/schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument" Target#"ppt/presentation.xml"/>.
```
Всяка част от документа, която е източник на една или повече релации, ще има своя част за релации, където всяка такава част за релации се намира в подпапка \_rels на частта и се наименува чрез добавяне на '.rels' към името на част. Частта с основното съдържание (presentation.xml) има своя част за връзки (presentation.xml.rels). Той съдържа връзки с други части на съдържанието, като slideMaster1.xml, notesMaster1.xml, handoutMaster1.xml, slide1.xml, presProps.xml, tableStyles.xml, theme1.xml, както и URI за външни връзки.

#### Изрична връзка ####

За изрична връзка ресурсът се препраща с помощта на атрибута Id на a<Relationship> елемент. Тоест идентификаторът в източника се свързва директно с идентификатор на елемент на връзка с изрична препратка към целта.

Например един слайд може да съдържа хипервръзка като тази:
```
<a:hlinkClick r:id#"rId2">
```
r:id#"rId2" препраща към следната връзка в частта за връзки за слайда (slide1.xml.rels).
```
<Relationship Id#"rId2" Type#"http:~/~/. . ./hyperlink" Target#"http:~/~/www.google.com/" TargetMode#"External"/>
```
#### Неявна връзка ####

За неявна връзка няма такава директна препратка към `<Relationship> ID`. Вместо това препратката се разбира.

### ppt папка ###

Това е основната папка, която съдържа всички подробности за съдържанието на презентацията. По подразбиране има следните папки:

* \_rels
* тема
* слайдове
* slideLayouts
* slideMasters

и следните xml файлове:

* презентация.xml
* presProps.xml
* tableStyles.xml
* viewProps.xml

## Препратки ##

* [[MS-PPTX] - PPTX файлов формат](https://msdn.microsoft.com/en-us/library/dd926741(v#office.12).aspx)
* [Open Office XML](http://officeopenxml.com/anatomyofOOXML-pptx.php)

