{
  "date" : "2019-10-11",
  "author" : {
    "display_name" : "Kashif Iqbal"
},
  "draft" : "false",
  "toc" : true,
  "title" :"OFT – Шаблонен файл за имейл на Microsoft Outlook",
  "description":"Научете за OFT файловия формат и API, които могат да създават и отварят OFT файлове.",
  "linktitle" : "OFT",
  "menu" : {
    "docs" : {
      "parent" : "email"
}
},
  "lastmod" : "2019-09-10"
}

## Какво е OFT файл?

Файловете с разширение .oft са шаблонни файлове, които се създават с помощта на Microsoft Outlook. Предварително форматираното оформление, зададено за шаблони за съобщения, след това се използва за изпращане на имейли с обща информация, за да се спести време. Такива файлове могат да бъдат генерирани чрез създаване на нов имейл, добавяне на необходимата информация и след това използване на падащото меню Запазване като шаблон на Office (.oft) от Microsoft Outlook. Потребителите могат да отварят OFT файловете, като щракнат два пъти върху тях и те ще се отворят в свързаното приложение на тази конкретна система.

## OFT файлова структура ##

Файловият формат .OFT използва файловия формат [MSG](/bg/email/msg/) в основата си. Единствената разлика е, че OFT файловете имат CLSID_TemplateMessage ({0006F046-0000-0000-C000-000000000046}) като клас за съхранение (WriteClassStg), докато MSG файловете използват CLSID_MailMessage ({00020D0B-0000-0000-C000-000000000046}).

Форматът CFB_3 е основата на MSG файла. Парадигмата се основава на концепциите за съхранение и потоци, доста близки до директориите и файловете. Следователно основната разлика в първия е цялата йерархия, пакетирана в отделен файл, наречен съставен файл. Обектите съставляват файловете със съобщения и се състоят от едно свойство или неговите колекции. Тази възможност улеснява приложенията да съхраняват сложни, структурирани данни в един файл. Този формат също така определя множество хранилища, всяко хранилище представлява обекта на съобщението като основен компонент. Тези хранилища съдържат редица потоци, представляващи свойство на този компонент. Възможно е също влагане на съхранение.

### Свойства на OFT

На най-високото ниво на .msg файла хранилищата съдържат потоци, които съхраняват свойства в тях. Имотите могат да бъдат категоризирани, както следва:

* Свойства с фиксирана дължина
* Свойства с променлива дължина
* Свойства с множество стойности

Независимо от категорията, дадено свойство е или маркирано, или наименувано. Изисква се обаче подходяща информация за картографиране за именувани свойства, както е посочено от тяхното хранилище за картографиране.

### OFT хранилища

Хранилищата представляват ключовите компоненти на обекта Message. Файловият формат MSG посочва следните хранилища:

### Структура от най-високо ниво

Обектът съобщение представлява цялото най-високо ниво на файловия формат Msg. В зависимост от типа, свойствата, броя на получателите и обектите за прикачени файлове, обектът на съобщение може да има различни хранилища на потока в съответния .MSG файл.

#### Връзка с други структури

Файловият формат MSG/OFT има следните връзки с други структури:

* Основата на .msg е двоичен файлов формат на съставен файл.
* Свойствата, използвани от протокола за обекти на съобщения и прикачени файлове, се използват от този формат.

## Препратки

* [[MS-OXMSG]: Outlook MSG файлов формат](https://msdn.microsoft.com/en-us/library/cc463912(v#exchg.80).aspx)

