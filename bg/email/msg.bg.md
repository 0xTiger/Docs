{
  "date" : "2019-10-11",
  "author" : {
    "display_name" : "Kashif Iqbal"
},
  "draft" : "false",
  "toc" : true,
  "title" :"MSG – имейл формат на Microsoft Outlook",
  "description":"Научете за MSG файловия формат и API, които могат да създават и отварят MSG файлове.",
  "linktitle" : "MSG",
  "menu" : {
    "docs" : {
      "parent" : "email"
}
},
  "lastmod" : "2019-09-10"
}

## Какво е MSG файл?

MSG е файлов формат, използван от [Microsoft Outlook](https://products.office.com/en-us/outlook/email-and-calendar-software-microsoft-outlook?rtc#1) и Exchange за съхраняване на имейл съобщения , контакт, среща или други задачи. Такива съобщения могат да съдържат едно или повече имейл полета с подателя, получателя, темата, датата и тялото на съобщението или информация за контакт, подробности за срещи и една или повече спецификации на задачата. Свойствата, които съставляват обекта Message, включително също са част от MSG файла. MSG файлът има заглавки, основно тяло на съобщението и хипервръзки като обикновен ASCII текст. MSG файловете също са подходящи с програмите, които се нуждаят от интерфейса за програмиране на приложения за съобщения на Microsoft (MAPI).

## MSG файлова структура

Форматът CFB_3 е основата на MSG файла. Парадигмата се основава на концепциите за съхранение и потоци, доста близки до директориите и файловете. Следователно основна разлика в първия е цялата йерархия, пакетирана в отделен файл, наречен съставен файл. Обектите съставляват файловете със съобщения и се състоят от едно свойство или неговите колекции. Тази възможност улеснява приложенията да съхраняват сложни, структурирани данни в един файл. Този формат също така определя множество хранилища, всяко хранилище представлява обекта на съобщението като основен компонент. Тези хранилища съдържат редица потоци, представляващи свойство на този компонент. Възможно е също влагане на съхранение.

## Mapi Properties

На най-високото ниво на .msg файла хранилищата съдържат потоци, които съхраняват свойства в тях. Имотите могат да бъдат категоризирани, както следва:

* Свойства с фиксирана дължина
* Свойства с променлива дължина
* Свойства с множество стойности

Независимо от категорията, дадено свойство е или маркирано, или наименувано. Изисква се обаче подходяща информация за картографиране за именувани свойства, както е посочено от тяхното хранилище за картографиране.

## Складове

Хранилищата представляват ключовите компоненти на обекта Message. Файловият формат MSG посочва следните хранилища:

## Структура от най-високо ниво

Обектът на съобщението представлява цялото най-високо ниво на MSG файловия формат. В зависимост от типа, свойствата, броя на получателите и обектите за прикачени файлове, обектът на съобщение може да има различни хранилища на потока в съответния .MSG файл.

### Връзка с други структури

Файловият формат Msg има следните връзки с други структури:

* Основата на .msg е двоичен файлов формат на съставен файл.
* Свойствата, използвани от протокола за обекти на съобщения и прикачени файлове, се използват от този формат.

## Сценарии за избягване на MSG формати

Обектът на съобщението може да се споделя между клиенти или хранилища за съобщения, които използват файловата система .msg. Има няколко обстоятелства, при които съхраняването на обект на съобщение във файлов формат .msg не би било подходящо. Например:

* В случай на поддържане на голям самостоятелен архив, по-добре е да използвате пълнофункционален формат, в който изгледите могат да бъдат изобразени по-прецизно.
* Ако получателят е неизвестен, възможно е форматът да не се поддържа от страната на получателя и може да бъде доставен частен или неподходящ.

## Пример за MSG файл

За да получите представа как изглежда MSG файл, можете да изтеглите [примерен MSG файл](https://products.conholdate.app/viewer/view/mL7cmq6qYbcNG329P/sample-msg-file.msg) и да го отворите на вашия компютър, за да видите съдържанието му.

## Препратки

* [[MS-OXMSG]: Outlook MSG файлов формат](https://msdn.microsoft.com/en-us/library/cc463912(v#exchg.80).aspx)

