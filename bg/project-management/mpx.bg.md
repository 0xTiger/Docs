{
  "date" : "2019-10-11",
  "keywords" :[ "mpx файл", "mpx файлов формат", "какво е mpx файл", "файл", "mpx пример", "mpx файлово разширение", "разширение", "формат" ],
  "author" : {
    "display_name" : "Kashif Iqbal"
},
  "draft" : "false",
  "toc" : true,
  "title" :"MPX - Microsoft Project Exchange файлов формат",
  "description":"Научете за MPX файловия формат и API, които могат да създават и отварят MPX файлове.",
  "linktitle" : "MPX",
  "menu" : {
    "docs" : {
      "parent" : "project-management"
}
},
  "lastmod" : "2021-05-07"
}

## Какво е MPX файл? ##

Файл с разширение .mpx е файлов формат на Microsoft Exchange. MPX файлов формат е разработен от Microsoft Project (MSP), за да улесни обмена на информация за проекта между MSP и други приложения, поддържащи MPX файловия формат, включително Primavera Project Planner, Sciforma и Timerline Precision Estimating. Използвайки MPX файловете, можете да прехвърляте всякакъв вид информация от проект към различна система, като подробна информация за присвояване на ресурси, информация от календара или информация от диалоговия прозорец Информация за проекта.

Microsoft Project 4.0 въведе поддръжка за създаване и четене на MPX файлови формати, които продължиха да се използват чрез Microsoft Project 98. Поддръжката за създаване на MPX файлове обаче преустанови издаването на Microsoft Project 2000 и версиите до Microsoft Project 2010 поддържат само MPX четене. Файловият формат MPX не се поддържа във версии по-късни от MSP 2010.

## MPX файлов формат ##

В този раздел е даден преглед на спецификациите на MPX файла. Пълните спецификации могат да бъдат намерени в тази [База знания](https://support.microsoft.com/en-us/office/file-formats-supported-by-project-desktop-face808f-77ab-4fce-9353-14144ba1b9ae) статия и можете да се обърнете за подробности.

### Записи ###

Записът на MPX файла се състои от информация за проекта. Има различни типове записи, като всеки запис има собствен ред. Всеки тип запис се идентифицира със своя номер на запис. За MPX файл е необходимо да съдържа тип запис за създаване на файл. Други видове записи не са задължителни. Следващата таблица показва всички типове записи, техните номера на записи и броя записи, които всеки тип може да съдържа в MPX файла. Включването на запис в MPX файла трябва да следва реда на таблицата с коментари, вмъкнати навсякъде.

|Име на запис|Номер на запис|Максимален брой записи
---|---|---|
|Създаване на файл (задължително)|няма|1
|Настройки на валутата|10|1
|Настройки по подразбиране|11|1
|Настройки за дата и час|12|1
|Основа календарна дефиниция|20|250
|Основни календарни часове|25| 7 на запис на базова календарна дефиниция
|Основно календарно изключение|26| 250 на запис на базова календарна дефиниция
|Заглавие на проекта|30|1
|Дефиниция на таблица с текстови ресурси|140|1- (Или можете да използвате записа за дефиниция на таблица с цифрови ресурси)
|Дефиниция на таблица с цифрови ресурси|41|1
|Ресурс|50|9 999
|Бележки за ресурсите|51| 1 на запис на ресурс
|Определение на календара на ресурсите|55| 1 на запис на ресурс
|Ресурс Календар часове|56| 7 на календар на ресурсите
|Изключение от календара на ресурсите| 57|250 на календар на ресурсите
|Дефинация на таблица с текстови задачи|60|1 (Или можете да използвате записа за дефиниция на таблица с числени задачи)
|Определение на таблица с числени задачи|61|1
|Задача|70|9
|Бележки към задачите|71| 1 на запис на задача
|Повтаряща се задача|72| 1 на запис на задача
|Присвояване на ресурси|75| 100 на запис на задача
|Полета за работна група за присвояване|76| 1 на запис на задание
|Имена на проекти|80|500
|DDE и OLE клиентски връзки|81|500
|Коментари|0|неограничен

### Файлова структура ###

MPX файлът се състои от записи, споменати по-горе, които са подредени по предварително зададен начин във файла. Подробности за тези типове записи се обсъждат, както следва:

**Запис за създаване на файл (FCR):** Това е задължителен запис, чиято цел е да идентифицира:

* Файлов формат (MPX)
* Използван във файла разделителен знак за списък
* Номер на програмата и версията, използвани за създаване на файла
* Номер на версията на MPX файловия формат, използван във файла
* Кодова страница, използвана за създаване на файла

Това трябва да е първият запис във файла. Когато експортирате от Microsoft Project, символът за разделител на списъка е посочен в елемента Регионални настройки в контролния панел на Windows. FCR запис включва следните полета:

* MPX, последван непосредствено от знака за разделяне на списъка
* Име/идентификатор на програмата
* Номер на версията на файла
* Кодова страница (850, 437, MAC, ANSI)

Например записът може да съдържа информация **MPX, Microsoft Project, 3.0**, която указва, че запетая се използва като символ за разделяне на списък в този MPX файл. Версията на MPX формата, използвана във файла, е експортирана от Microsoft Project версия 3.0.

**Настройки на валутата** Този запис, имащ запис номер 10, определя настройките за валутните опции в диалоговия прозорец Опции. Ако този запис не е включен, се използват текущите настройки в диалоговия прозорец Опции. Разделителите за хиляди и десетични знаци са посочени в елемента Регионални настройки в контролния панел на Windows.
Полетата, включени в този запис, са:

* Символ на валутата
* Позиция на символа (0 # след, 1 # преди, 2 # след с интервал, 3 # преди с интервал)
* Цифри на валутата (0,1,2)
* Разделител на хиляди
* Десетичен разделител

**Пример:** 10,$,1,2,",",.
Този пример указва, че валутните стойности включват знак за долар ($) преди тях, че две цифри са включени след десетичната запетая, че се използва запетая за разделяне на хилядите и че точката се използва като десетична запетая. Тъй като знакът за разделител на списъка е включен в полето за разделител на хиляди, полето е оградено с кавички.

**Настройки по подразбиране:** Този запис, имащ запис номер 11, определя настройките за опциите по подразбиране в диалоговия прозорец Опции. Ако продължителността не е посочена, единицата за продължителност по подразбиране трябва да бъде зададена за правилно изчисляване на единицата за продължителност. Ако този запис не е включен, се използват текущите настройки в диалоговия прозорец Опции.
Полетата, включени в този запис, са:

* Единици за продължителност по подразбиране (0 # минути, 1 # часа, 2 # дни, 3 # седмици)
* Тип продължителност по подразбиране (0 # не е фиксиран, 1 # е фиксиран)
* Работни единици по подразбиране (0 # минути, 1 # часа, 2 # дни, 3 # седмици)
* Часове/ден по подразбиране
* Часове по подразбиране/седмица
* Стандартна ставка по подразбиране
* Ставка за извънреден труд по подразбиране
* Актуализиране на състоянието на задача актуализира състоянието на ресурса (0 # не, 1 # да)
* Разделяне на текущи задачи (0 # не, 1 # да)

**Настройки за дата и час:** Този запис, имащ номер на запис 12, определя настройките за опциите за дата и час в диалоговия прозорец Опции и опцията Формат на датата на текстовата лента в диалоговия прозорец Оформление. Ако този запис не е включен, се използват текущите настройки в диалоговия прозорец Опции.
\\Полетата, включени в този запис, са:

* Ред по дата (0 # месец/ден/година, 1 # ден/месец/година, 2 # година/месец/ден)
* Формат на времето (0 # 12 часа, 1 # 24 часа)
* Час по подразбиране (брой минути след полунощ)
* Разделител за дата
* Разделител за време
* 0:00 до 11:59 Текст
* 12:00 до 23:59 Текст
* Формат на датата (0 -14)*
* Формат на датата на текстовата лента (0 -194)*

**Определение на основния календар:** Тези записи, имащи номер на запис 20, определят основните календари и техните работни и неработни дни от седмицата. Настройките по подразбиране се използват, ако няма запис за ден. Настройките по подразбиране са от понеделник до петък за работни дни и събота и неделя за неработни дни. В този запис полето Име е задължително. За всеки от дните запис 0 показва, че денят е неработен, а запис 1 показва, че денят е работен.
Полетата, включени в този запис, са:

* Име
* Неделя
* понеделник
* вторник
* сряда
* четвъртък
* Петък
* Събота

**Основни календарни часове:** Тези записи, имащи номер на запис 25, указват работните часове за дните от седмицата, ако се различават от настройките по подразбиране. Работното време по подразбиране е от 8:00 ч. до 12:00 ч. и от 13:00 ч. до 17:00 ч. Всеки запис за основни часове в календара се отнася до предходния запис на дефиницията на основния календар. До седем от тези записа могат да следват всеки запис на дефиниция на основния календар.

* Ден от седмицата (1 - 7, където 1 # неделя и 7 # събота)
* От време 1
* До Време 1
* От време 2
* До Време 2
* От време 3
* До време 3

**Основно календарно изключение:** Тези записи, имащи запис номер 26, дефинират изключенията от дните и часовете, посочени в предишните два типа записи. До 250 от тези записи могат да следват всеки запис на дефиниция на основния календар. Тези записи трябва да бъдат изброени в хронологичен ред. Ако изключение е един ден, можете да оставите полето До дата празно. Ако не са посочени часове, се използват часовете по подразбиране от 8:00 до 12:00 и от 13:00 до 17:00.
Полетата, включени в този запис, са:

* От дата
* Към днешна дата
* Неработещ/Работещ (0 # неработещ, 1 # работещ)
* От време 1
* До Време 1
* От време 2
* До Време 2
* От време 3
* До време 3

**Заглавие на проекта:** Този запис, имащ стойност на запис 30, задава глобални полета на проекта, като начална дата на проекта и крайна дата на проекта. Полетата в този запис съответстват на информацията в диалоговите прозорци Информация за проекта и Статистика.
Полетата и разделите, включени в този запис, са:

* Раздел Проект
* Търговско дружество
* Мениджър
* Календар (използван е стандартен, ако няма запис)
* Начална дата (или това поле, или следващото поле се изчислява за импортиран файл, в зависимост от настройката График от)
* Крайна дата
* График от (0 # начало, 1 # финал)
* Текуща дата*
* Коментари
* Цена
* Базови разходи
* Реална цена
* Работа
* Основна работа
* Реална работа
* Работа
* Продължителност *
* Основна продължителност *
* Реална продължителност
* Процент на завършеност
* Базово начало
* Основно покритие
* Реално начало
* Действителен завършек
* Начална вариация
* Финална вариация
* Предмет
* Автор
* Ключови думи

**Дефиниция на таблица с текстови ресурси**: Този запис изброява ресурсните полета, по ред, които се импортират или експортират. За импортираните файлове имената трябва да съвпадат с имената на полетата, използвани в Microsoft Project. За експортирани файлове този запис идва от таблицата за експортиране на ресурси. Трябва да се използва или този запис, или записът за дефиниция на таблицата с числени ресурси. При експортиране от Microsoft Project и двата записа са включени.

**Дефиниция на таблица с числени ресурси: ** Използвайки числа, а не имена, този запис изброява ресурсните полета, по ред, които се импортират или експортират. Това е алтернативен метод за идентифициране на ресурсните полета, включени във всеки запис на ресурс, и е полезен при дефиниране на MPX файл, създаден от продукт на чужд език.

**Ресурс:** Тези записи съдържат информацията за всеки ресурс, който се импортира или експортира. Всеки запис на ресурс описва един ресурс. Когато импортирате информация, полетата, които се включват, се дефинират от записа за дефиниция на таблица с текстови ресурси или записа за дефиниция на таблица с числени ресурси. Когато експортирате информация, полетата, които се включват, са тези, изброени в таблицата за експортиране на ресурси.

**Бележки за ресурси:** Тези записи съдържат бележки за непосредствено предходния запис за ресурси. За нов ред в бележката се използва ASCII символ 127. Ако бележката включва знака за разделител на списъка, оградете бележката в кавички.

**Дефиниция на календара на ресурса:** Тези записи определят работните дни за ресурса, посочен в непосредствено предходния запис на ресурс. За импортирани файлове, ако няма запис за полето Име на основния календар, се използва стандартен. Няма запис за конкретния ден, който показва, че денят е зададен по подразбиране (2). Ако няма записи за дефиниция на календар на ресурс, стандартният се използва като основен календар за ресурса, като се използва по подразбиране за дните. За всеки от дните запис от 0 показва, че денят е неработен, 1 показва, че денят е работен, а 2 указва, че се използва стойността по подразбиране.

**Часове на календара на ресурса:** Тези записи определят работното време за ресурса, което се различава от основния календар, използван от ресурса. Тези записи се отнасят за записа на дефиницията на календара на ресурсите, непосредствено предхождащ този запис. До седем от тези записа могат да следват всеки запис на дефиниция на ресурсен календар.

**Изключение от календара на ресурсите:** Тези записи определят изключенията от дните и часовете, посочени в предишните два типа записи. До 250 от тези записи могат да следват всеки запис на дефиниция на ресурсен календар. Тези записи трябва да бъдат изброени в хронологичен ред. Ако изключението е само един ден, можете да оставите полето До дата празно. Ако не са посочени часове, се използват часовете по подразбиране от 8:00 до 12:00 и от 13:00 до 17:00.

**Дефиниция на таблица с текстови задачи:** Този запис изброява по ред полетата на задачите, които се импортират или експортират. За импортираните файлове имената трябва да съвпадат с имената на полетата, използвани в Microsoft Project. Ако файлът се експортира, този запис идва от таблицата за експортиране на задачата. При експортиране от Microsoft Project и двата записа са включени. Полетата, които се изчисляват от Microsoft Project, като планирано начало и планирано завършване, се игнорират, ако се импортират. Ако имате начални или крайни дати на задачата, които са фиксирани, използвайте полетата Тип ограничение и Дата на ограничение.

**Дефиниция на числова таблица със задачи:** Използвайки числа, а не имена, този запис изброява по ред полетата на задачите, които се импортират или експортират. Това е алтернативен метод за идентифициране на полетата за задачи, включени във всеки запис на задача, и е полезен при дефиниране на MPX файл, създаден от продукт на чужд език.

**Задача:** Тези записи съдържат информацията за всяка задача, която се импортира или експортира. Всеки запис на задача описва една задача. Когато импортирате информация, полетата, които се включват, се дефинират от записа за дефиниция на таблица с текстови задачи или записа за дефиниция на таблица с числени задачи. Когато експортирате информация, полетата, които се включват, са изброените в таблицата за експортиране на задачата.

**Бележки за задачата:** Тези записи съдържат бележки относно непосредствено предходния запис на задача. Използвайте ASCII знак 127, за да посочите нов ред в бележката. Ако бележката включва знака за разделител на списъка, оградете бележката в кавички.

**Присвояване на ресурс**: Тези записи изброяват информация за ресурсите, присвоени на задачата, която е дефинирана в предходния запис на задача. Ако обединявате файлове и искате да се запази информацията за присвояване на ресурси, трябва да включите информацията в MPX файла. Ако обедините, всички съществуващи назначения на обединени задачи ще бъдат изтрити. Ако обединявате файлове въз основа на уникални идентификатори, ресурсите се присвояват с помощта на уникалните идентификатори на ресурси, а не с идентификатори.

**Полета за работна група за присвояване на ресурси: ** Тези записи изброяват информацията, която се съхранява с всяко присвояване за функциите на работната група на Microsoft Project 4.0 и 4.1. Ако използвате функциите на работната група, трябва да включите този запис, за да сте сигурни, че никаква информация не е загубена.

**Имена на проекти:** Тези записи изброяват всички имена на DDE връзки, съхранени в проекта.

**DDE и OLE клиентски връзки:** Тези записи изброяват DDE връзките към проекта.

**Коментари:** Тези записи могат да се използват за добавяне на коментари към файла и могат да се показват във всяка позиция във файла. Всеки запис на коментари трябва да започва с "0."

## Проблеми при отваряне на MPX файл ##

Ето списъка с някои често срещани проблеми, които могат да възникнат и да причинят неправилно функциониране на MPX формата:

* Липса на поддържащ софтуер
* Повреден файл
* Заразен файл поради вирус
* Няма право на достъп в системата за отваряне на файловете
* Остаряло устройство във вашата система
* Разширението на файла е преименувано

## Препратки ##

* [MPX – Microsoft Knowledge Base](https://support.microsoft.com/en-us/office/file-formats-supported-by-project-desktop-face808f-77ab-4fce-9353-14144ba1b9ae)

