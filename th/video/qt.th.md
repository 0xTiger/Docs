{
  "date" : "2021-02-15",
  "author" : {
    "display_name" : "Kashif Iqbal"
},
  "draft" : "false",
  "toc" : true,
  "title" :"รูปแบบไฟล์ QT - ไฟล์ภาพยนตร์ด่วน",
  "keywords" :[ "QT", "วิดีโอ QuickTime", "รูปแบบ qt", "วิธีเล่นไฟล์ qt", "ไฟล์ภาพยนตร์ด่วน", "QTFF", "วิดีโอ", "Apple" ],
  "description":"เรียนรู้เกี่ยวกับรูปแบบไฟล์ QT และ API ที่สามารถสร้างและเปิดไฟล์ QT",
  "linktitle" : "QT",
  "menu" : {
    "docs" : {
      "parent" : "video"
}
},
  "lastmod" : "2021-02-16"
}

## ไฟล์ QT คืออะไร??

ไฟล์ที่มีนามสกุล .qt เป็นไฟล์คอนเทนเนอร์มัลติมีเดียที่ใช้โดยกรอบงาน QuickTime เพื่อจัดเก็บเนื้อหาไฟล์มัลติมีเดีย รูปแบบไฟล์ QuickTime (QTFF) พัฒนาโดย Apple Inc. เป็นไฟล์คอนเทนเนอร์มัลติมีเดียที่มีเสียง วิดีโอ หรือข้อความสำหรับเล่นในภายหลัง เป็นรูปแบบทางเลือกสำหรับการแลกเปลี่ยนสื่อดิจิทัลระหว่างอุปกรณ์ แอปพลิเคชัน และระบบปฏิบัติการ ไฟล์ QT ยังถูกบันทึกในรูปแบบ [MOV](/th/video/mov/) ที่พัฒนาโดย Apple Inc. แอปพลิเคชันบางตัวที่สามารถเปิดไฟล์ QT ได้แก่ Apple QuickTime player, VLC media player และ Media Player Classic with K- ชุดตัวแปลงสัญญาณ Lite

## รูปแบบไฟล์ QT

QTFF เป็นแบบเชิงวัตถุที่แสดงชุดของวัตถุที่ยืดหยุ่นเพื่อความสะดวกในการแยกวิเคราะห์และขยาย แต่ละแทร็กในไฟล์ QT มีสตรีมสื่อที่เข้ารหัสแบบดิจิทัลหรือการอ้างอิงข้อมูลไปยังสตรีมสื่อที่อยู่ในไฟล์อื่น โครงสร้างข้อมูลแบบลำดับชั้นประกอบด้วยวัตถุที่เรียกว่าอะตอมทำหน้าที่เป็นคอนเทนเนอร์ติดตาม ข้อกำหนดรูปแบบไฟล์สำหรับ [รูปแบบไฟล์ QT](https://developer.apple.com/library/archive/documentation/QuickTime/QTFF/QTFFPreface/qtffPreface.html) มีให้ใช้งานอย่างเป็นทางการโดย Apple Inc สำหรับการอ้างอิงของนักพัฒนา

### คำอธิบายสื่อ

คำอธิบายสื่อของไฟล์ QuickTime จัดเก็บแยกต่างหากจากข้อมูลสื่อ ข้อมูลต่างๆ เช่น จำนวนแทร็ก รูปแบบการบีบอัดวิดีโอ และข้อมูลเวลาจะถูกจัดเก็บไว้ในคำอธิบายสื่อ (เรียกอีกอย่างว่าทรัพยากรภาพยนตร์ อะตอมของภาพยนตร์ หรือเรียกง่ายๆ ว่าภาพยนตร์) ข้อมูลสื่อถูกอ้างอิงโดยดัชนีในโครงสร้างสื่อนี้ ข้อมูลสื่อเป็นข้อมูลตัวอย่างจริง เช่น เฟรมวิดีโอและตัวอย่างเสียง ที่ใช้ในภาพยนตร์

### อะตอม

Atom เป็นหน่วยพื้นฐานของไฟล์ QuickTime มีสองฟิลด์หลักในอะตอมใด ๆ ก่อนฟิลด์อื่น: ฟิลด์ขนาดและประเภท ช่องขนาดแสดงขนาดของอะตอมในขณะที่ช่องประเภทระบุประเภทของข้อมูลที่จัดเก็บไว้ในอะตอม โดยธรรมชาติแล้ว อะตอมมีลักษณะเป็นลำดับชั้น ซึ่งหมายความว่าอะตอมหนึ่งสามารถบรรจุอะตอมอื่นๆ ได้ ซึ่งยังคงมีอะตอมอื่นๆ เค้าโครงของอะตอมตัวอย่างแสดงในรูปภาพต่อไปนี้

แต่ละอะตอมมีสองส่วน ส่วนหัว และข้อมูล ส่วนหัวประกอบด้วยฟิลด์ขนาดและประเภท และส่วนข้อมูลประกอบด้วยข้อมูลจริง นอกจากนี้ แต่ละฟิลด์มีคำอธิบายด้านล่าง:

#### ขนาดอะตอม

ส่วนหัวและเนื้อหาของอะตอมระบุด้วยจำนวนเต็ม 32 บิตซึ่งเรียกว่าขนาดของอะตอม ฟิลด์ขนาดประกอบด้วยขนาดของอะตอมเป็นไบต์ ซึ่งแสดงเป็นจำนวนเต็มที่ไม่มีเครื่องหมาย 32 บิต

#### ประเภทอะตอม

ประเภทของอะตอมยังแสดงด้วยจำนวนเต็ม 32 บิต ซึ่งส่วนใหญ่ถือเป็นฟิลด์สี่อักขระที่มีค่า knemonic เช่น 'moov' (0x6D6F6F76) สำหรับอะตอมภาพยนตร์ หรือ 'trak' (0x7472616B) สำหรับ ติดตามอะตอม เมื่อทราบชนิดของอะตอมแล้ว ก็จะอนุญาตให้ตีความข้อมูลได้

![alt text](../QT_Sample_Atom.png "QT File Format")

## โครงสร้างไฟล์ ##

ไฟล์ QT/MOV ประกอบด้วยส่วนที่ต่อเนื่องกัน ทุกอันมีส่วนหัว 8 ไบต์: ขนาดอัน 4 ไบต์ (big-endian, ไบต์สูงก่อน) และประเภทอัน 4 ไบต์ - หนึ่งในลายเซ็นที่กำหนดไว้ล่วงหน้า: "ftyp", "mdat", "moov", "pnot ", "udta", "uuid", "moof", "free", "skip", "jP2", "กว้าง", "load", "ctab", "imap", "matt", "kmat", "คลิป", "crgn", "ซิงค์", "แชป", "tmcd", "scpt", "ssrc", "PICT" อันแรกเป็นประเภท "ftype" และมีประเภทย่อยที่ออฟเซ็ต 8 MOV กำหนดโดยประเภทย่อยซึ่งต้องเป็น "qt" ในการเขียนไฟล์ MOV จำเป็นต้องมีการวนซ้ำจนกว่าจะตรวจพบประเภทที่ไม่รู้จัก

ต่อไปนี้คือตัวอย่าง: การตรวจสอบข้อมูลไบนารีของไฟล์ MOV ตัวอย่าง เห็นได้ชัดว่าเริ่มต้นด้วยลายเซ็น **ftyp** (ฐานสิบหก: 66 74 79 70) ที่ออฟเซ็ต 4 ซึ่งกำหนดประเภทไฟล์คอนเทนเนอร์ QuickTime ประเภทย่อยของไฟล์คือ **qt~_~_** (ฐานสิบหก: 71 74 20 20) ซึ่งชี้ไปที่ประเภทไฟล์ MOV ขนาดบล็อกแรกคือ 32 (hex: 00 00 00 20, big-endian, high byte ก่อน) ขนาดอยู่ที่ offset 0 ที่ offset 32 (hex: 20) จะอยู่ที่ chunk ที่สองซึ่งมีขนาด 8 และ พิมพ์ **mdat** (ฐานสิบหก: 6D 64 61 74)

ชิ้นถัดไปอยู่ที่ออฟเซ็ต 32+8#40 (ฐานสิบหก: 28) และมีขนาด 3,263,028 (ฐานสิบหก: 00 31 CA 34) และพิมพ์ **mdat** (ฐานสิบหก: 6D 64 61 74) ที่ออฟเซ็ต 44 (ฐานสิบหก : 2ค). ชิ้นถัดไปอยู่ที่ออฟเซ็ต 40 + 3,263,028#3,263,068 (ฐานสิบหก: 00 31 CA 5C) และมีขนาด 21,189 (ฐานสิบหก: 00 00 52 C5) และพิมพ์ **moov** (ฐานสิบหก: 6D 6F 6F 76) ที่ออฟเซ็ต 1,836,019,574 (ฐานสิบหก: 00 31 CA 60) นี่เป็นก้อนสุดท้าย ดังนั้นขนาดไฟล์ทั้งหมดคือ 3,263,068+21,189#3,284,257 ไบต์

## อ้างอิง ##

* [รูปแบบไฟล์ QT - Apple Inc.](https://developer.apple.com/library/archive/documentation/QuickTime/QTFF/QTFFPreface/qtffPreface.html)
* [รูปแบบไฟล์ QuickTime - Wikipedia](https://en.wikipedia.org/wiki/QuickTime_File_Format)

