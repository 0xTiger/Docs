{
  "date" : "2019-12-10",
  "keywords" :[ "XLSB", "ไฟล์", "นามสกุล", "รูปแบบไฟล์", "ไฟล์สเปรดชีตไบนารีของ Excel" ],
  "author" : {
    "display_name" : "Kashif Iqbal"
},
  "draft" : "false",
  "toc" : true,
  "description" :"คู่มือรูปแบบไฟล์ของคุณเพื่อให้ทราบว่าไฟล์ XLSB และ API ใดที่สามารถสร้างและเปิดได้",
  "title" :"ไฟล์ XLSB คืออะไร",
  "linktitle" : "XLSB",
  "menu" : {
    "docs" : {
      "parent" : "spreadsheet"
}
},
  "lastmod" : "2019-12-10"
}

## ไฟล์ XLSB คืออะไร??

รูปแบบไฟล์ XLSB ระบุรูปแบบไฟล์ไบนารีของ Excel ซึ่งเป็นชุดของระเบียนและโครงสร้างที่ระบุเนื้อหาสมุดงาน Excel เนื้อหาอาจรวมถึงตารางตัวเลข ข้อความ หรือทั้งตัวเลขและข้อความแบบไม่มีโครงสร้างหรือกึ่งโครงสร้าง สูตร การเชื่อมต่อข้อมูลภายนอก แผนภูมิ และรูปภาพ ซึ่งแตกต่างจาก [XLSX](/th/spreadsheet/xlsx/) (ซึ่งใช้รูปแบบไฟล์ Open XML) XLSB แทนไฟล์สมุดงาน Excel แบบไบนารี ไฟล์ XLSB สามารถอ่านและเขียนได้เร็วกว่า ซึ่งมีประโยชน์สำหรับการทำงานกับไฟล์ขนาดใหญ่ XLSB ไม่ค่อยได้ใช้ในการจัดเก็บสมุดงานเนื่องจาก XLSX (และก่อนหน้านี้คือ [XLS](/th/spreadsheet/xls/)) เป็นรูปแบบไฟล์ที่ผู้ใช้ทั่วไปเลือกสำหรับการบันทึกสมุดงาน สามารถเปิดได้ด้วย Microsoft Office 2007 ขึ้นไป

## ข้อมูลจำเพาะรูปแบบไฟล์ XLSB ##

ข้อกำหนดรูปแบบไฟล์สำหรับรูปแบบไฟล์ XLSB เผยแพร่สู่สาธารณะในปี 2551 เป็นเวอร์ชัน 1.0 ตั้งแต่นั้นมา ข้อมูลจำเพาะได้แก้ไขหลายครั้งและข้อกำหนดเวอร์ชันล่าสุด (v 10.0) ได้รับการเผยแพร่ในเดือนเมษายน 2018 Microsoft เผยแพร่ข้อมูลจำเพาะต่อสาธารณะในชื่อ [[MS-XLSB] - ข้อกำหนดรูปแบบไฟล์ไบนารีของ Excel](https:/ /msdn.microsoft.com/en-us/library/cc313133(v#office.12).aspx) และควรได้รับการปรึกษาจากทุกคนสำหรับการอ่านหรือเขียนไฟล์ในรูปแบบไฟล์ XLSB

## โครงสร้างไฟล์ XLSB ##

ไฟล์ XLSB เป็นแพ็คเกจที่ประกอบด้วยชุดของส่วนต่างๆ ส่วนเหล่านี้ประกอบด้วยข้อมูลเกี่ยวกับเนื้อหาของสมุดงาน รวมถึงข้อมูลสมุดงานและโครงสร้างของแพ็คเกจ บางส่วนประกอบด้วยข้อมูลที่จัดเก็บโดยใช้บันทึกไบนารี บางส่วนเป็น XML ในขณะที่บางส่วนมีข้อมูลที่จัดเก็บเป็นไบนารีสตรีมของไบต์ ระเบียนไบนารีแต่ละรายการมีเขตข้อมูลที่มีโครงสร้างเป็นศูนย์หรือมากกว่าซึ่งมีข้อมูลสมุดงาน

#### บรรจุุภัณฑ์ ####

แพ็คเกจ XLSB เป็นไฟล์เก็บถาวร [ZIP](/th/compression/zip/) ที่ต้องมีส่วนสมุดงานเพียงส่วนเดียว ส่วนนี้ต้องเป็นเป้าหมายของความสัมพันธ์ในส่วนความสัมพันธ์ของแพ็คเกจนี้ ส่วนสมุดงานเป็นส่วนเริ่มต้นในเอกสาร XLSB

#### ส่วนหนึ่ง ####

ส่วนคือสตรีมของไบต์ที่มีประเภทเนื้อหาที่เกี่ยวข้องซึ่งระบุลักษณะและประเภทของเนื้อหาที่จัดเก็บไว้ในส่วนนั้น บางส่วนเก็บข้อมูลในรูปแบบไบนารีในขณะที่ส่วนอื่น ๆ เก็บข้อมูลเป็น XML ส่วน [การแจงนับชิ้นส่วน](https://msdn.microsoft.com/en-us/library/dd924091(v#office.12).aspx) ของเอกสารข้อกำหนดแสดงรายการส่วนที่ถูกต้อง ชนิดเนื้อหา และความสัมพันธ์ที่จำเป็น/ทางเลือกระหว่าง ทุกชิ้นส่วนในแพ็คเกจ

#### ความสัมพันธ์ ####

ต้นทางและทรัพยากรเป้าหมายเชื่อมต่อกันด้วยความสัมพันธ์ ความสัมพันธ์สามารถ:

**ความสัมพันธ์ของแพ็กเกจ:** โดยที่เป้าหมายเป็นส่วนหนึ่งและแหล่งที่มาคือแพ็กเกจโดยรวม

**ความสัมพันธ์แบบส่วนต่อส่วน:** โดยที่เป้าหมายเป็นส่วนหนึ่งและแหล่งที่มาเป็นส่วนหนึ่งในแพ็คเกจ

**ความสัมพันธ์ที่ชัดเจน:** ที่ทรัพยากรถูกอ้างอิงจากเนื้อหาของส่วนต้นทางโดยอ้างอิงค่าแอตทริบิวต์ ID ขององค์ประกอบความสัมพันธ์

**ความสัมพันธ์โดยนัย** คือความสัมพันธ์ที่ไม่ชัดเจน

**ความสัมพันธ์ภายใน:** ที่เป้าหมายเป็นส่วนหนึ่งของแพ็คเกจ

**ความสัมพันธ์ภายนอก:** โดยที่เป้าหมายคือทรัพยากรภายนอกที่ไม่ได้อยู่ในแพ็คเกจ

#### บันทึก ####

เรกคอร์ดเป็นแบบเอกสารสำเร็จรูปพื้นฐานที่ใช้ในการจัดเก็บข้อมูลเกี่ยวกับคุณลักษณะในสมุดงาน ระเบียนไบนารีแต่ละรายการเป็นลำดับความยาวตัวแปรของไบต์ บันทึกไบนารีประกอบด้วยสามองค์ประกอบ:

* ประเภทบันทึก
* ขนาดบันทึกและ
* ข้อมูลบันทึกที่เฉพาะเจาะจงสำหรับประเภทบันทึกนั้น

**ประเภทเรกคอร์ด:** ประเภทเรกคอร์ดจะแสดงประเภทเรกคอร์ดที่ระบุโดยเรกคอร์ด นอกจากนี้ยังระบุโครงสร้างของข้อมูลบันทึกเฉพาะสำหรับบันทึกนี้ ประเภทเรคคอร์ดที่ถูกต้องแสดงอยู่ในส่วน [Record Enumeration](https://msdn.microsoft.com/en-us/library/dd953057(v#office.12).aspx) ของเอกสารข้อมูลจำเพาะ ประเภทเรคคอร์ดต้องเป็นหนึ่งหรือสองไบต์ และต้องมากกว่าหรือเท่ากับ 128 และน้อยกว่า 16384

**ขนาดเรคคอร์ด:** ขนาดเรคคอร์ดระบุจำนวนไบต์ที่ระบุขนาดรวมของข้อมูลเรคคอร์ด ค่านี้ต้องเป็นหนึ่งถึงสี่ไบต์ ค่านี้ต้องเป็นหนึ่งไบต์หากบิตสูงในไบต์ต่ำมีค่าเท่ากับ 0; มิฉะนั้น ค่านี้ต้องมากกว่าหนึ่งไบต์ หากจำนวนไบต์มากกว่าหนึ่งไบต์ บิตสูงในแต่ละไบต์ที่ต่อเนื่องกันจะระบุว่าใช้ไบต์เพิ่มเติมหรือไม่ หากบิตสูงของไบต์ที่สองเท่ากับ 1 ค่านี้ต้องใช้ไบต์ที่สามเพิ่มเติม หากบิตสูงของไบต์ที่สามเท่ากับ 1 ค่านี้ต้องใช้ไบต์ที่สี่เพิ่มเติม ต้องละเว้นบิตสูงของไบต์ที่สี่ ค่าประกอบด้วยเจ็ดบิตต่ำของแต่ละไบต์รวมกัน บิตต่ำที่มีนัยสำคัญน้อยที่สุดจะอยู่ภายในไบต์แรก และแต่ละไบต์ที่ตามมาจะมีบิตลำดับที่สูงกว่าไบต์ก่อนหน้า

**ข้อมูลเรคคอร์ด:** ส่วนประกอบข้อมูลเรคคอร์ดมีฟิลด์ที่สอดคล้องกับประเภทเรคคอร์ดเฉพาะและประกอบด้วยเรคคอร์ดที่เหลือ ลำดับและโครงสร้างของฟิลด์สำหรับประเภทเรคคอร์ดที่กำหนดซึ่งแสดงอยู่ในการแจงนับเรคคอร์ดระบุไว้ในส่วนที่เกี่ยวข้องสำหรับประเภทเรคคอร์ดนั้นในเรคคอร์ด ขนาดรวมของส่วนประกอบข้อมูลเรคคอร์ดต้องเท่ากับขนาดเรคคอร์ด เขตข้อมูลในส่วนประกอบข้อมูลระเบียนสามารถประกอบด้วยค่าอย่างง่าย อาร์เรย์ของค่า โครงสร้างของหลายเขตข้อมูล อาร์เรย์ของเขตข้อมูล และอาร์เรย์ของโครงสร้าง

#### ตัวอย่างบันทึก XLSB ####

ประเภทเรคคอร์ดและขนาดเรคคอร์ดต่อไปนี้ระบุเรคคอร์ด **BrtCommentText** ที่มีขนาด 200 ไบต์:

11111101 00000100 11001000 00000001 [ช่องบันทึก]

ไบต์แรกคือ 11111101 โดยระบุค่าต่ำสุดที่ 125 และประเภทเรคคอร์ดต้องการไบต์ที่สอง ไบต์ที่สองคือ 00000100 ซึ่งระบุค่าสูงเป็น 4 * 128 ซึ่งเท่ากับ 512 ค่าประเภทเรคคอร์ดคือ 125 + 512 หรือ 637 ซึ่งสอดคล้องกับประเภทเรคคอร์ด **BrtCommentText** ไบต์ถัดไปคือ 11001000 โดยระบุค่าต่ำเป็น 72 และขนาดเร็กคอร์ดต้องการไบต์ที่สอง ไบต์ที่สองคือ 00000001 ซึ่งระบุค่าที่สูงกว่าเป็น 1 * 128 และขนาดเร็กคอร์ดไม่ต้องการไบต์เพิ่มเติม ขนาดเรคคอร์ดคือ 72 + 128 หรือ 200 ซึ่งระบุขนาดทั้งหมดเป็นไบต์ของส่วนประกอบข้อมูลเรคคอร์ด ฟิลด์ในส่วนประกอบข้อมูลเรกคอร์ดระบุโดย **BrtCommentText**

## อ้างอิง ##

* [[MS-XLSB] - รูปแบบไฟล์ไบนารีของ Excel (.xlsb)](https://msdn.microsoft.com/en-us/library/cc313133(v#office.12).aspx)

