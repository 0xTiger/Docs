{
  "date" : "2019-12-10",
  "keywords" :[ "CSV", "ไฟล์", "นามสกุล", "รูปแบบไฟล์", "ค่าที่คั่นด้วยเครื่องหมายจุลภาค", "สเปรดชีต" ],
  "author" : {
    "display_name" : "Kashif Iqbal"
},
  "draft" : "false",
  "toc" : true,
  "description":"เรียนรู้เกี่ยวกับรูปแบบไฟล์ CSV และ API ที่สามารถสร้างและเปิดไฟล์ CSV",
  "title" :"รูปแบบไฟล์ CSV",
  "linktitle" : "CSV",
  "menu" : {
    "docs" : {
      "parent" : "spreadsheet"
}
},
  "lastmod" : "2019-12-10"
}

## ไฟล์ CSV คืออะไร?

ไฟล์ที่มีนามสกุล .csv (ค่าที่คั่นด้วยเครื่องหมายจุลภาค) แสดงถึงไฟล์ข้อความธรรมดาที่มีบันทึกข้อมูลที่มีค่าที่คั่นด้วยเครื่องหมายจุลภาค แต่ละบรรทัดในไฟล์ CSV คือระเบียนใหม่จากชุดระเบียนที่มีอยู่ในไฟล์ ไฟล์ดังกล่าวถูกสร้างขึ้นเมื่อมีจุดประสงค์ในการถ่ายโอนข้อมูลจากระบบจัดเก็บข้อมูลหนึ่งไปยังอีกระบบหนึ่ง เนื่องจากแอปพลิเคชันทั้งหมดสามารถรับรู้ระเบียนที่คั่นด้วยเครื่องหมายจุลภาค การนำเข้าไฟล์ข้อมูลดังกล่าวไปยังฐานข้อมูลจึงทำได้สะดวกมาก แอปพลิเคชันสเปรดชีตเกือบทั้งหมด เช่น Microsoft Excel หรือ OpenOffice Calc สามารถนำเข้า CSV ได้โดยไม่ต้องใช้ความพยายามมากนัก ข้อมูลที่นำเข้าจากไฟล์ดังกล่าวจะถูกจัดเรียงในเซลล์ของสเปรดชีตเพื่อนำเสนอต่อผู้ใช้

## ประวัติย่อ ##

ต่อไปนี้เป็นข้อมูลโดยย่อเกี่ยวกับที่มาและประวัติของรูปแบบไฟล์ CSV

* 1972 - คอมไพเลอร์ IBM Fortran (ขยายระดับ H) รองรับภายใต้ OS/360

* 1978 - อินพุต/เอาต์พุตที่กำกับรายการรองรับโดย FORTRAN 77 ซึ่งใช้เครื่องหมายจุลภาคและช่องว่างสำหรับตัวคั่น

* 2005 - CSV ได้รับมาตรฐาน [RFC4180](https://tools.ietf.org/html/rfc4180) เป็นประเภทเนื้อหา MIME

* 2013 - ข้อบกพร่องของ RFC4180 ได้รับการจัดการโดยคำแนะนำของ W3C

* พ.ศ. 2558 - W3C จัดทำร่างคำแนะนำฉบับแรกสำหรับมาตรฐานข้อมูลเมตาของ CSV ซึ่งเริ่มเป็นคำแนะนำในเดือนธันวาคม 2558

## แปลงไฟล์ CSV ##

ไฟล์ CSV สามารถแปลงเป็นไฟล์รูปแบบต่างๆ ได้หลากหลายโดยใช้แอปพลิเคชันที่สามารถเปิดไฟล์เหล่านี้ได้ ตัวอย่างเช่น Microsoft Excel สามารถนำเข้าข้อมูลจากรูปแบบไฟล์ CSV และบันทึกเป็น XLS, [XLSX](/th/spreadsheet/xlsx/), [PDF](/th/pdf/), [TXT](/th/word-processing/txt/) รูปแบบไฟล์ , XML และ [HTML](/th/web/html/) ในทำนองเดียวกัน เดสก์ท็อปและบริการออนไลน์อื่นๆ ให้ความสามารถในการส่งออกไฟล์ CSV เป็น HTML, ODS และ [RTF](/th/word-processing/rtf/)

## รูปแบบไฟล์ CSV ##

เป็นที่ทราบกันดีว่ารูปแบบไฟล์ CSV ระบุไว้ใน [RFC4180](https://tools.ietf.org/html/rfc4180) กำหนดไฟล์ใด ๆ ที่จะสอดคล้องกับ CSV ถ้า:

* แต่ละระเบียนอยู่ในบรรทัดแยกต่างหาก คั่นด้วยตัวแบ่งบรรทัด (CRLF) ตัวอย่างเช่น:
* aaa,bbb,ccc CRLF
* zzz,yyy,xxx CRLF
* บันทึกสุดท้ายในไฟล์อาจมีหรือไม่มีตัวแบ่งบรรทัดสิ้นสุด ตัวอย่างเช่น:
* aaa,bbb,ccc CRLF
*zzz,ปปปป,xxx
* อาจมีบรรทัดส่วนหัวที่ไม่บังคับปรากฏเป็นบรรทัดแรกของไฟล์ที่มีรูปแบบเดียวกับบรรทัดบันทึกปกติ ส่วนหัวนี้จะมีชื่อที่ตรงกับฟิลด์ในไฟล์ และควรมีจำนวนฟิลด์เท่ากันกับเร็กคอร์ดในส่วนที่เหลือของไฟล์ (ควรมีหรือไม่มีบรรทัดส่วนหัวให้ระบุผ่านพารามิเตอร์ "ส่วนหัว" ที่เป็นทางเลือกของสิ่งนี้ ประเภทไมม์). ตัวอย่างเช่น:
* field_name,field_name,field_name CRLF
* aaa,bbb,ccc CRLF
* zzz,yyy,xxx CRLF
* ﻿ภายในส่วนหัวและแต่ละระเบียน อาจมีหนึ่งฟิลด์หรือมากกว่านั้น คั่นด้วยเครื่องหมายจุลภาค แต่ละบรรทัดควรมีจำนวนฟิลด์เท่ากันตลอดทั้งไฟล์ ช่องว่างถือเป็นส่วนหนึ่งของเขตข้อมูลและไม่ควรละเว้น ช่องสุดท้ายในระเบียนต้องไม่ตามด้วยเครื่องหมายจุลภาค ตัวอย่างเช่น:
* aaa,bbb,ccc
* แต่ละฟิลด์อาจใส่เครื่องหมายคำพูดคู่หรือไม่ก็ได้ (แต่บางโปรแกรม เช่น Microsoft Excel จะไม่ใช้เครื่องหมายคำพูดคู่เลย) หากฟิลด์ไม่ได้อยู่ในเครื่องหมายอัญประกาศคู่ เครื่องหมายอัญประกาศคู่อาจไม่ปรากฏภายในฟิลด์ ตัวอย่างเช่น:\
* "aaa","bbb","ccc" CRLF
*zzz,ปปปป,xxx
* ช่องที่มีตัวแบ่งบรรทัด (CRLF) อัญประกาศคู่ และเครื่องหมายจุลภาคควรอยู่ในเครื่องหมายอัญประกาศ ตัวอย่างเช่น:
* "aaa","b CRLF
* bb","ccc" CRLF
*zzz,ปปปป,xxx
* หากใช้เครื่องหมายอัญประกาศคู่เพื่อปิดช่อง เครื่องหมายอัญประกาศคู่ที่ปรากฏภายในช่องจะต้องหลีกโดยนำหน้าเครื่องหมายอัญประกาศคู่อื่น ตัวอย่างเช่น:
* "aaa","b""บีบี","ccc"

อย่างไรก็ตาม ในแง่ของการใช้งานสมัยใหม่ ตัวคั่นไม่ได้จำกัดเฉพาะเครื่องหมายจุลภาคเท่านั้น และสามารถเป็นเครื่องหมายอัฒภาค แท็บ หรือเว้นวรรคได้เช่นกัน แอปพลิเคชัน เช่น Microsoft Excel มีตัวเลือกในการระบุอักขระตัวคั่นสำหรับการนำเข้าบันทึกจากไฟล์ CSV

## อ้างอิง

* [RFC 4180](https://tools.ietf.org/html/rfc4180)
* [RFC 2048](https://tools.ietf.org/html/rfc2048)
* [CSV - วิกิพีเดีย](https://en.wikipedia.org/wiki/Comma-separated_values)

