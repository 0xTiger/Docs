{
  "date" : "2019-10-11",
  "author" : {
    "display_name" : "Kashif Iqbal"
},
  "draft" : "false",
  "toc" : true,
  "title" :"ONETOC2 - รูปแบบไฟล์ Microsoft OneNote",
  "description":"เรียนรู้เกี่ยวกับรูปแบบไฟล์ ONETOC2 และ API ที่สามารถสร้างและเปิดไฟล์ ONETOC2",
  "linktitle" : "ONETOC2",
  "menu" : {
    "docs" : {
      "parent" : "note-taking"
}
},
  "lastmod" : "2019-09-10"
}

## ONETOC2 คืออะไร? ##

ผู้ที่ทำงานกับแอปพลิเคชัน [Microsoft OneNote](https://products.office.com/en-us/onenote/digital-note-taking-app) อาจสังเกตว่ามีไฟล์ .onetoc2 อยู่ในโฟลเดอร์โน้ตบุ๊ก Microsoft OneNote สร้างไฟล์ไบนารี .onetoc2 เป็นสารบัญสำหรับเก็บดัชนีเกี่ยวกับลำดับของส่วนการจดบันทึกต่างๆ ในสมุดบันทึก สมุดบันทึกคือชุดของไฟล์ส่วนที่จัดเก็บไว้ในไดเร็กทอรีเดียวกัน ไฟล์ .onetoc2 ใช้ชุดของคุณสมบัติเพื่อระบุการตั้งค่า เช่น ลำดับของส่วนต่างๆ ภายในสมุดบันทึกและสีของสมุดบันทึก

เมื่อคุณสร้างสมุดบันทึกใน OneNote 2016 สมุดบันทึกนั้นจะถูกบันทึกในรูปแบบไฟล์ 2010-2016 ใหม่โดยอัตโนมัติ คุณต้องใช้รูปแบบนี้หากต้องการให้ฟีเจอร์ทั้งหมดใน OneNote 2016 เช่น สมการทางคณิตศาสตร์และบันทึกย่อที่เชื่อมโยงทำงานได้อย่างถูกต้อง

## รูปแบบไฟล์ ONETOC2 ##

รูปแบบไฟล์ .onetoc2 จะแสดงเป็นรูปแบบไฟล์ที่เก็บการแก้ไขของ OneNote และเป็นชุดของโครงสร้างที่ระบุที่เก็บการแก้ไขที่จัดระเบียบเป็นพื้นที่วัตถุที่อ้างอิงข้าม มีวัตถุที่มีชุดคุณสมบัติ และมีบันทึกธุรกรรมเพื่อให้แน่ใจว่าไฟล์มีความสมบูรณ์แบบอะซิงโครนัส เขียน ข้อมูลจำเพาะที่สมบูรณ์สำหรับรูปแบบไฟล์ .onetoc2 มีให้ [ออนไลน์](https://msdn.microsoft.com/en-us/library/dd951288(v#office.12).aspx) และสามารถอ้างอิงเพื่อพัฒนาแอปพลิเคชันได้ .

### โครงสร้างไฟล์ ###

ไฟล์จัดเก็บการแก้ไขต้องขึ้นต้นด้วยโครงสร้าง **Header** ส่วนที่เหลือของไฟล์ถูกแบ่งพาร์ติชันเป็นบล็อกขนาดไบต์ โดยที่ฟิลด์ที่อ้างอิงถึงขนาดและโครงสร้างของแต่ละบล็อกจะระบุ สามารถเข้าถึงบล็อกได้หากถูกอ้างอิงโดยโครงสร้าง **Header** หรือหากมีการอ้างอิงโดยฟิลด์ในบล็อกอื่นที่เข้าถึงได้ ต้องละเว้นข้อมูลที่อยู่นอกโครงสร้าง **Header** และบล็อกที่เข้าถึงได้

โครงสร้างทั้งหมดจัดชิดกันในขอบเขต 1 ไบต์ จำนวนเต็มทั้งหมดจะถูกเซ็นชื่อ เว้นแต่จะระบุไว้เป็นอย่างอื่น ช่องทั้งหมดเป็น [little-endian](https://msdn.microsoft.com/en-us/library/dd773246(v#office.12).aspx#gt_079478cb-f4c5-4ce5-b72b-2144da5d2ce7) เว้นแต่จะระบุไว้เป็นอย่างอื่น

#### หัวข้อ ####

ส่วนหัวของไฟล์ .ONE ประกอบด้วยส่วนที่มีรหัสเฉพาะและฟิลด์ที่แตกต่างกันสำหรับการแสดงข้อมูลไฟล์ดังต่อไปนี้:

`guidFileType (16 ไบต์):' GUID ที่ระบุประเภทของไฟล์จัดเก็บการแก้ไข ต้องเป็นหนึ่งในค่าจากตารางต่อไปนี้

|รูปแบบไฟล์|ค่า
--- | --- |
|.one|{7B5C52E4-D88C-4DA7-AEB1-5378D02996D3}
|.onetoc2|{43FF2FA1-EFD9-4C76-9EE2-10EA5722765F}

`guidFile (16 ไบต์):' GUID ที่ระบุตัวตนของไฟล์จัดเก็บการแก้ไขนี้ ควรมีเอกลักษณ์เฉพาะตัวทั่วโลก

`guidLegacyFileVersion (16 ไบต์):` ต้องเป็น "{00000000-0000-0000-0000-000000000000}" และต้องละเว้น

`guidFileFormat (16 ไบต์):' GUID ที่ระบุว่าไฟล์นั้นเป็นไฟล์จัดเก็บการแก้ไข ต้องเป็น "{109ADD3F-911B-49F5-A5D0-1791EDC8AED8}"

`ffvLastCodeThatWroteToThisFile (4 ไบต์):' จำนวนเต็มที่ไม่ได้ลงชื่อ ต้องเป็นค่าใดค่าหนึ่งในตารางต่อไปนี้ ขึ้นอยู่กับประเภทไฟล์

|รูปแบบไฟล์|ค่า
--- | --- |
|.หนึ่ง|0x0000002A
|.onetoc2|0x0000001B

`ffvOldestCodeThatHasWrittenToThisFile (4 ไบต์):` จำนวนเต็มที่ไม่ได้ลงชื่อ ต้องเป็นหนึ่งในค่าในตารางต่อไปนี้ ขึ้นอยู่กับรูปแบบไฟล์ของไฟล์นี้


|รูปแบบไฟล์|ค่า
--- | --- |
|.หนึ่ง|0x0000002A
|.onetoc2|0x0000001B

`ffvNewestCodeThatHasWrittenToThisFile (4 ไบต์):` จำนวนเต็มที่ไม่ได้ลงชื่อ ต้องเป็นหนึ่งในค่าในตารางต่อไปนี้ ขึ้นอยู่กับรูปแบบไฟล์ของไฟล์นี้
:


|รูปแบบไฟล์|ค่า
--- | --- |
|.หนึ่ง|0x0000002A
|.onetoc2|0x0000001B

`ffvOldestCodeThatMayReadThisFile (4 ไบต์):` จำนวนเต็มที่ไม่ได้ลงชื่อ ต้องเป็นหนึ่งในค่าในตารางต่อไปนี้ ขึ้นอยู่กับรูปแบบไฟล์ของไฟล์นี้


|รูปแบบไฟล์|ค่า
--- | --- |
|.หนึ่ง|0x0000002A
|.onetoc2|0x0000001B

## อ้างอิง ##

* [[MS-ONESTOR] - รูปแบบไฟล์ OneNote](https://msdn.microsoft.com/en-us/library/dd951288(v#office.12).aspx)
* [Microsoft OneNote - Wikipedia](https://en.wikipedia.org/wiki/Microsoft_OneNote#References)

