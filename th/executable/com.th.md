{
  "date" : "2021-06-29",
  "keywords" :[ "com file", "com file คืออะไร", "file", "com example", "com file extension", "extension", "format" ],
  "author" : {
    "display_name" : "Muhammad Umar"
},
  "draft" : "false",
  "toc" : true,
  "description":"เรียนรู้เกี่ยวกับรูปแบบไฟล์ COM และ API ที่สามารถสร้างและเปิดไฟล์ COM",
  "title" :"รูปแบบไฟล์คำสั่ง COM - DOS",
  "linktitle" : "COM",
  "menu" : {
    "docs" : {
      "parent" : "executable"
}
},
  "lastmod" : "2021-06-29"
}

## ไฟล์ COM คืออะไร??
ไฟล์ COM ใช้สำหรับเรียกใช้ชุดคำสั่งหรือคำแนะนำ ไฟล์ COM ประกอบด้วยโปรแกรมปฏิบัติการที่สามารถเรียกใช้จาก Windows หรือ MS-DOS เช่นเดียวกับไฟล์ EXE ไฟล์ COM จะถูกบันทึกในรูปแบบไบนารีเช่นกัน แต่จะแตกต่างจากไฟล์ EXE เนื่องจากไม่มีส่วนหัวหรือข้อมูลเมตา และยังมีขนาดสูงสุดประมาณ 64KB เมื่อไฟล์ COM ทำงานครั้งแรกบนระบบ 32 บิต ระบบจะแจ้งให้ติดตั้งคอมโพเนนต์ NT Virtual DOS Machine (NTVDM) ไฟล์ COM สามารถเรียกใช้บน Microsoft Windows รุ่น 64 บิตด้วยเครื่องเสมือนที่รองรับสภาพแวดล้อม MS-DOS

## รูปแบบไฟล์ .COM
รูปแบบไฟล์ COM เป็นรูปแบบไฟล์ปฏิบัติการไบนารีที่ใช้ใน Microsoft Windows หรือ MS-DOS โครงสร้างประกอบด้วยเพียงชุดคำสั่ง ไม่มีส่วนหัวและไม่มีข้อมูลเมตามาตรฐาน มันเก็บข้อมูลและโค้ดทั้งหมดไว้ในส่วนเดียวเท่านั้น และไบนารีของมันมีขนาดสูงสุด 64KB รูปแบบไฟล์นี้ไม่ย้ายตำแหน่งตัวเองเมื่อพยายามเรียกใช้ใหม่ ดังนั้นระบบปฏิบัติการจึงโหลดตามที่อยู่ที่กำหนดไว้ล่วงหน้า นอกจากนี้ยังเป็นไปได้ที่จะสร้างไฟล์ COM เพื่อดำเนินการภายใต้ระบบปฏิบัติการทั้งสองในรูปแบบ **fat binary** ไม่มีความเข้ากันได้จริงในระดับคำสั่ง คำสั่งที่จุดเริ่มต้นถูกเลือกให้มีฟังก์ชันการทำงานเท่ากันแต่ต่างกันในระบบปฏิบัติการทั้งสอง และทำให้โปรแกรมทำงานข้ามไปยังส่วนของระบบปฏิบัติการที่ใช้งานอยู่ มันเป็นสองโปรแกรมที่แตกต่างกันโดยมีขั้นตอนเดียวกันในไฟล์เดียว นำหน้าด้วยรหัสที่เลือกโปรแกรมที่จะใช้
### ตัวอย่างไฟล์ COM
เมื่อเรียกใช้งานไฟล์ COM คำแนะนำจะถูกอ่านจากไบต์แรกและตามด้วยคำสั่งต่อไปจนกว่าจะพบคำสั่งสุดท้าย นี่คือตัวอย่างรหัส ASM:

```
[BITS 16]		;Set code generation to 16 bit mode
[ORG 0x0100]		;Set code start address to 0100h


[SEGMENT .text]		;Main code segment
    mov ah, 9 ; DOS print string function
    mov dx, hello
    int 21h
    ;Exit to DOS
    mov ah, 4ch
    int 21h
[SEGMENT .data]		;Initialised data segment
hello:   db   'Hello, .COM programmer!',13,10,'$'
```

## อ้างอิง

* [ไฟล์ COM - โดย Wikipewdia](https://en.wikipedia.org/wiki/COM_file)

