{
  "date" : "2019-10-11",
  "author" : {
    "display_name" : "Kashif Iqbal"
},
  "draft" : "false",
  "toc" : true,
  "title" :"MSG - Microsoft Outlook Email Format",
  "description":"למד על פורמט קובץ MSG וממשקי API שיכולים ליצור ולפתוח קובצי MSG.",
  "linktitle" : "MSG",
  "menu" : {
    "docs" : {
      "parent" : "email"
}
},
  "lastmod" : "2019-09-10"
}

## מהו קובץ MSG?

MSG הוא פורמט קובץ המשמש את [Microsoft Outlook](https://products.office.com/en-us/outlook/email-and-calendar-software-microsoft-outlook?rtc#1) ו-Exchange לאחסון הודעות דוא"ל , קשר, פגישה או משימות אחרות. הודעות כאלה עשויות להכיל שדה דוא"ל אחד או יותר, עם השולח, הנמען, הנושא, התאריך וגוף ההודעה, או מידע ליצירת קשר, פרטי פגישה ומפרט משימה אחד או יותר. המאפיינים המהווים את אובייקט ההודעה, כולל הם גם חלק מקובץ MSG. לקובץ MSG יש כותרות, גוף הודעה ראשי והיפר-קישורים כטקסט ASCII רגיל. קבצי MSG מתאימים גם לתוכנות הזקוקות לממשק יישומי התכנות של מיקרוסופט (MAPI).

## מבנה קובץ MSG

פורמט CFB_3 הוא הבסיס של קובץ MSG. הפרדיגמה מבוססת על מושגי האחסון והזרמים, קרוב למדי לספריות וקבצים. לכן ההבדל העיקרי בראשון הוא ההיררכיה כולה, ארוזה בקובץ נפרד, הנקרא קובץ מורכב. אובייקטים מהווים את קבצי ההודעה ומורכבים ממאפיין בודד או מהאוספים שלו. יכולת זו מאפשרת ליישומים לאחסן נתונים מורכבים ומובנים בקובץ בודד. פורמט זה גם מציין מספר אחסון, כל אחסון מייצג את אובייקט ההודעה כרכיב עיקרי. אחסון אלה מכילים מספר זרמים המייצגים תכונה של אותו רכיב. קינון של אחסון אפשרי גם.

## מאפי נכסים

ברמה העליונה של קובץ ה-.msg, אחסון מכיל זרמים המאחסנים בהם מאפיינים. ניתן לסווג נכסים כדלקמן:

* מאפייני אורך קבוע
* מאפייני אורך משתנה
* נכסים בעלי ערך רב

ללא קשר לקטגוריה, נכס הוא מתויג או בעל שם. עם זאת, נדרש מידע מיפוי מתאים עבור מאפיינים בעלי שם כפי שצוין באחסון המיפוי שלהם.

## מחסנים

אחסון מהווים את מרכיבי המפתח של אובייקט ההודעה. פורמט קובץ MSG מציין את האחסון הבא:

## מבנה ברמה העליונה

אובייקט הודעה מייצג את כל הרמה העליונה של פורמט הקובץ MSG. בהתאם לסוג, למאפיינים, למספר אובייקטי הנמען והקבצים המצורפים, לאובייקט הודעה יכולים להיות אחסון זרמים שונים בקובץ ה-.MSG המתאים לו.

### קשר עם מבנים אחרים

לפורמט הקובץ Msg יש את הקשרים הבאים למבנים אחרים:

* הבסיס של .msg הוא Comound File Binary Format.
* המאפיינים המשמשים את Message and Attachment Object Protocol משמשים את הפורמט הזה.

## תרחישים להימנע מתבניות MSG

ניתן לשתף אובייקט הודעה בין לקוחות או חנויות הודעות המשתמשות במערכת הקבצים .msg. יש מעט נסיבות שבהן אחסון אובייקט Message בפורמט קובץ .msg אינו מתאים. לדוגמה:

* במקרה של שמירה על ארכיון עצמאי גדול, עדיף להשתמש בפורמט מלא שבו ניתן להציג תצוגות בצורה מדויקת יותר.
* אם המקלט אינו ידוע, יתכן שהפורמט אינו נתמך על ידי קצה המקלט וייתכן שנמסר פרטי או לא רלוונטי.

## דוגמה לקובץ MSG

כדי לקבל מושג איך נראה קובץ MSG, אתה יכול להוריד [קובץ MSG לדוגמה](https://products.conholdate.app/viewer/view/mL7cmq6qYbcNG329P/sample-msg-file.msg) ולפתוח על מחשב כדי לראות את תוכנו.

## הפניות

* [[MS-OXMSG]: פורמט קובץ MSG של Outlook](https://msdn.microsoft.com/en-us/library/cc463912(v#exchg.80).aspx)

