{
  "date" : "2019-10-11",
  "author" : {
    "display_name" : "Kashif Iqbal"
},
  "draft" : "false",
  "toc" : true,
  "title" :"ONETOC2 - Microsoft OneNote Format File",
  "description":"למד על פורמט קובץ ONETOC2 וממשקי API שיכולים ליצור ולפתוח קבצי ONETOC2.",
  "linktitle" : "ONETOC2",
  "menu" : {
    "docs" : {
      "parent" : "note-taking"
}
},
  "lastmod" : "2019-09-10"
}

## מה זה ONETOC2? ##

אלה שעבדו עם יישום [Microsoft OneNote](https://products.office.com/en-us/onenote/digital-note-taking-app) אולי הבחינו בנוכחותם של קבצי .onetoc2 בתיקיית המחברת. Microsoft OneNote יוצר קובץ .onetoc2 בינארי כתוכן עניינים לשמירת אינדקס לגבי הסדר של מקטעים שונים של רישום הערות במחברת. מחברת היא אוסף של קבצי מקטעים המאוחסנים באותה ספרייה. הקובץ .onetoc2 משתמש באוסף של מאפיינים כדי לציין הגדרות כגון סדר המקטעים בתוך המחברת וצבע המחברת.

כאשר אתה יוצר מחברת ב-OneNote 2016, היא נשמרת אוטומטית בפורמט הקובץ החדש של 2010-2016. תזדקק לפורמט הזה אם תרצה שכל התכונות ב-OneNote 2016, כמו משוואות מתמטיות והערות מקושרות, יפעלו כהלכה.

## פורמט קובץ ONETOC2 ##

פורמט הקובץ .onetoc2 מיוצג כ-OneNote Revision Store File Format והוא אוסף של מבנים המציינים מאגר גרסאות המאורגן במרחבי אובייקטים מוצלבים, המכיל אובייקטים עם ערכות מאפיינים ומכיל יומן טרנזקציות כדי להבטיח את שלמות הקובץ על פני אסינכרוני כותב. מפרטים מלאים עבור פורמט הקובץ .onetoc2 זמינים [מקוון](https://msdn.microsoft.com/en-us/library/dd951288(v#office.12).aspx) וניתן לפנות אליהם לפיתוח יישומים .

### מבנה הקובץ ###

קובץ מאגר גרסאות חייב להתחיל במבנה **Header**. שאר הקובץ מחולק לקוביות של בתים, כאשר הגודל והמבנה של כל בלוק מוגדרים על ידי השדה שמפנה אליו. ניתן להגיע לבלוק אם הוא מופנה על ידי מבנה **Header**, או אם מפנה אליו שדה בבלוק אחר שניתן להגיע אליו. יש להתעלם מנתונים מחוץ למבנה **Header** וכל בלוקים שניתן להגיע אליהם.

כל המבנים מיושרים על גבולות של 1 בייט. כל המספרים השלמים חתומים אלא אם צוין אחרת. כל השדות הם [little-endian](https://msdn.microsoft.com/en-us/library/dd773246(v#office.12).aspx#gt_079478cb-f4c5-4ce5-b72b-2144da5d2ce7) אלא אם צוין אחרת.

#### כותרת ####

הכותרת של קובץ ONE מורכבת מנתחים המכילים מזהים ושדות ייחודיים שונים לייצוג מידע קובץ כדלקמן:

`guidFileType (16 בתים):` GUID המציין את סוג קובץ מאגר הגרסאות. חייב להיות אחד מהערכים מהטבלה הבאה.

|פורמט קובץ|ערך
--- | --- |
|.one|{7B5C52E4-D88C-4DA7-AEB1-5378D02996D3}
|.onetoc2|{43FF2FA1-EFD9-4C76-9EE2-10EA5722765F}

`guidFile (16 בתים):` GUID המציין את הזהות של קובץ מאגר גרסאות זה. צריך להיות ייחודי בעולם.

`guidLegacyFileVersion (16 בתים):` חייב להיות "{00000000-0000-0000-0000-000000000000}" ויש להתעלם ממנו.

`guidFileFormat (16 בתים):` GUID המציין שהקובץ הוא קובץ מאגר גרסאות. חייב להיות "{109ADD3F-911B-49F5-A5D0-1791EDC8AED8}".

`ffvLastCodeThatWroteToThisFile (4 בתים):` מספר שלם ללא סימן. חייב להיות אחד מהערכים בטבלה הבאה, בהתאם לסוג הקובץ.

|פורמט קובץ|ערך
--- | --- |
|.one|0x0000002A
|.onetoc2|0x0000001B

`ffvOldestCodeThatHaswrittenToThisFile (4 בתים):` מספר שלם ללא סימן. חייב להיות אחד מהערכים בטבלה הבאה, בהתאם לפורמט הקובץ של קובץ זה.


|פורמט קובץ|ערך
--- | --- |
|.one|0x0000002A
|.onetoc2|0x0000001B

`ffvNewestCodeThatHasWrittenToThisFile (4 בתים):` מספר שלם ללא סימן. חייב להיות אחד מהערכים בטבלה הבאה, בהתאם לפורמט הקובץ של קובץ זה.
:


|פורמט קובץ|ערך
--- | --- |
|.one|0x0000002A
|.onetoc2|0x0000001B

`ffvOldestCodeThatMayReadThisFile (4 בתים):` מספר שלם ללא סימן. חייב להיות אחד מהערכים בטבלה הבאה, בהתאם לפורמט הקובץ של קובץ זה.


|פורמט קובץ|ערך
--- | --- |
|.one|0x0000002A
|.onetoc2|0x0000001B

## הפניות ##

* [[MS-ONESTORE] - פורמט קובץ OneNote](https://msdn.microsoft.com/en-us/library/dd951288(v#office.12).aspx)
* [Microsoft OneNote - ויקיפדיה](https://en.wikipedia.org/wiki/Microsoft_OneNote#References)

