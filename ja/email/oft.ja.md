{
  "date" : "2019-10-11",
  "author" : {
    "display_name" : "Kashif Iqbal"
},
  "draft" : "false",
  "toc" : true,
  "title" :"OFT - Microsoft Outlook 電子メール テンプレート ファイル",
  "description":"OFT ファイル形式と,OFT ファイルを作成して開くことができる API について学びます。",
  "linktitle" : "OFT",
  "menu" : {
    "docs" : {
      "parent" : "email"
}
},
  "lastmod" : "2019-09-10"
}

## .OFT オプション番号

拡張子が .oft のファイルは、Microsoft Outlook を使用して作成されたテンプレート ファイルです。メッセージ テンプレート用に設定された書式設定済みのレイアウトは、時間を節約するために共通情報を含む電子メールの送信に使用されます。このようなファイルは、新しい電子メールを作成し、必要な情報を追加してから、Microsoft Outlook の [Office テンプレートとして保存 (.oft)] ドロップダウンを使用して生成できます。ユーザーは OFT ファイルをダブルクリックして開くことができ、その特定のシステムの関連アプリケーションで開きます。

## OFT ファイル構造 ##

.OFT ファイル形式は、[MSG](/email/msg/) ファイル形式をベースに使用します。唯一の違いは、OFT ファイルは CLSID_TemplateMessage ({0006F046-0000-0000-C000-000000000046}) をストレージ クラス (WriteClassStg) として持つのに対し、MSG ファイルは CLSID_MailMessage ({00020D0B-0000-0000-C000-000000000046}) を使用することです。

CFB_3 形式は MSG ファイルのベースです。このパラダイムは、ストレージとストリームの概念に基づいており、ディレクトリとファイルに非常に近いものです。したがって、前者の主な違いは、複合ファイルと呼ばれる別個のファイルにパッケージ化された階層全体です。オブジェクトはメッセージ ファイルを構成し、単一のプロパティまたはそのコレクションで構成されます。この機能により、アプリケーションは複雑な構造化データを 1 つのファイルに簡単に格納できます。この形式は複数のストレージも指定します。各ストレージは Message オブジェクトを主要コンポーネントとして表します。これらのストレージには、そのコンポーネントのプロパティを表す多数のストリームが含まれています。収納のネスティングも可能です。

### OFT プロパティ

.msg ファイルの最上位にあるストレージには、プロパティを格納するストリームが含まれています。プロパティは次のように分類できます。

* 固定長のプロパティ
* 可変長プロパティ
* 多値プロパティ

カテゴリに関係なく、プロパティはタグ付きまたは名前付きのいずれかです。ただし、マッピング ストレージによって指定された名前付きプロパティには、適切なマッピング情報が必要です。

### OFT ストレージ

ストレージは、Message オブジェクトの主要コンポーネントを構成します。 MSG ファイル形式には、次のストレージが記載されています。

### トップレベルの構造

Message オブジェクトは、Msg ファイル形式のトップ レベル全体を表します。タイプ、プロパティ、受信者および添付オブジェクトの数に応じて、メッセージ オブジェクトは対応する .MSG ファイルに異なるストリーム ストレージを持つことができます。

#### 他の構造との関係

MSG/OFT ファイル形式には、他の構造と次のような関係があります。

※.msgのベースはCompound File Binary File Formatです。
* Message and Attachment Object Protocol で使用されるプロパティは、この形式で使用されます。

## 参考文献

* [[MS-OXMSG]: Outlook MSG ファイル形式](https://msdn.microsoft.com/en-us/library/cc463912(v#exchg.80).aspx)

