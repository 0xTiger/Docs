{
  "date" : "2019-10-11",
  "author" : {
    "display_name" : "Kashif Iqbal"
},
  "draft" : "false",
  "toc" : true,
  "title" :"EDBファイル形式 - Exchangeメールデータベースファイル",
  "description":"EDBファイルを作成して開くことができるEDBファイル形式とAPIについて学びます。",
  "linktitle" : "EDB",
  "menu" : {
    "docs" : {
      "parent" : "email"
}
},
  "lastmod" : "2020-09-16"
}

## .EDB オプション番号

.edb ファイル拡張子を持つファイルは、メール関連のデータを格納するために Microsoft Exchange Server によって作成されるメールボックス データベースです。 EDB、Exchange データベースは、インプロセスで非 SMTP のメッセージを保存します。 EDB は Extensible Storage Engine (ESE) データベース ファイルとも呼ばれ、b ツリー構造を使用してファイルを保存します。ストレージ ファイルである EDB ファイルは、[PST](/email/pst/) や [OST](/email/ost/) などの他のメール ストレージ ファイル形式に変換できます。

## EDB ファイル形式

参照できる公式/オープンな EDB ファイル形式の仕様はありません。ファイル形式のリバース エンジニアリングがある程度進んでおり、部分的な仕様のデコードが行われています。これらに従って、EDBファイルは次のもので構成されます。
* ファイル ヘッダー - データベース ファイルのヘッダー情報が含まれます
* 固定サイズのページ - テーブルとインデックスで構成されるデータベースが含まれています

### データベース ファイル ヘッダー
データベース ファイル ヘッダーは最初のデータベース ページにあり、少なくとも 668 バイトです。ファイル ヘッダーには、他のフィールドに加えて、「ファイル フォーマット バージョン」と「ファイル タイプ」が含まれます。

＃＃＃＃ ファイルタイプ
|タイプ|説明
---|---|
|0|データベース|
|1|ストリーミング|

`注:` これらのタイプの識別子は不明です。

#### ファイル形式のバージョン
EDB の元の形式は 1997 年 4 月に開始され、その後も変更のために進化を続けました。

|改訂日|バージョン|改訂|説明
---|---|---|---|
|1997年4月| 0x00000620|0x00000000|オリジナルのオペレーティング システムのベータ版。|
|1997 年 5 月 |0x00000620|0x00000001|条件付きインデックスと OLD のカタログに列を追加します。|
|1997 年 6 月|0x00000620|0x00000002|IDB に fLocalizedText フラグを追加します。|
|1997 年 10 月|0x00000620|0x00000003|スペース ツリーのルート ページに SPLIT_BUFFER を追加。|
||1998 年 1 月|0x00000620|0x00000002|ESE97 の上位互換性を維持するためにリビジョンを元に戻します。|
||0x00000620|0x00000003|新しいタグ付き列をカタログに追加します ("CallbackData" および "CallbackDependencies")。|
|1998 年 5 月|0x00000620|0x00000004|Super Long Value (SLV) のサポート: signSLV、fSLV は dbheader に存在します。|
|1998 年 5 月|0x00000620|0x00000005|新しい SLV スペース ツリー。|
|1998 年 10 月 |0x00000620|0x00000006|SLV スペース マップ。
|1998 年 12 月|0x00000620|0x00000007|4 バイトの IDXSEG.|
|1999 年 1 月|0x00000620|0x00000008|新しいテンプレート列フォーマット。|
|1999 年 6 月|0x00000620|0x00000009|テンプレートの列を並べ替えました。 Windows XP SP3 で使用|
||0x00000620|0x0000000b|Exchange で使用される ECC チェックサムを含むページ ヘッダーが含まれています|
||0x00000620|0x0000000c|Windows Vista (SP0) で使用|
||0x00000620|0x00000011|2 KiB、16 KiB、および 32 KiB ページのサポート。追加の ECC チェックサムを含む拡張ページ ヘッダー。列圧縮。スペース ヒント。Windows 7 (SP0) で使用|
|1999 年 5 月 |0x00000623|0x00000000|新しいスペース マネージャー。

### データベースファイル

EDB データベース ファイルには、データベース内のすべてのテーブルのスキーマが含まれています。さらに、すべてのデータベース テーブルのレコードとテーブルのインデックスも含まれます。その場所は、次の識別子によって決定されます。

* JetCreateDatabase
* JetCreateDatabase2
* JetAttachデータベース
* JetAttachDatabase2

これらに基づいて、データベースの状態を次のように評価できます。

|値|識別子|説明
---|---|---|
|1|JET_dbstateJustCreated|データベースが作成されました。|
|2|JET_dbstateDirtyShutdown|データベースを使用可能または移動可能にするには、ハード リカバリまたはソフト リカバリを実行する必要があります。この状態でデータベースを移動しようとしないでください。|
|3|JET_dbstateCleanShutdown|データベースはクリーンな状態です。データベースは、ログ ファイルなしでアタッチできます。|
|4|JET_dbstateBeingConverted|データベースをアップグレードしています。|
|5|JET_dbstateForceDetachInternal|この値は WindowsXP で導入されました|
 

## 参考文献
* [Extensible Storage Engine (ESE) データベース ファイル (EDB) の仕様](https://github.com/libyal/libesedb/tree/main/documentation)

