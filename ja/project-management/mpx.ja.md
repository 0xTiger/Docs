{
  "date" : "2019-10-11",
  "keywords" :[ "mpx ファイル", "mpx ファイル形式", "mpx ファイルとは", "ファイル", "mpx 例", "mpx ファイル拡張子","拡張子", "形式" ],
  "author" : {
    "display_name" : "Kashif Iqbal"
},
  "draft" : "false",
  "toc" : true,
  "title" :"MPX - Microsoft Project Exchange ファイル形式",
  "description":"MPX ファイル形式と,MPX ファイルを作成して開くことができる API について学びます。",
  "linktitle" : "MPX",
  "menu" : {
    "docs" : {
      "parent" : "project-management"
}
},
  "lastmod" : "2021-05-07"
}

## .MPX オプション番号##

拡張子が .mpx のファイルは、Microsoft Exchange ファイル形式です。 MPX ファイル形式は Microsoft Project (MSP) によって開発され、MSP と MPX ファイル形式をサポートする他のアプリケーション (Primavera Project Planner、Sciforma、Timerline Precision Estimating など) との間のプロジェクト情報の交換を容易にします。 MPX ファイルを使用すると、詳細なリソース割り当て情報、カレンダー情報、[プロジェクト情報] ダイアログ ボックスの情報など、あらゆる種類の情報をプロジェクトから別のシステムに転送できます。

Microsoft Project 4.0 では、Microsoft Project 98 まで引き続き使用されていた MPX ファイル形式の作成と読み取りのサポートが導入されました。ただし、MPX ファイルの作成のサポートは Microsoft Project 2000 のリリースを中止し、Microsoft Project 2010 までのバージョンは MPX 読み取りのみをサポートしています。 MPX ファイル形式は、MSP 2010 以降のバージョンではサポートされていません。

## MPX ファイル形式 ##

このセクションでは、MPX ファイルの仕様の概要について説明します。完全な仕様は、この [ナレッジ ベース](https://support.microsoft.com/en-us/office/file-formats-supported-by-project-desktop-face808f-77ab-4fce-9353-14144ba1b9ae) にあります。詳細については、記事を参照してください。

＃＃＃ 記録 ＃＃＃

MPX ファイルのレコードは、プロジェクトの情報で構成されています。各レコードには独自の順序があるさまざまな種類のレコードがあります。各レコード タイプは、そのレコード番号によって識別されます。 MPX ファイルの場合、File Creation レコード タイプを含める必要があります。他の種類の記録は必須ではありません。次の表は、すべてのレコード タイプ、それらのレコード番号、および各タイプが MPX ファイルに含めることができるレコードの数を示しています。 MPX ファイルに含めるレコードは、テーブルの順序に従って、任意の場所にコメントを挿入する必要があります。

|レコード名|レコード番号|最大レコード数
---|---|---|
|ファイルの作成 (必須)|なし|1
|通貨設定|10|1
|デフォルト設定|11|1
|日付と時刻の設定|12|1
|基本カレンダーの定義|20|250
|基本カレンダー時間|25|基本カレンダー定義レコードごとに 7
|基本カレンダー例外|26|基本カレンダー定義レコードごとに 250
|プロジェクト ヘッダー|30|1
|テキスト リソース テーブル定義|140|1- (または数値リソース テーブル定義レコードを使用できます)
|数値リソース テーブルの定義|41|1
|リソース|50|9,999
|リソースノート|51|リソース レコードごとに 1 つ
|リソース カレンダーの定義|55|リソース レコードごとに 1 つ
|リソース カレンダー時間|56|リソース カレンダーごとに 7
|リソース カレンダーの例外|リソース カレンダーあたり 57|250
|テキスト タスク テーブル定義|60|1 (または、数値タスク テーブル定義レコードを使用できます)
|数値タスク テーブルの定義|61|1
|タスク|70|9
|タスクノート|71|タスク レコードごとに 1 つ
|定期的なタスク|72|タスク レコードごとに 1 つ
|リソース割り当て|75|タスク レコードごとに 100
|割り当てワークグループ フィールド|76|割り当てレコードごとに 1 つ
|プロジェクト名|80|500
|DDE および OLE クライアント リンク|81|500
|コメント|0|無制限

### ファイル構造 ###

MPX ファイルは、ファイル内にあらかじめ設定された方法で配置されている上記のレコードで構成されています。これらのレコード タイプの詳細については、以下で説明します。

**ファイル作成記録 (FCR):** これは必須の記録で、以下を識別することを目的としています。

※ファイル形式（MPX）
* ファイルで使用されるリスト区切り文字
* ファイルの作成に使用されたプログラムとバージョン番号
* ファイルで使用されている MPX ファイル形式のバージョン番号
* ファイルの作成に使用されるコード ページ

これは、ファイルの最初のレコードでなければなりません。 Microsoft Project からエクスポートする場合、リスト区切り文字は、Windows コントロール パネルの [地域の設定] 項目で指定されます。 FCR レコードには、次のフィールドが含まれます。

* MPX の直後にリスト区切り文字が続く
* プログラム名/識別子
* ファイルのバージョン番号
* コード ページ (850、437、MAC、ANSI)

たとえば、レコードには **MPX, Microsoft Project, 3.0** という情報を含めることができます。これは、この MPX ファイルでリスト区切り文字としてカンマが使用されることを指定します。ファイルで使用される MPX 形式のバージョンは、Microsoft Project バージョン 3.0 からエクスポートされます。

**通貨設定** レコード番号 10 のこのレコードは、[オプション] ダイアログ ボックスの通貨オプションの設定を指定します。このレコードが含まれていない場合は、[オプション] ダイアログ ボックスの現在の設定が使用されます。 3 桁と 10 進数の区切り記号は、Windows コントロール パネルの [地域の設定] 項目で指定されます。
このレコードに含まれるフィールドは次のとおりです。

* 通貨記号
* シンボルの位置 (0 # 後、1 # 前、2 # 後ろにスペース、3 # 前にスペース)
* 通貨の数字 (0,1,2)
*千の区切り記号
* 小数点区切り

**例:** 10,$,1,2,",",.
この例では、通貨値の前にドル記号 ($) が含まれていること、小数点の後に 2 桁が含まれていること、カンマが千単位の区切りに使用されていること、ピリオドが小数点として使用されていることを指定しています。リストの区切り文字が千区切り記号フィールドに含まれているため、フィールドは引用符で囲まれています。

**既定の設定:** レコード番号 11 を持つこのレコードは、[オプション] ダイアログ ボックスの既定のオプションの設定を指定します。期間が指定されていない場合、正しい期間単位を計算するには、デフォルトの期間単位を設定する必要があります。このレコードが含まれていない場合は、[オプション] ダイアログ ボックスの現在の設定が使用されます。
このレコードに含まれるフィールドは次のとおりです。

* デフォルトの期間単位 (0 # 分、1 # 時間、2 # 日、3 # 週間)
* デフォルト期間タイプ (0 # 固定なし、1 # 固定)
* デフォルトの作業単位 (0 # 分、1 # 時間、2 # 日、3 # 週間)
* デフォルトの時間/日
* デフォルトの時間/週
* デフォルトの標準料金
* デフォルトの残業代
* タスク ステータスの更新リソース ステータスの更新 (0 # いいえ、1 # はい)
* 進行中のタスクを分割 (0 # いいえ、1 # はい)

**日付と時刻の設定:** レコード番号 12 を持つこのレコードは、[オプション] ダイアログ ボックスの日付と時刻のオプション、および [レイアウト] ダイアログ ボックスの [バー テキストの日付形式] オプションの設定を指定します。このレコードが含まれていない場合は、[オプション] ダイアログ ボックスの現在の設定が使用されます。
\\このレコードに含まれるフィールドは次のとおりです。

* 日付順 (0 # 月/日/年、1 # 日/月/年、2 # 年/月/日)
* 時刻形式 (0 # 12 時間、1 # 24 時間)
* デフォルト時間 (午前 0 時からの分数)
* 日付区切り
* 時間区切り
※0:00～11:59 テキスト
※12:00～23:59 テキスト
* 日付形式 (0 -14)*
* バー テキストの日付形式 (0 -194)*

**基本カレンダーの定義:** レコード番号 20 を持つこれらのレコードは、基本カレンダーとその稼働日と非稼働日を定義します。 1 日のエントリがない場合は、デフォルト設定が使用されます。デフォルト設定は、月曜日から金曜日までが稼働日で、土曜日と日曜日が非稼働日です。このレコードでは、名前フィールドは必須です。それぞれの日について、エントリ 0 はその日が非稼働日であることを示し、エントリ 1 はその日が稼働日であることを示します。
このレコードに含まれるフィールドは次のとおりです。

* 名前
* 日曜日
* 月曜日
* 火曜日
* 水曜日
* 木曜日
* 金曜日
* 土曜日

**基本カレンダー時間:** レコード番号 25 を持つこれらのレコードは、既定の設定と異なる場合、曜日の稼働時間を指定します。デフォルトの稼働時間は、午前 8 時から午後 12 時までと午後 1 時から午後 5 時です。各基本カレンダー時間レコードは、前の基本カレンダー定義レコードを参照します。これらのレコードのうち最大 7 つまでを、各基本カレンダー定義レコードに続けることができます。

* 曜日 (1 - 7、1 # 日曜日と 7 # 土曜日)
※1回目から
* 時間 1 へ
※2回目以降
* 時間 2 へ
※3時から
* 時間 3 へ

**基本カレンダーの例外:** レコード番号 26 を持つこれらのレコードは、前の 2 つのレコード タイプで指定された日と時間に対する例外を定義します。これらのレコードを最大 250 まで、各基本カレンダー定義レコードに続けることができます。これらの記録は、時系列順にリストする必要があります。例外が 1 日である場合は、[終了日] フィールドを空のままにすることができます。時刻が指定されていない場合は、午前 8 時から午後 12 時までと午後 1 時から午後 5 時までの既定の時刻が使用されます。
このレコードに含まれるフィールドは次のとおりです。

* 開始日
* 現在まで
* 非稼働/稼働 (0 # 非稼働、1 # 稼働)
※1回目から
* 時間 1 へ
※2回目以降
* 時間 2 へ
※3時から
* 時間 3 へ

**プロジェクト ヘッダー:** レコード値 30 を持つこのレコードは、プロジェクトの開始日やプロジェクトの終了日など、グローバル プロジェクト フィールドを設定します。このレコードのフィールドは、[プロジェクト情報] ダイアログ ボックスと [統計] ダイアログ ボックスの情報に対応しています。
このレコードに含まれるフィールドとタブは次のとおりです。

* プロジェクトタブ
* 会社
* マネジャー
・カレンダー（無記入の場合は標準）
* 開始日 (Schedule From 設定に応じて、インポートされたファイルに対してこのフィールドまたは次のフィールドのいずれかが計算されます)
* 終了日
* スケジュール開始 (0 # 開始、1 # 終了)
* 現在の日付*
* コメント
* 料金
* ベースライン コスト
* 実費
* 仕事
* ベースライン作業
* 実働
* 仕事
* 間隔*
*ベースライン期間*
*実際の期間
* 完了率
* ベースライン開始
* ベースライン仕上げ
*実際の開始
*実際の仕上がり
* 開始時の差異
* 仕上がりのばらつき
* 主題
* 著者
* キーワード

**Text Resource Table Definition**: このレコードは、インポートまたはエクスポートされるリソース フィールドを順番にリストします。インポートされたファイルの場合、名前は Microsoft Project で使用されるフィールド名と一致する必要があります。エクスポートされたファイルの場合、このレコードはリソースのエクスポート テーブルから取得されます。このレコードまたは数値リソース テーブル定義レコードのいずれかを使用する必要があります。 Microsoft Project からエクスポートする場合、これらのレコードの両方が含まれます。

**数値リソース テーブル定義:** 名前ではなく数字を使用して、このレコードは、インポートまたはエクスポートされるリソース フィールドを順番にリストします。これは、各リソース レコードに含まれるリソース フィールドを識別する代替方法であり、外国語製品で作成された MPX ファイルを定義するときに役立ちます。

**リソース:** これらのレコードには、インポートまたはエクスポートされる各リソースの情報が含まれています。各 Resource レコードは、1 つのリソースを記述します。情報をインポートすると、含まれるフィールドはテキスト リソース テーブル定義レコードまたは数値リソース テーブル定義レコードによって定義されます。情報をエクスポートすると、リソースのエクスポート テーブルにリストされているフィールドが含まれます。

**リソース ノート:** これらのレコードには、直前のリソース レコードに関するノートが含まれます。メモ内の改行には、ASCII 文字 127 が使用されます。メモにリスト区切り文字が含まれている場合は、メモを引用符で囲みます。

**リソース カレンダーの定義:** これらのレコードは、直前のリソース レコードで指定されたリソースの稼働日を定義します。インポートされたファイルの場合、[基本カレンダー名] フィールドにエントリがない場合、標準が使用されます。特定の日のエントリがない場合は、その日がデフォルト (2) に設定されていることを示します。リソース カレンダー定義レコードがない場合、リソースの基本カレンダーとして標準が使用され、日付にはデフォルトが使用されます。各日について、エントリ 0 はその日が非稼働日であることを示し、1 はその日が稼働日であることを示し、2 はデフォルトが使用されることを示します。

**リソース カレンダー時間:** これらのレコードは、リソースが使用する基本カレンダーとは異なる、リソースの作業時間を定義します。これらのレコードは、このレコードの直前のリソース カレンダー定義レコードに適用されます。各リソース カレンダー定義レコードの後に、これらのレコードを 7 つまで追加できます。

**リソース カレンダーの例外:** これらのレコードは、前の 2 つのレコード タイプで指定された日と時間に対する例外を定義します。これらのレコードは最大 250 個まで、各リソース カレンダー定義レコードに続くことができます。これらの記録は、時系列順にリストする必要があります。例外が 1 日だけの場合は、[終了日] フィールドを空のままにすることができます。時刻が指定されていない場合は、午前 8 時から午後 12 時までと午後 1 時から午後 5 時までの既定の時刻が使用されます。

**テキスト タスク テーブル定義:** このレコードは、インポートまたはエクスポートされるタスク フィールドを順番にリストします。インポートされたファイルの場合、名前は Microsoft Project で使用されるフィールド名と一致する必要があります。ファイルがエクスポートされている場合、このレコードはタスクのエクスポート テーブルから取得されます。 Microsoft Project からエクスポートする場合、これらのレコードの両方が含まれます。スケジュールされた開始日やスケジュールされた終了日など、Microsoft Project によって計算されるフィールドは、インポートされると無視されます。タスクの開始日または終了日が固定されている場合は、[制約の種類] フィールドと [制約の日付] フィールドを使用します。

**数値タスク テーブル定義:** このレコードは、名前ではなく数字を使用して、インポートまたはエクスポートされるタスク フィールドを順番にリストします。これは、各タスク レコードに含まれるタスク フィールドを識別する代替方法であり、外国語製品で作成された MPX ファイルを定義するときに役立ちます。

**タスク:** これらのレコードには、インポートまたはエクスポートされる各タスクの情報が含まれています。各タスク レコードは、1 つのタスクを記述します。情報をインポートすると、含まれるフィールドはテキスト タスク テーブル定義レコードまたは数値タスク テーブル定義レコードによって定義されます。情報をエクスポートする場合、含まれるフィールドは、タスクのエクスポート テーブルにリストされているフィールドです。

**タスク メモ:** これらのレコードには、直前のタスク レコードに関するメモが含まれます。メモ内の改行を示すには、ASCII 文字 127 を使用します。メモにリスト区切り文字が含まれている場合は、メモを引用符で囲みます。

**リソースの割り当て**: これらのレコードには、前のタスク レコードで定義されたタスクに割り当てられたリソースに関する情報が一覧表示されます。ファイルをマージしていて、リソースの割り当て情報を保持したい場合は、その情報を MPX ファイルに含める必要があります。マージすると、マージされたタスクの既存の割り当てはすべて削除されます。一意の ID に基づいてファイルをマージする場合、リソースは ID ではなくリソースの一意の ID を使用して割り当てられます。

**リソース割り当てワークグループ フィールド:** これらのレコードには、Microsoft Project 4.0 および 4.1 のワークグループ機能の割り当てごとに保存される情報が一覧表示されます。ワークグループ機能を使用している場合は、情報が失われないように、このレコードを含める必要があります。

**プロジェクト名:** これらのレコードには、プロジェクトに保存されているすべての DDE リンク名が一覧表示されます。

**DDE および OLE クライアント リンク:** これらのレコードには、プロジェクトへの DDE リンクが一覧表示されます。

**コメント:** これらのレコードは、ファイルにコメントを追加するために使用でき、ファイル内の任意の位置に表示できます。各コメント レコードは、「0」で始まる必要があります。

## MPX ファイルを開く際の問題 ##

MPX 形式の誤動作の原因となる一般的な問題の一覧を次に示します。

*サポートソフトウェアの不在
* 破損したファイル
* ウイルスによる感染ファイル
* システムにファイルを開くためのアクセス権がありません
* システムの古いドライブ
※ファイルの拡張子はリネーム

## 参照 ##

* [MPX - マイクロソフト ナレッジ ベース](https://support.microsoft.com/en-us/office/file-formats-supported-by-project-desktop-face808f-77ab-4fce-9353-14144ba1b9ae)

