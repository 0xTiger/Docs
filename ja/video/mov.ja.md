{
  "date" : "2019-10-11",
  "keywords" :["movファイル","movファイル形式","movファイルとは","ファイル","mov例","movファイル拡張子","拡張子","形式","QuickTime","MPEG- 4"],
  "author" : {
    "display_name" : "Kashif Iqbal"
},
  "draft" : "false",
  "toc" : true,
  "title" :"MOV ファイル - Apple QuickTime ムービー ファイル形式",
  "description":"MOV ファイル形式と,MOV ファイルを作成して開くことができる API について学びます。",
  "linktitle" : "MOV",
  "menu" : {
    "docs" : {
      "parent" : "video"
}
},
  "lastmod" : "2021-07-29"
}

## .MOV ファイルとは何ですか?

MOV ファイルは、1 つまたは複数のトラックを含む、Apple Inc. によって開発されたビデオ ファイル タイプです。各トラックには、ムービー、オーディオ、ムービー クリップ、および字幕が保存されます。さまざまな種類のメディア要素を格納できるマルチメディア コンテナーです。 MOV ビデオ形式は、Windows システムと Macintosh システムの両方と互換性があります。圧縮には MPEG-4 コードが使用され、トラックはアトムと呼ばれるオブジェクトで維持され、階層データ構造に配置されます。

## MOVファイル形式の歴史

MPEG-4 ファイル形式は、2001 年の QuickTime ファイル形式 (**QTFF**) 仕様から進化しました。国際標準化機構はこの形式を承認し、MPEG-4 パート 1 システム仕様は 1999 年に公開されました。2001 年に改訂ファイル形式 [MP4](/video/mp4/) を公開しました。

MP4 の最初のバージョンは、2003 年に MPEG-4 Part 14 (ISO/IEC 14496-14:2003) として改訂されました。 2004 年、MP4 は一般化され、すべての時間ベースのメディア ファイルの一般的な構造が定義されました。そのため、現在では、他のさまざまなマルチメディア ファイル形式のベースとして使用されています。

## QuickTime ファイル形式 (QTFF) - 詳細情報

デジタル マルチメディアを扱うために、QTFF は多くの種類のデータを保持できます。フォーマットは、あらゆる種類のメディア構造を記述するための標準を定義するため、デジタル メディアの交換のためのアイデア フォーマットです。ファイル形式は、オブジェクト指向オブジェクトの柔軟なコレクションで構成されています。ムービーをディスクに保存するために、QuickTime は `atoms` と `QT atom` の 2 つの構造を使用します。

### アトム

Atom は、QuickTime ファイルの基本単位です。どのアトムにも、他のどのフィールドよりも前に、サイズ フィールドとタイプ フィールドという 2 つの主要なフィールドがあります。 size フィールドはアトムのサイズを示し、type フィールドはアトムに格納されているデータのタイプを示します。本質的に、アトムは階層的です。つまり、1 つのアトムは他のアトムを含むことができ、他のアトムを含むことができます。サンプル アトムのレイアウトを次の図に示します。

各アトムには、`header` と `data` の 2 つの部分があります。ヘッダーにはサイズとタイプのフィールドが含まれ、データ部分には実際のデータが含まれます。さらに、各フィールドについて以下に説明します。

### 原子サイズ

アトムのヘッダーと内容は、アトムのサイズとして知られる 32 ビット整数で示されます。サイズ フィールドには、32 ビットの符号なし整数で表されたバイト単位のアトムのサイズが含まれます。

### 原子タイプ

アトムのタイプも 32 ビットの整数で示され、ムービー アトムの場合は 'moov' (0x6D6F6F76)、映画アトムの場合は 'trak' (0x7472616B) などのニーモニック値を持つ 4 文字のフィールドとして扱われることがほとんどです。トラック アトム。原子タイプがわかると、そのデータを解釈できます。

### QT Atom と Atom コンテナー

QT アトムは汎用ストレージ形式を提供し、サイズ、タイプ、アトム ID、および子アトム フィールドの数で構成される拡張ヘッダーを持ちます。 QT アトムは、ロック カウントを持つヘッダーを持つ一意のデータ構造であるアトム コンテナーにラップされます。各アトム コンテナーには、QT アトムである 1 つのルート アトムがあります。 QT アトムのレイアウトを下図に示します。

QT アトム コンテナー ヘッダーには、次のデータがあります。

予約済み: 値が 0 の 10 バイトの要素。

ロック数: 値が 0 の 16 ビット整数。

QT アトム ヘッダーには次のデータがあります。

**サイズ -** QT アトムのヘッダーと内容は、32 ビット整数のバイト単位で示されます。リーフ アトムの場合、このフィールドには 1 つのアトムのサイズが含まれます。

**Type -** アトムの型は 32 ビット整数で示されます。ルート アトムの場合、値は「sean」に設定されます。

**Atom ID -** アトム ID を示す 32 ビットの整数で、すべての兄弟に対して一意である必要があります。ルート アトムは常にアトム ID の値を 1 にします。

**予約済み -** 0 に設定する必要がある 16 ビット整数。

**Child count -** アトムの子アトムの数を示す 16 ビット整数。

**予約済み -** 0 に設定する必要がある 32 ビット整数。

## MOVファイルのファイル構造

MOV ファイルは、連続したチャンクで構成されます。すべてのチャンクには 8 バイトのヘッダーがあります。4 バイトのチャンク サイズ (ビッグ エンディアン、上位バイトが最初) と 4 バイトのチャンク タイプ - 定義済みの署名の 1 つ: "ftyp"、"mdat"、"moov"、"pnot "、"udta"、"uuid"、"moof"、"free"、"skip"、"jP2"、"wide"、"load"、"ctab"、"imap"、"matt"、"kmat"、 「clip」、「crgn」、「sync」、「chap」、「tmcd」、「scpt」、「ssrc」、「PICT」。最初のチャンクは「ftype」タイプで、オフセット 8 にサブタイプがあります。サブタイプで定義された MOV は「qt」でなければなりません。 MOV ファイルを構成するには、不明なタイプが検出されるまでチャンクを反復する必要があります。

サンプル MOV ファイルのバイナリ データを調べると、QuickTime コンテナ ファイル タイプを定義するオフセット 4 の署名 **ftyp** (hex: 66 74 79 70) で始まることが明らかです。ファイルのサブタイプは **qt~_~_** (16 進数: 71 74 20 20) で、MOV ファイル タイプを指します。最初のブロック サイズは 32 (16 進数: 00 00 00 20、ビッグ エンディアン、上位バイトが最初) で、サイズはオフセット 0 にあります。オフセット 32 (16 進数: 20) には、サイズが 8 で、 **mdat** (16 進数: 6D 64 61 74) と入力します。

次のチャンクは、オフセット 32+8#40 (16 進数: 28) にあり、サイズは 3,263,028 (16 進数: 00 31 CA 34) で、オフセット 44 (16 進数: 16 進数: ：2C）。次のチャンクは、オフセット 40 + 3,263,028#3,263,068 (16 進数: 00 31 CA 5C) にあり、サイズは 21,189 (16 進数: 00 00 52 C5) で、オフセットで **moov** (16 進数: 6D 6F 6F 76) とタイプされます。 1,836,019,574 (16 進数: 00 31 CA 60)。これが最後のチャンクなので、合計ファイル サイズは 3,263,068+21,189#3,284,257 バイトです。

## MOVファイルを変換する方法?

MOVファイルを他の一般的なビデオファイル形式に変換するために利用できるメディアプレーヤーとソフトウェアビデオエディターはたくさんあります. MOV ファイルを他の形式に変換できるメディア プレーヤーには、次のものがあります。

* VideoLAN VLC メディア プレーヤー
* エルティマ エルメディア プレイヤー

VideoLAN VLC メディア プレーヤーや Eltima Elmedia Player など、いくつかのメディア プレーヤーとビデオ エディターは、MOV ファイルを他の形式に変換できます。これらのソフトウェアは、MOV ファイルを次のビデオ形式に変換できます。

* MPEG-4 ビデオ - [MP4](/video/mp4/)
* WebM ビデオ - [WEBM](/video/webm/)
* ビデオ トランスポート ストリーム - [TS](/video/ts/)
* 高度なシステム フォーマット - [ASF](/video/ts/)
* Ogg Vorbis オーディオ - [OGG](/audio/ogg/)
* MP3 オーディオ - [MP3](/audio/mp3/)
* 無料のロスレス オーディオ コーデック - [FLAC](/audio/flac/)
* WAVE オーディオ - [WAV](/audio/wav/)

## MOV ファイル用のオープンソース API

* [MOVをMP4に変換するReact Native API](https://github.com/taltultc/react-native-mov-to-mp4)
* [MOV ファイルを修復する Python API](https://github.com/nrosenstein-stuff/movrepair)
* [MOVをGIFに変換するRuby API](https://github.com/skygroundmedia/convert-mov-to-gif)

## 参考文献

* [https://en.wikipedia.org/wiki/QuickTime_File_Format](https://en.wikipedia.org/wiki/QuickTime_File_Format)

