{
  "date" : "2019-12-16",
  "keywords" :[ "Lotus 123", "ファイル", "拡張子", "ファイル形式", "Excel", "スプレッドシート" ],
  "author" : {
    "display_name" : "Kashif Iqbal"
},
  "draft" : "false",
  "toc" : true,
  "description" :"Lotus 123 ファイルとは何か,および 123 ファイルを作成して開くことができる API を知るためのファイル形式ガイド。",
  "title" :"Lotus 123 ファイル形式とは? ファイル形式の専門家から学ぶ!",
  "linktitle" : "123",
  "menu" : {
    "docs" : {
      "parent" : "spreadsheet"
}
},
  "lastmod" : "2021-06-27"
}

## Lotus 123 ファイルとは何ですか?

拡張子が .123 のファイルは、IBM Lotus SmartSuite の表計算ソフトウェアである Lotus 1-2-3 で作成された表計算ファイルです。 1990 年代初頭に Microsoft Excel アプリケーションに追い抜かれるまで、かなり長い間使用されていました。 Lotus スプレッドシート ファイルのデータは、現在の Excel ファイルと同様に、行と列で編成されていて、さまざまな計算関数を適用できました。 Lotus スプレッドシート ファイル形式のいくつかの異なるバージョンは、.wks、.wk1、.wk2、.wk3、および .wk4 などのさまざまな拡張子で進化し続け、拡張子の数値の増分ごとに変更が加えられました。 Lotus は 2013 年に正式に廃止されました。

## Lotus 123 ファイル形式 - 詳細情報

Lotus ファイルはバイナリ ファイルであり、未加工の形式で開いた場合、読み取ったり解釈したりすることはできません。そのファイル形式の仕様は、次のリンクで参照用のアーカイブとして入手できます。

※【仕様】(https://web.archive.org/web/20180129005324/http://www.schnarff.com/file-formats/lotus-1-2-3/WSFF1.TXT)
* [レコード タイプの概要](https://web.archive.org/web/20180130195323/http://www.schnarff.com/file-formats/lotus-1-2-3/WSFF2.TXT)
* [セルフォーマットエンコーディング](https://web.archive.org/web/20180130195328/http://www.schnarff.com/file-formats/lotus-1-2-3/WSFF3.TXT)
* [式コンパイラ](https://web.archive.org/web/20180130195348/http://www.schnarff.com/file-formats/lotus-1-2-3/WSFF4.TXT)

各ファイルは、可変長バイナリ レコードの途切れのないシーケンスとして編成されます。

### Lotus 123 ファイル ヘッダー

Lotus 123 スプレッドシート ファイルの各レコードは、4 バイトのヘッダーとそれに続くレコード本体で構成されます。ヘッダーは、レコードのタイプと長さも定義します。ヘッダー構成は以下の通りです。

|バイト番号|バイトの説明|
---|---|
|0,1|レコードタイプコード|
|2,3|レコード本体の長さ (バイト)|

## レコードの種類

Lotus スプレッドシート ファイルには、さまざまな種類のレコードを含めることができます。これらは、可変長だけでなく、あらかじめ決められた長さでもあります。次の表は、Op Code 別に並べられたさまざまなレコード タイプを示しています。

|タイプ|コード (16 進数)|長さ (バイト)|説明|
---|---|---|---|
|BOF|0|2|ファイルの先頭 |
|EOF|1|0|ファイルの終わり |
|CALCMODE |2|1|計算モード|
|計算機 |3|1|計算順序|
|分割 |4|1|分割窓タイプ |
|同期 |5|1|分割ウィンドウ同期 |
|範囲 |6|8|アクティブなワークシート範囲 |
|WINDOW1 |7|31|ウィンドウ 1 レコード |
|COLW1 |8|3|列幅、ウィンドウ 1 |
|WINTWO |9|31|ウィンドウ 2 レコード
|COLW2 |A|3|列幅、ウィンドウ 2 |
| |名前 |B|24|名前付き範囲 |
| |空白 |C|5|空白のセル |
| |整数 |D|7|整数セル |
|NUMBER |E|13|浮動小数点数 |
|LABEL |F|変数|ラベルセル |
|式 |10|変数|数式セル |
|表 |18| 25|データ テーブル範囲 |
|オレンジ |19| 25|クエリ範囲 |
|プランジ |1A| 8|印刷範囲 |
|SRANGE |1B| 8|ソート範囲 |
|フランジ |1C| 8|塗りつぶし範囲 |
|KRANGE1 |1D| 9|プライマリ ソート キー範囲 |
|フランジ |20| 16|分布範囲 |
|KRANGE2 |23| 9|セカンダリ ソート キー範囲 |
|プロテック |24| 1|グローバルな保護 |
|フッター |25| 242|フッターを印刷 |
|ヘッダー |26| 242|ヘッダーを印刷 |
|セットアップ |27| 40|印刷設定 |
|余白 |28| 10|余白コードを印刷|

## 参考文献

* [ロータス 1-2-3](https://en.wikipedia.org/wiki/Lotus_1-2-3)
* [ArchiveTeamによるLotus 1-2-3](http://justsolve.archiveteam.org/wiki/Lotus_1-2-3)

