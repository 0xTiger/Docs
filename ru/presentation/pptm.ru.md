{
  "date" : "2019-10-11",
  "keywords" :[ "файл pptm", "формат файла pptm", "что такое файл pptm", "файл", "пример pptm", "расширение файла pptm", "расширение", "формат" ],
  "author" : {
    "display_name" : "Kashif Iqbal"
},
  "draft" : "false",
  "toc" : true,
  "title" :"PPTM — формат файла презентации PowerPoint с поддержкой макросов",
  "description":"Узнайте о формате файла PPTM и API, которые могут создавать и открывать файлы PPTM.",
  "linktitle" : "PPTM",
  "menu" : {
    "docs" : {
      "parent" : "presentation"
}
},
  "lastmod" : "2019-09-10"
}

Файлы с расширением PPTM представляют собой файлы презентаций с поддержкой макросов, созданные с помощью Microsoft PowerPoint 2007 или более поздних версий. Они аналогичны файлам [PPTX](/ru/presentation/pptx/) с той разницей, что боковые файлы не могут выполнять макросы, хотя могут содержать макросы. Файлы PPTM можно редактировать, открыв их в Microsoft PowerPoint и обновив содержимое. Другой похожий формат — PPSM, но по умолчанию он доступен только для чтения и запускает слайд-шоу при открытии. PPTM, как и PPTX, содержит слайды для различных элементов презентации, таких как текст, изображения, видео, графики и другие сопутствующие материалы.

## Краткая история ##

Формат файла PPTM был введен в 2007 году и использует стандарт Open XML, адаптированный Microsoft еще в 2000 году. Новый тип файла имеет дополнительные преимущества небольшого размера файла, меньшего количества изменений в повреждении и хорошо отформатированного представления изображений. Это было в начале 2000 года, когда Microsoft решила внести изменения, чтобы приспособить стандарт для **Office Open XML**. К 2007 году этот новый формат файлов стал частью Office 2007 и поддерживается также в новых версиях Microsoft Office.

## Спецификации формата файла ##

Файлы, созданные с помощью офисного формата файлов Open XML, представляют собой набор файлов XML вместе с другими файлами, которые обеспечивают связи между всеми составными файлами. Эта коллекция на самом деле представляет собой сжатый архив, который можно распаковать, чтобы просмотреть его содержимое. Для этого просто переименуйте расширение файла PPTM в zip и извлеките его, чтобы просмотреть его содержимое.

Следующие разделы проливают свет на каждый из них.

### [Типы содержимого].xml ###

Это единственный файл, который находится на базовом уровне при распаковке zip-архива. В нем перечислены типы содержимого для частей внутри пакета. Все ссылки на XML-файлы, включенные в пакет, указаны в этом XML-файле. Ниже приведен тип содержимого для части слайда:
```
<Override PartName#"/ppt/slides/slide1.xml" ContentType#"application/vnd.openxmlformats-officedocument.presentationml.slide+xml"/>
```
Если в пакет необходимо добавить новые части, это можно сделать, добавив новую часть и обновив все отношения в файлах .rels. Следует иметь в виду, что для такого изменения необходимо также обновить Content_Types.xml.

### \_rels (папка) ###

Отношения между другими частями и ресурсами вне пакета поддерживаются частью отношений. Папка «Отношения» содержит один XML-файл, в котором хранятся отношения на уровне пакетов. Ссылки на ключевые части файлов презентации содержатся в этом файле в виде URI. Эти URI определяют тип отношения каждой ключевой части к пакету. Это включает отношение к основному офисному документу, расположенному как ppt/presentation.xml, и другим частям в docProps в качестве основных и расширенных свойств.
```
<Relationship Id#"rId1" Type#"http:~/~/schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument" Target#"ppt/presentation.xml"/>.
```
Каждая часть документа, являющаяся источником одного или нескольких взаимосвязей, будет иметь свою собственную часть взаимосвязей, где каждая такая часть взаимосвязи находится в подпапке \_rels части и именуется путем добавления '.rels' к имени часть. Основная часть содержимого (presentation.xml) имеет собственную часть отношений (presentation.xml.rels). Он содержит связи с другими частями содержимого, такими как slideMaster1.xml, notesMaster1.xml, handoutMaster1.xml, slide1.xml, presProps.xml, tableStyles.xml, theme1.xml, а также URI для внешних ссылок.

#### Явная связь ####

Для явной связи ресурс ссылается с использованием атрибута Id объекта.<Relationship> элемент. То есть идентификатор в источнике сопоставляется непосредственно с идентификатором элемента отношения с явной ссылкой на цель.

Например, слайд может содержать такую гиперссылку:
```
<a:hlinkClick r:id#"rId2">
```
r:id#"rId2" ссылается на следующую связь в части отношений для слайда (slide1.xml.rels).
```
<Relationship Id#"rId2" Type#"http:~/~/. . ./hyperlink" Target#"http:~/~/www.google.com/" TargetMode#"External"/>
```
#### Неявная связь ####

Для неявной связи нет такой прямой ссылки на `<Relationship> Идентификатор`. Вместо этого ссылка понимается.

### Папка ppt ###

Это основная папка, содержащая все подробности о содержимом презентации. По умолчанию он имеет следующие папки:

* \_rels
* тема
* слайды
* макеты слайдов
* мастера слайдов

и следующие xml-файлы:

* презентация.xml
* преспропс.xml
* таблицаСтили.xml
* viewProps.xml

## Использованная литература ##

* [[MS-PPTX] — формат файла PPTX](https://msdn.microsoft.com/en-us/library/dd926741(v#office.12).aspx)
* [Open Office XML](http://officeopenxml.com/anatomyofOOXML-pptx.php)

