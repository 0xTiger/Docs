{
  "date" : "2019-10-11",
  "keywords" :[ "potm файл", "формат файла potm", "что такое файл potm", "файл", "пример potm", "расширение файла potm", "расширение", "формат" ],
  "author" : {
    "display_name" : "Kashif Iqbal"
},
  "draft" : "false",
  "toc" : true,
  "title" :"POTM — файл шаблона Microsoft PowerPoint с макросами",
  "description":"Узнайте о формате файла POTM и API-интерфейсах, которые могут создавать и открывать файлы POTM.",
  "linktitle" : "POTM",
  "menu" : {
    "docs" : {
      "parent" : "presentation"
}
},
  "lastmod" : "2019-09-10"
}

## .POTM вариант №

Файлы с расширением POTM представляют собой файлы шаблонов Microsoft PowerPoint с поддержкой макросов. Файлы POTM создаются с помощью PowerPoint 2007 или более поздней версии и содержат настройки по умолчанию, которые можно использовать для создания дополнительных файлов презентаций. Эти настройки могут включать стили, фон, цветовую палитру, шрифты и значения по умолчанию, а также макросы, состоящие из пользовательских функций для выполнения конкретной задачи. Их также можно открыть в предыдущей версии PowerPoint с установленной поддержкой документов Open XML. Файлы POTM можно открывать в Microsoft PowerPoint для редактирования, как и любой другой файл PowerPoint.

## Спецификации формата файла ##

Формат файла POTM основан на спецификациях Office OpenXML и напоминает структуру файла [PPTX](/ru/presentation/pptx/), который представляет собой сжатый архив [ZIP](/ru/compression/zip/).

Слайды внутри файла POTM могут содержать текст, изображения, видео, графику и другие объекты, которые можно свободно размещать на странице. Затем шаблоны POTM используются для создания нескольких файлов, которые наследуют все параметры форматирования файла. Следовательно, макросы, содержащиеся в файле POTM, наследуются и другими презентациями. Встраивание их в структуру документа осуществляется с помощью средства записи макросов, входящего в состав MS Office, которое может сохранять последовательности команд и создавать макросы для их автоматического воспроизведения.

Файлы, созданные с помощью офисного формата файлов Open XML, представляют собой набор файлов XML вместе с другими файлами, которые обеспечивают связи между всеми составными файлами. Эта коллекция на самом деле представляет собой сжатый архив, который можно распаковать, чтобы просмотреть его содержимое. Для этого просто переименуйте расширение файла POTM в zip и извлеките его, чтобы просмотреть его содержимое.

Следующие разделы проливают свет на каждый из них.

### [Типы содержимого].xml ###

Это единственный файл, который находится на базовом уровне при распаковке zip-архива. В нем перечислены типы содержимого для частей внутри пакета. Все ссылки на XML-файлы, включенные в пакет, указаны в этом XML-файле. Ниже приведен тип содержимого для части слайда:
```
<Override PartName#"/ppt/slides/slide1.xml" ContentType#"application/vnd.openxmlformats-officedocument.presentationml.slide+xml"/>
```
Если в пакет необходимо добавить новые части, это можно сделать, добавив новую часть и обновив все отношения в файлах .rels. Следует иметь в виду, что для такого изменения необходимо также обновить Content_Types.xml.

### \_rels (папка) ###

Отношения между другими частями и ресурсами вне пакета поддерживаются частью отношений. Папка «Отношения» содержит один XML-файл, в котором хранятся отношения на уровне пакетов. Ссылки на ключевые части файлов презентации содержатся в этом файле в виде URI. Эти URI определяют тип отношения каждой ключевой части к пакету. Это включает отношение к основному офисному документу, расположенному как ppt/presentation.xml, и другим частям в docProps в качестве основных и расширенных свойств.
```
<Relationship Id#"rId1" Type#"http:~/~/schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument" Target#"ppt/presentation.xml"/>.
```
Каждая часть документа, являющаяся источником одного или нескольких взаимосвязей, будет иметь свою собственную часть взаимосвязей, где каждая такая часть взаимосвязи находится в подпапке \_rels части и именуется путем добавления '.rels' к имени часть. Основная часть содержимого (presentation.xml) имеет собственную часть отношений (presentation.xml.rels). Он содержит связи с другими частями содержимого, такими как slideMaster1.xml, notesMaster1.xml, handoutMaster1.xml, slide1.xml, presProps.xml, tableStyles.xml, theme1.xml, а также URI для внешних ссылок.

#### Явная связь ####

Для явной связи ресурс ссылается с использованием атрибута Id объекта.<Relationship> элемент. То есть идентификатор в источнике сопоставляется непосредственно с идентификатором элемента отношения с явной ссылкой на цель.

Например, слайд может содержать такую гиперссылку:
```
<a:hlinkClick r:id#"rId2">
```
r:id#"rId2" ссылается на следующую связь в части отношений для слайда (slide1.xml.rels).
```
<Relationship Id#"rId2" Type#"http:~/~/. . ./hyperlink" Target#"http:~/~/www.google.com/" TargetMode#"External"/>
```
#### Неявная связь ####

Для неявной связи нет такой прямой ссылки на `<Relationship> Идентификатор`. Вместо этого ссылка понимается.

### Папка ppt ###

Это основная папка, содержащая все подробности о содержимом презентации. По умолчанию он имеет следующие папки:

* \_rels
* тема
* слайды
* макеты слайдов
* мастера слайдов

и следующие xml-файлы:

* презентация.xml
* преспропс.xml
* таблицаСтили.xml
* viewProps.xml

## Использованная литература ##

* [[MS-PPTX] — формат файла PPTX](https://msdn.microsoft.com/en-us/library/dd926741(v#office.12).aspx)
* [Open Office XML](http://officeopenxml.com/anatomyofOOXML-pptx.php)

