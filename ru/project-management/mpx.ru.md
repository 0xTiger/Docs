{
  "date" : "2019-10-11",
  "keywords" :[ "файл MPX", "формат файла MPX", "что такое файл MPX", "файл", "пример MPX", "расширение файла MPX", "расширение", "формат" ],
  "author" : {
    "display_name" : "Kashif Iqbal"
},
  "draft" : "false",
  "toc" : true,
  "title" :"MPX — формат файла Microsoft Project Exchange",
  "description":"Узнайте о формате файла MPX и API-интерфейсах, которые могут создавать и открывать файлы MPX.",
  "linktitle" : "MPX",
  "menu" : {
    "docs" : {
      "parent" : "project-management"
}
},
  "lastmod" : "2021-05-07"
}

## .MPX вариант № ##

Файл с расширением .mpx является форматом файлов Microsoft Exchange. Формат файла MPX был разработан Microsoft Project (MSP) для облегчения обмена информацией о проекте между MSP и другими приложениями, поддерживающими формат файла MPX, включая Primavera Project Planner, Sciforma и Timerline Precision Estimating. Используя файлы MPX, вы можете передавать все виды информации из проекта в другую систему, например подробную информацию о назначении ресурсов, информацию календаря или информацию из диалогового окна «Информация о проекте».

В Microsoft Project 4.0 появилась поддержка создания и чтения форматов файлов MPX, которые продолжали использоваться в Microsoft Project 98. Однако поддержка создания файлов MPX прекращена в выпуске Microsoft Project 2000, а версии до Microsoft Project 2010 поддерживают только чтение MPX. Формат файла MPX не поддерживается в более поздних версиях, чем MSP 2010.

## Формат файла MPX ##

В этом разделе приведен обзор спецификаций файла MPX. Полные спецификации можно найти в этой [Базе знаний] (https://support.microsoft.com/en-us/office/file-formats-supported-by-project-desktop-face808f-77ab-4fce-9353-14144ba1b9ae) статью и могут быть переданы для деталей.

### Записи ###

Запись файла MPX состоит из информации о проекте. Существуют различные типы записей, где каждая запись имеет свой собственный порядок. Каждый тип записи идентифицируется своим номером записи. Для файла MPX необходимо содержать тип записи «Создание файла». Другие типы записей не являются обязательными. В следующей таблице показаны все типы записей, их номера записей и количество записей каждого типа, которое может содержаться в файле MPX. Включение записи в файл MPX должно следовать порядку таблицы, а комментарии должны быть вставлены в любом месте.

|Имя записи|Номер записи|Максимальное количество записей
---|---|---|
|Создание файла (обязательно)|нет|1
|Настройки валюты|10|1
|Настройки по умолчанию|11|1
|Настройки даты и времени|12|1
|Определение базового календаря|20|250
|Базовые календарные часы|25| 7 на запись определения базового календаря
|Исключение базового календаря|26| 250 на запись определения базового календаря
|Заголовок проекта|30|1
|Определение таблицы текстовых ресурсов|140|1- (Или вы можете использовать запись определения таблицы числовых ресурсов)
|Определение таблицы числовых ресурсов|41|1
|Ресурс|50|9 999
|Примечания к ресурсам|51| 1 на запись ресурса
|Определение календаря ресурсов|55| 1 на запись ресурса
|Часы Календаря Ресурса|56| 7 на каждый ресурсный календарь
|Исключение календаря ресурсов| 57|250 на календарь ресурсов
|Текстовое определение таблицы задач|60|1 (Или вы можете использовать запись числового определения таблицы задач)
|Определение таблицы числовых задач|61|1
|Задание|70|9
|Примечания к задачам|71| 1 на запись задачи
|Повторяющаяся задача|72| 1 на запись задачи
|Назначение ресурсов|75| 100 на запись задачи
|Назначение полей рабочей группы|76| 1 на запись назначения
|Имена проектов|80|500
|Ссылки клиентов DDE и OLE|81|500
|Комментарии|0|неограниченно

### Структура файла ###

Файл MPX состоит из упомянутых выше записей, которые расположены внутри файла заранее установленным образом. Подробности об этих типах записей обсуждаются ниже:

**Запись о создании файла (FCR):** Это обязательная запись, целью которой является определение:

* Формат файла (MPX)
* Список символов-разделителей, используемых в файле
* Номер программы и версии, использованные для создания файла
* Номер версии формата файла MPX, используемого в файле
* Кодовая страница, используемая для создания файла

Это должна быть первая запись в файле. При экспорте из Microsoft Project символ-разделитель списка указывается в пункте «Региональные настройки» Панели управления Windows. Запись FCR включает следующие поля:

* MPX, за которым сразу следует символ-разделитель списка
* Название/идентификатор программы
* Номер версии файла
* Кодовая страница (850, 437, MAC, ANSI)

Например, запись может содержать информацию **MPX, Microsoft Project, 3.0**, указывающую, что запятая используется в качестве символа-разделителя списка в этом файле MPX. Версия формата MPX, используемая в файле, экспортирована из Microsoft Project версии 3.0.

**Настройки валюты** Эта запись, имеющая номер записи 10, определяет настройки параметров валюты в диалоговом окне «Параметры». Если эта запись не включена, используются текущие настройки в диалоговом окне «Параметры». Разделители тысяч и десятичных знаков задаются в пункте «Региональные настройки» панели управления Windows.
Поля, включенные в эту запись:

* Символ валюты
* Позиция символа (0 # после, 1 # перед, 2 # после с пробелом, 3 # перед с пробелом)
* Цифры валюты (0,1,2)
* Разделитель тысяч
* Десятичный разделитель

**Пример:** 10,$,1,2,",",.
В этом примере указано, что значения валюты включают знак доллара ($) перед ними, две цифры после запятой, запятая используется для разделения тысяч и точка используется в качестве десятичной точки. Поскольку символ-разделитель списка включен в поле "Разделитель тысяч", поле заключено в кавычки.

**Настройки по умолчанию:** Эта запись с номером записи 11 задает настройки для параметров по умолчанию в диалоговом окне «Параметры». Если продолжительность не указана, необходимо установить Единицу продолжительности по умолчанию для правильного расчета единицы продолжительности. Если эта запись не включена, используются текущие настройки в диалоговом окне «Параметры».
Поля, включенные в эту запись:

* Единицы продолжительности по умолчанию (0 # минут, 1 # часов, 2 # дней, 3 # недель)
* Тип продолжительности по умолчанию (0 # не фиксировано, 1 # фиксировано)
* Единицы работы по умолчанию (0 # минут, 1 # часов, 2 # дней, 3 # недель)
* Часы/день по умолчанию
* Часы по умолчанию в неделю
* Стандартная ставка по умолчанию
* Ставка сверхурочной работы по умолчанию
* Обновление статуса задачи обновляет статус ресурса (0 # нет, 1 # да)
* Разделить текущие задачи (0 # нет, 1 # да)

**Настройки даты и времени:** Эта запись, имеющая номер записи 12, определяет настройки параметров даты и времени в диалоговом окне «Параметры» и параметр «Формат даты штрихового текста» в диалоговом окне «Макет». Если эта запись не включена, используются текущие настройки в диалоговом окне «Параметры».
\\Поля, включенные в эту запись:

* Порядок дат (0 # месяц/день/год, 1 # день/месяц/год, 2 # год/месяц/день)
* Формат времени (0 # 12 часов, 1 # 24 часа)
* Время по умолчанию (количество минут после полуночи)
* Разделитель даты
* Разделитель времени
* 0:00–11:59 Текст
* с 12:00 до 23:59 Текст
* Формат даты (0-14)*
* Формат даты текста строки (0–194)*

**Определение базового календаря:** Эти записи, имеющие номер записи 20, определяют базовые календари и их рабочие и нерабочие дни недели. Настройки по умолчанию используются, если в течение дня нет записи. Настройки по умолчанию: с понедельника по пятницу для рабочих дней и суббота и воскресенье для нерабочих дней. В этой записи поле Имя является обязательным. Для каждого из дней запись 0 указывает, что день является нерабочим, а запись 1 указывает, что день является рабочим днем.
Поля, включенные в эту запись:

* Имя
* Воскресенье
* Понедельник
* Вторник
* Среда
* Четверг
* Пятница
* Суббота

**Базовые календарные часы.** Эти записи, имеющие номер записи 25, указывают рабочие часы для дней недели, если они отличаются от настроек по умолчанию. Рабочие часы по умолчанию — с 8:00 до 12:00 и с 13:00 до 17:00. Каждая запись часов базового календаря ссылается на предыдущую запись определения базового календаря. За каждой записью определения базового календаря может следовать до семи таких записей.

* День недели (1 - 7, где 1 # воскресенье и 7 # суббота)
* С момента 1
* До времени 1
* Со времени 2
* До времени 2
* Со времени 3
* До времени 3

**Исключение базового календаря:** Эти записи, имеющие номер записи 26, определяют исключения для дней и часов, указанных в предыдущих двух типах записей. За каждой записью определения базового календаря может следовать до 250 таких записей. Эти записи должны быть перечислены в хронологическом порядке. Если исключение составляет один день, вы можете оставить поле «Дата» пустым. Если время не указано, используется время по умолчанию с 8:00 до 12:00 и с 13:00 до 17:00.
Поля, включенные в эту запись:

* С даты
* На сегодняшний день
* Нерабочий/Рабочий (0 # нерабочий, 1 # рабочий)
* С момента 1
* До времени 1
* Со времени 2
* До времени 2
* Со времени 3
* До времени 3

**Заголовок проекта:** Эта запись, имеющая значение записи 30, устанавливает глобальные поля проекта, такие как дата начала и дата окончания проекта. Поля в этой записи соответствуют информации в диалоговых окнах Информация о проекте и Статистика.
Поля и вкладки, включенные в эту запись:

* Вкладка "Проект"
* Компания
* Управляющий делами
* Календарь (используется стандартно, если нет записи)
* Дата начала (для импортируемого файла рассчитывается либо это поле, либо следующее поле, в зависимости от настройки Расписание от)
* Дата окончания
* Расписание с (0 # начало, 1 # окончание)
* Текущая дата*
* Комментарии
* Расходы
* Базовая стоимость
* Действительная цена
* Работа
* Базовая работа
* Фактическая работа
* Работа
* Продолжительность*
* Базовая продолжительность*
* Фактическая продолжительность
* Процент завершения
* Базовый старт
* Базовый финиш
* Фактическое начало
* Фактическая отделка
* Стартовая дисперсия
* Финишное отклонение
* Предмет
* Автор
* Ключевые слова

**Определение таблицы текстовых ресурсов**: в этой записи перечислены поля ресурсов в том порядке, в котором они импортируются или экспортируются. Для импортированных файлов имена должны совпадать с именами полей, используемыми в Microsoft Project. Для экспортированных файлов эта запись берется из таблицы экспорта ресурса. Должна использоваться либо эта запись, либо запись определения таблицы числовых ресурсов. При экспорте из Microsoft Project включаются обе эти записи.

**Определение числовой таблицы ресурсов.** Используя числа, а не имена, эта запись перечисляет поля ресурсов в том порядке, в котором они импортируются или экспортируются. Это альтернативный метод определения полей ресурсов, включенных в каждую запись ресурсов, который полезен при определении файла MPX, созданного продуктом на иностранном языке.

**Ресурс.** Эти записи содержат информацию о каждом импортируемом или экспортируемом ресурсе. Каждая запись Resource описывает один ресурс. При импорте информации включаемые поля определяются записью определения таблицы текстовых ресурсов или записью определения таблицы числовых ресурсов. При экспорте информации включаются те поля, которые перечислены в таблице экспорта ресурса.

**Примечания к ресурсам.** Эти записи содержат примечания о непосредственно предшествующей записи ресурса. Для новой строки в примечании используется символ ASCII 127. Если примечание содержит символ-разделитель списка, заключите примечание в кавычки.

**Определение календаря ресурса:** Эти записи определяют рабочие дни для ресурса, указанного в непосредственно предшествующей записи ресурса. Для импортированных файлов, если нет записи в поле «Имя базового календаря», используется «Стандартный». Отсутствие записи для определенного дня означает, что день установлен по умолчанию (2). Если записи определения календаря ресурса отсутствуют, в качестве базового календаря для ресурса используется стандартный, а для дней используется значение по умолчанию. Для каждого из дней запись 0 указывает, что день является нерабочим, 1 указывает, что день является рабочим, а 2 указывает, что используется значение по умолчанию.

**Часы календаря ресурса:** Эти записи определяют рабочие часы для ресурса, которые отличаются от базового календаря, используемого ресурсом. Эти записи применяются к записи определения календаря ресурсов, непосредственно предшествующей этой записи. За каждой записью определения календаря ресурсов может следовать до семи таких записей.

**Исключение календаря ресурсов:** Эти записи определяют исключения для дней и часов, указанных в предыдущих двух типах записей. За каждой записью определения календаря ресурсов может следовать до 250 таких записей. Эти записи должны быть перечислены в хронологическом порядке. Если исключение составляет только один день, вы можете оставить поле «Дата» пустым. Если время не указано, используется время по умолчанию с 8:00 до 12:00 и с 13:00 до 17:00.

**Текстовая таблица задач. Определение:** В этой записи перечислены импортируемые и экспортируемые поля задач по порядку. Для импортированных файлов имена должны совпадать с именами полей, используемыми в Microsoft Project. Если файл экспортируется, эта запись поступает из таблицы экспорта задачи. При экспорте из Microsoft Project включаются обе эти записи. Поля, вычисляемые Microsoft Project, такие как «Запланированное начало» и «Запланированное окончание», при импорте игнорируются. Если у вас есть фиксированные даты начала или окончания задачи, используйте поля Тип ограничения и Дата ограничения.

**Определение числовой таблицы задач.** Используя числа, а не имена, эта запись перечисляет поля задач в том порядке, в котором они импортируются или экспортируются. Это альтернативный метод идентификации полей задач, включенных в каждую запись задачи, который полезен при определении файла MPX, созданного продуктом на иностранном языке.

**Задача:** Эти записи содержат информацию о каждой импортируемой или экспортируемой задаче. Каждая запись задачи описывает одну задачу. При импорте информации включаемые поля определяются записью определения таблицы текстовых задач или записью определения таблицы числовых задач. При экспорте информации включаются те поля, которые перечислены в таблице экспорта задачи.

**Примечания к задаче.** Эти записи содержат примечания о непосредственно предшествующей записи задачи. Используйте символ ASCII 127 для обозначения новой строки в примечании. Если примечание содержит символ-разделитель списка, заключите примечание в кавычки.

**Назначение ресурсов**: в этих записях содержится информация о ресурсах, назначенных задаче, которая была определена в предыдущей записи задачи. Если вы объединяете файлы и хотите сохранить информацию о назначении ресурсов, вам необходимо включить эту информацию в файл MPX. При объединении все существующие назначения объединенных задач будут удалены. Если вы объединяете файлы на основе уникальных идентификаторов, ресурсы назначаются с использованием уникальных идентификаторов ресурсов, а не идентификаторов.

**Поля рабочей группы назначения ресурсов:** В этих записях перечислены сведения, которые сохраняются с каждым назначением для функций рабочей группы Microsoft Project 4.0 и 4.1. Если вы используете функции рабочей группы, вам необходимо включить эту запись, чтобы гарантировать, что никакая информация не будет потеряна.

**Имена проектов:** В этих записях перечислены все имена ссылок DDE, хранящиеся в проекте.

**Ссылки клиента DDE и OLE:** В этих записях перечислены ссылки DDE на проект.

**Комментарии.** Эти записи можно использовать для добавления комментариев к файлу, и они могут отображаться в любом месте файла. Каждая запись комментариев должна начинаться с «0».

## Проблемы с открытием файла MPX ##

Вот список некоторых распространенных проблем, которые могут возникнуть и привести к неправильной работе формата MPX:

* Отсутствие сопутствующего ПО
* Поврежденный файл
* Зараженный файл из-за вируса
* Нет прав доступа в системе для открытия файлов
* Устаревший диск в вашей системе
* Расширение файла переименовано

## Использованная литература ##

* [MPX — база знаний Майкрософт] (https://support.microsoft.com/en-us/office/file-formats-supported-by-project-desktop-face808f-77ab-4fce-9353-14144ba1b9ae)

