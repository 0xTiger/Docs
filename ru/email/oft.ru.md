{
  "date" : "2019-10-11",
  "author" : {
    "display_name" : "Kashif Iqbal"
},
  "draft" : "false",
  "toc" : true,
  "title" :"OFT — файл шаблона электронной почты Microsoft Outlook",
  "description":"Узнайте о формате файла OFT и API-интерфейсах, которые могут создавать и открывать файлы OFT.",
  "linktitle" : "OFT",
  "menu" : {
    "docs" : {
      "parent" : "email"
}
},
  "lastmod" : "2019-09-10"
}

## .OFT вариант №

Файлы с расширением .oft представляют собой файлы шаблонов, созданные с помощью Microsoft Outlook. Предварительно отформатированный макет, установленный для шаблонов сообщений, затем используется для отправки электронных писем с общей информацией для экономии времени. Такие файлы можно создать, создав новое электронное письмо, добавив необходимую информацию, а затем используя раскрывающийся список «Сохранить как шаблон Office» (.oft) в Microsoft Outlook. Пользователи могут открывать файлы OFT, дважды щелкнув по ним, и они откроются в соответствующем приложении в этой конкретной системе.

## Структура файла OFT ##

Формат файла .OFT использует в своей основе формат файла [MSG](/ru/email/msg/). Единственное отличие состоит в том, что файлы OFT имеют CLSID_TemplateMessage ({0006F046-0000-0000-C000-000000000046}) в качестве класса хранения (WriteClassStg), а файлы MSG используют CLSID_MailMessage ({00020D0B-0000-0000-C000-000000000046}).

Формат CFB_3 является основой файла MSG. Парадигма основана на концепциях хранилищ и потоков, довольно близких к каталогам и файлам. Таким образом, основное отличие первого заключается в том, что вся иерархия упакована в отдельный файл, называемый составным файлом. Объекты составляют файлы сообщений и состоят из одного свойства или его коллекций. Эта возможность позволяет приложениям хранить сложные структурированные данные в одном файле. Этот формат также определяет несколько хранилищ, каждое хранилище представляет объект Message в качестве основного компонента. Эти хранилища содержат ряд потоков, представляющих свойство этого компонента. Также возможно вложение хранилища.

### Свойства ОФТ

На верхнем уровне файла .msg хранилища содержат потоки, в которых хранятся свойства. Недвижимость можно классифицировать следующим образом:

* Свойства фиксированной длины
* Свойства переменной длины
* Многозначные свойства

Независимо от категории свойство является либо помеченным, либо именованным. Однако для именованных свойств требуется подходящая информация о сопоставлении, как указано в их хранилище сопоставления.

### Хранилища OFT

Хранилища составляют ключевые компоненты объекта Message. В формате файла MSG указаны следующие хранилища:

### Структура верхнего уровня

Объект сообщения представляет собой весь верхний уровень формата файла Msg. В зависимости от типа, свойств, количества объектов-получателей и вложений объект сообщения может иметь различные хранилища потока в соответствующем файле .MSG.

#### Связь с другими структурами

Формат файла MSG/OFT имеет следующие связи с другими структурами:

* Основой .msg является составной двоичный формат файла.
* Свойства, используемые протоколом объектов сообщений и вложений, используются в этом формате.

## использованная литература

* [[MS-OXMSG]: формат файла Outlook MSG] (https://msdn.microsoft.com/en-us/library/cc463912(v#exchg.80).aspx)

