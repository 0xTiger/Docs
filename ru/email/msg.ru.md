{
  "date" : "2019-10-11",
  "author" : {
    "display_name" : "Kashif Iqbal"
},
  "draft" : "false",
  "toc" : true,
  "title" :"MSG — формат электронной почты Microsoft Outlook",
  "description":"Узнайте о формате файлов MSG и API, которые могут создавать и открывать файлы MSG.",
  "linktitle" : "MSG",
  "menu" : {
    "docs" : {
      "parent" : "email"
}
},
  "lastmod" : "2019-09-10"
}

## .MSG вариант №

MSG — это формат файла, используемый [Microsoft Outlook](https://products.office.com/en-us/outlook/email-and-calendar-software-microsoft-outlook?rtc#1) и Exchange для хранения сообщений электронной почты. , контакт, встречу или другие задачи. Такие сообщения могут содержать одно или несколько полей электронной почты с указанием отправителя, получателя, темы, даты и тела сообщения или контактной информации, сведений о встрече и одной или нескольких спецификаций задачи. Свойства, составляющие объект Message, в том числе также являются частью файла MSG. Файл MSG имеет заголовки, основное тело сообщения и гиперссылки в виде простого текста ASCII. Файлы MSG также подходят для программ, которым требуется интерфейс программирования приложений обмена сообщениями Microsoft (MAPI).

## Структура файла MSG

Формат CFB_3 является основой файла MSG. Парадигма основана на концепциях хранилищ и потоков, довольно близких к каталогам и файлам. Таким образом, основное отличие первого заключается в том, что вся иерархия упакована в отдельный файл, называемый составным файлом. Объекты составляют файлы сообщений и состоят из одного свойства или его коллекций. Эта возможность позволяет приложениям хранить сложные структурированные данные в одном файле. Этот формат также определяет несколько хранилищ, каждое хранилище представляет объект Message в качестве основного компонента. Эти хранилища содержат ряд потоков, представляющих свойство этого компонента. Также возможно вложение хранилища.

## Мапи Свойства

На верхнем уровне файла .msg хранилища содержат потоки, в которых хранятся свойства. Недвижимость можно классифицировать следующим образом:

* Свойства фиксированной длины
* Свойства переменной длины
* Многозначные свойства

Независимо от категории свойство является либо помеченным, либо именованным. Однако для именованных свойств требуется подходящая информация о сопоставлении, как указано в их хранилище сопоставления.

## Хранилища

Хранилища составляют ключевые компоненты объекта Message. В формате файла MSG указаны следующие хранилища:

## Структура верхнего уровня

Объект сообщения представляет собой весь верхний уровень формата файла MSG. В зависимости от типа, свойств, количества объектов-получателей и вложений объект сообщения может иметь различные хранилища потока в соответствующем файле .MSG.

### Связь с другими структурами

Формат файла Msg имеет следующие отношения с другими структурами:

* Основой .msg является составной двоичный формат файла.
* Свойства, используемые протоколом объектов сообщений и вложений, используются в этом формате.

## Сценарии, чтобы избежать форматов MSG

Объект сообщения может совместно использоваться клиентами или хранилищами сообщений, использующими файловую систему .msg. Существует несколько обстоятельств, при которых хранение объекта Message в формате файла .msg было бы неуместным. Например:

* В случае поддержки большого автономного архива лучше использовать полнофункциональный формат, в котором представления могут быть отрисованы более точно.
* Если получатель неизвестен, возможно, формат не поддерживается получателем, и могут быть доставлены частные или нерелевантные сообщения.

## Пример файла MSG

Чтобы получить представление о том, как выглядит файл MSG, вы можете загрузить [пример файла MSG](https://products.conholdate.app/viewer/view/mL7cmq6qYbcNG329P/sample-msg-file.msg) и открыть на своем компьютер для просмотра его содержимого.

## использованная литература

* [[MS-OXMSG]: формат файла Outlook MSG](https://msdn.microsoft.com/en-us/library/cc463912(v#exchg.80).aspx)

