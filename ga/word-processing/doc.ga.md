{
  "date": "2019-12-03",
  "keywords": [
"doc",
"comhad",
"síneadh",
"formáid comhaid",
"Focal",
"Doiciméad"
],
  "author": {
    "display_name": "Kashif Iqbal"
},
  "draft": "false",
  "toc": true,
  "title": "DOC - Comhad Doiciméad Microsoft Word",
  "description": "Foghlaim faoi fhormáid comhaid DOC agus APIanna ar féidir comhaid DOC a chruthú agus a oscailt.",
  "linktitle": "DOC",
  "menu": {
    "docs": {
      "parent": "word-processing",
      "identifier": "word-processing-do-gac"
}
},
  "lastmod": "2019-12-03"
}

## Cad is comhad DOC ann?

Is ionann comhaid le síneadh .doc agus doiciméid ginte ag Microsoft Word nó doiciméid próiseála focal eile i bhformáid dhénártha comhaid. Úsáideadh an síneadh ar dtús le haghaidh doiciméadú gnáth-théacs ar go leor córais oibriúcháin éagsúla. Féadfaidh sé go bhfuil go leor cineálacha éagsúla sonraí ar nós íomhánna, formáidithe chomh maith le gnáth-théacs, graif, cairteacha, rudaí leabaithe, naisc, leathanaigh, formáidiú leathanaigh, socruithe priontála agus go leor eile. Bhí an-tóir ar an bhformáid do gach cineál doiciméad mar gheall ar na roghanna éagsúla a thairgeann sé d’úsáideoirí chun lámhleabhair, moltaí, sonraíochtaí, achoimrí, ailt nó aon doiciméid dá samhail a scríobh. Is é [DOCX](/word-processing/docx/) an leagan nuashonraithe de DOC atá bunaithe ar Office OpenXML a bhfuil a sonraíochtaí ar fáil go hoscailte.

## Stair Ghearr ##

WordPerfect, a product of [Corel](https://www.corel.com/en/), used DOC as the extension of their proprietary format. In 1980s, WordPerfect remained the choice of usage on most of the computers due to its easy availability, conformance with most computer machines and Operating systems. However, WordPerfect saw its downfall on Windows OS when Microsoft introduced Microsoft Word as its product for documents file format and chose DOC extension for their proprietary format. As Microsoft Word became more and more popular, the DOC file format underwent several revisions from Microsoft Word 97 - 2003. Ba é 2007 é nuair a cuireadh formáid Office Open XML (ar a dtugtar DOCX) in ionad na formáid comhaid DOC réamhshocraithe agus úsáideann na leaganacha nua de Microsoft Word an síneadh nua seo anois mar fhormáid réamhshocraithe comhaid.

## Sonraíochtaí Formáid Chomhaid DOC - Tuilleadh Eolais

Microsoft didn't release the DOC file format specifications for a long time until 2008. In Feb 2008, format specifications were released for .doc file format under the Microsoft Open Specification Promise. Though the specification does not describe all of the features used by the DOC format, it gives ample information about the knowledge required to work with this file format. Still, reverse engineering is required to make use of the available information. The specifications have been updated several times and the latest [revision](https://msdn.microsoft.com/en-us/library/cc313153(v#office.12).aspx) is 8.0 which was updated as of August 2018.

### Roinnt Bunchoincheapa ###

Sula ndéanaimid aon sonraí faoi na sonraíochtaí formáid comhaid le haghaidh DOC, is gá roinnt coincheapa bunúsacha a thuiscint chun oibriú leis an bhformáid comhaid seo.

**Bunachar Faisnéise Comhad (Fib):** Tá faisnéis faoin doiciméad i struchtúr Fib agus sonraítear leideanna an chomhaid do chodanna éagsúla den doiciméad.
Is struchtúr faid athraitheach é an Fib. Cé is moite den bhunchuid atá socraithe i méid, cuirtear réimse comhairimh roimh gach cuid a shonraíonn méid na chéad roinne eile.

**Suíomh Carachtair:** Seasann CP nó Seasamh Carachtair slánuimhir 32-giotán gan síniú a fheidhmíonn mar innéacs bunaithe ar nialas de charachtair i dtéacs an doiciméid. Ní féidir suíomh agus méid gach carachtar sa chomhad a aisghabháil go díreach agus ní mór é a ríomh le algartam réamhshonraithe. I measc na gcarachtar tá:

* Téacs an doiciméid

* Ancairí rudaí cosúil le fonótaí nó boscaí téacs

* Carachtair rialaithe ar nós marcanna alt agus marcanna cille tábla


**PLC:** Is éard atá i struchtúr PLCanna ná sraith de CPanna agus raon d’eiliméid sonraí ina dhiaidh sin. Caithfidh na heilimintí sonraí d'aon PLC a bheith ar an méid céanna de nialas nó níos mó beart, agus ar an gcúis seo, ní mór líon na CPanna a bheith ceann amháin níos mó ná líon na n-eilimintí sonraí. Is de chineálacha éagsúla iad struchtúir PLC ina sonraíonn gach cineál cibé acu an gceadaítear TDanna dúblacha don chineál sin nó nach gceadaítear. Tá struchtúr PLC comhdhéanta de:

* **aCP (fad inathraithe):** Sraith eilimintí CP. Sonraíonn gach cineál struchtúir **PLC** brí na n-eilimintí CP agus an raon ceadaithe.

* **aSonraí (fad inathraithe):** Sonraíonn gach cineál struchtúir **PLC** struchtúr agus brí na n-eilimintí sonraí, aon srianta ar líon na n-eilimintí sonraí, agus aon srianta ar na sonraí atá iontu. Sonraítear ann freisin an gaol idir na heilimintí sonraí agus na TDanna comhfhreagracha.


**Roghnú Bailí:** Déantar cur síos go príomha ar chomhdhéanamh comhaid .DOC i raon TDanna. Tá roinnt [rules](https://msdn.microsoft.com/en-us/library/dd908861(v#office.12).aspx) sonraithe ag Microsoft le leanúint sa chás sin.

**STTB:** Teaghrán tábla é an STTB atá comhdhéanta de cheanntásc a bhfuil sraith eilimintí ina dhiaidh. Sonraíonn an luach **cData** líon na n-eilimintí atá san eagar.

**Stóráil Maoine:** D’fhéadfadh gnéithe éagsúla a bheith i gcomhad focal, mar shampla téacs, paragraif, táblaí, pictiúir agus codanna ina bhféadfaidh gach ceann acu a chuid airíonna féin a bheith acu. Stóráiltear airíonna díobh seo sa chomhad Word mar dhifríochtaí ón réamhshocrú. Sonraítear difríochtaí den sórt sin ag PRl arb é atá ann Mionathraitheoir Aonair Maoine (Sprm) agus a operand. Is féidir le hiarratas an tacar maoine deiridh a chinneadh trí liostaí **Prl**s a chur i bhfeidhm.

**Cosaint Focal Faire:** Is féidir comhaid Word a chosaint ag pasfhocal freisin, agus is féidir ceann de na meicníochtaí seo a leanas a úsáid ina leith.

* Obfuscation XOR

* Oifig dhénártha doiciméad RC4 criptithe

* Oifig dhénártha doiciméad RC4 CryptoAPI criptithe


Más 1 iad FibBase.fEncrypted agus FibBase.fObfuscation araon, cuirtear bac ar an gcomhad trí úsáid a bhaint as obfuscation XOR.

Má tá FibBase.fEncrypted 1 agus FibBase.fObfuscation 0, tá an comhad criptithe trí úsáid a bhaint ceachtar Oifig Dénártha Doiciméad RC4 Criptiú nó Oifig Dénártha Doiciméad RC4 CryptoAPI Criptiú, leis an EncryptionHeader stóráilte sa chéad beart FibBase.lKey den sruth Tábla. Sonraíonn an EncryptionHeader.EncryptionVersionInfo cén meicníocht criptiúcháin a úsáideadh chun an comhad a chriptiú.

### Struchtúr Comhad ###

Comhad cumaisc OLE a chuimsíonn roinnt stórais agus sruthanna is ea comhad dénártha Word ina bhunúlacht. Tá a struchtúr agus a méideanna féin ag na stórais agus na sruthanna seo, a shonraíonn na paraiméadair don scríobh agus don léitheoireacht. Is iad seo:

#### WordDocument Stream ####

This stream contains the document text and other information referenced from other parts of the file. The stream has no predefined structure other than the FIB at the beginning which is mandatory and should be at offset 0. Níor cheart go mbeadh an sruth seo níos mó ná 2147 MB.

#### 1TableStream nó 0TableStream ####

Is féidir le Sruthanna Tábla ar a dtugtar sruth 1Table nó sruth 0Table a bheith i gcomhad dénártha Word. Ba chóir go mbeadh ceann amháin díobh seo ar a laghad sa doiciméad. Mar sin féin, má tá an dá shruth 1Table agus 0Table i ndoiciméad, ní úsáidtear ach an sruth dá dtagraítear ag base.fWhichTblStm. NÍ MÓR neamhaird a dhéanamh den sruth gan tagairt.
NÍ MÓR NACH bhfuil an Sruth Tábla níos mó ná 2147 MB.

#### Sruth Sonraí ####

Níl aon struchtúr réamhshainithe ag an sruth Sonraí. Tá sonraí ann a ndéantar tagairt dóibh ón FIB nó ó chodanna eile den chomhad. Ní gá go mbeadh an sruth seo i láthair mura bhfuil tagairtí dó. NÍ MÓR NACH bhfuil an sruth Sonraí níos mó ná 2147 MB.

#### Stóráil Linn Snámha ####

Tá stórais do réada OLE leabaithe sa stóras Object Pool. Ní gá go mbeadh an stóras seo i láthair mura bhfuil aon réada OLE leabaithe sa doiciméad.

#### Stóráil Sonraí XML Saincheaptha ####

Is stóras roghnach é an Stóráil Sonraí Saincheaptha XML agus NÍ MÓR a hainm a bheith MsoDataStore”.

#### Sruth Faisnéise Achoimre ####

Is sruth roghnach é an sruth Faisnéise Achoimre a NÍ MÓR a ainm a bheith \005SummaryInformation, áit arb é \005 an carachtar le luach 0x0005, agus ní an teaghrán litriúil \005.

#### Sruth Faisnéise Achoimre Doiciméid ####

Is sruth roghnach é an sruth Faisnéise Achoimre Doiciméid a NÍ MÓR an t-ainm a bheith air \005DocumentSummaryInformation, áit arb é \005 an carachtar le luach 0x0005, ní an teaghrán litriúil \005.

#### Sruth Criptithe

Is sruth roghnach é an sruth Criptithe a NÍ MÓR a ainm a bheith mar criptiúchán. NÍ MÓR NACH bhfuil an sruth seo i láthair mura gcomhlíontar an dá choinníoll seo a leanas:

* Tá an doiciméad criptithe le Doiciméad Dénártha na hOifige RC4 CryptoAPI Criptiú.

* Tá an luach fDocProps socraithe sa EncryptionHeader.Flags.


#### Stóráil Macraí

Is stóras roghnach é an stóráil Macraí ina bhfuil na macraí don chomhad. Má tá sé i láthair, NÍ MÓR é a bheith ina Stóráil Fréamh Tionscadail.

#### Stóráil Sínithe XML

Is stóras roghnach é an stóras sínithe XML agus NÍ MÓR di a bheith mar \_xmlsignatures.

#### Sruth Sínithe

Is sruth roghnach é an sruth sínithe agus NÍ MÓR a ainm a bheith mar \_signatures. Tá sínithe digiteacha sa sruth seo.

#### Stóráil Spáis Sonraí um Bainistíocht Cearta Faisnéise

Is stóras roghnach é an stóráil Spás Sonraí um Bainistíocht Cearta Faisnéise a NÍ MÓR a hainm a bheith \006DataSpaces, áit arb é \006 an carachtar le luach 0x0006, agus ní an teaghrán litriúil \006. Má tá an stóráil seo i láthair, NÍ MÓR an Sruth Ábhar Cosanta a bheith i láthair freisin.
Má tá an stóráil seo i láthair, BA CHÓIR gach sruth agus stóras sonraithe seachas an stóras seo agus an Sruth Ábhar Cosanta a léamh ón Sruth Ábhar Cosanta mar atá sonraithe in [MS-OFFCRYPTO] agus má tá aon cheann de na sruthanna agus na stórais sin ann lasmuigh den Ábhar Cosanta Sruthán, BA CHÓIR neamhaird a dhéanamh díobh.

#### Sruth Ábhar Cosanta

Is sruth roghnach é an Sruth Ábhar Cosanta a NÍ MÓR a ainm a bheith \009DRMContent, áit arb é \009 an carachtar le luach 0x0009, agus ní an teaghrán litriúil \009.
Má tá an sruth seo i láthair, NÍ MÓR an Stóráil Spáis Sonraí um Bainistíocht Cearta Faisnéise a bheith i láthair freisin.

## Tagairtí ##

* [Sonraíochtaí Foirmithe Comhad MS-DOC](https://msdn.microsoft.com/en-us/library/cc313153(v#office.12).aspx)

* [Doc Ríomhaireachta](https://en.wikipedia.org/wiki/Doc_(computing))


