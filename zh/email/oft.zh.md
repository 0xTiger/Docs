{
  "date" : "2019-10-11",
  "author" : {
    "display_name" : "Kashif Iqbal"
},
  "draft" : "false",
  "toc" : true,
  "title" :"OFT - Microsoft Outlook 电子邮件模板文件",
  "description":"了解 OFT 文件格式和可以创建和打开 OFT 文件的 API。",
  "linktitle" : "OFT",
  "menu" : {
    "docs" : {
      "parent" : "email"
}
},
  "lastmod" : "2019-09-10"
}

## 什么是一 .oft 文件？

带有 .oft 扩展名的文件是使用 Microsoft Outlook 创建的模板文件。消息模板的预格式化布局集随后用于发送包含通用信息的电子邮件以节省时间。可以通过创建新电子邮件、添加必要信息然后使用 Microsoft Outlook 中的另存为 Office 模板 (.oft) 下拉菜单来生成此类文件。用户可以通过双击打开 OFT 文件，它将在该特定系统上的相关应用程序中打开。

## OFT 文件结构##

.OFT 文件格式在其基础上使用 [MSG](/zh/email/msg/) 文件格式。唯一不同的是，OFT 文件使用 CLSID_TemplateMessage ({0006F046-0000-0000-C000-000000000046}) 作为存储类 (WriteClassStg)，而 MSG 文件使用 CLSID_MailMessage ({00020D0B-0000-0000-C000-000000000046})。

CFB_3 格式是 MSG 文件的基础。该范例基于存储和流概念，非常接近目录和文件。因此，前者的一个主要区别是整个层次结构，打包成一个不同的文件，称为复合文件。对象构成消息文件并由单个属性或其集合组成。这种能力有助于应用程序将复杂的结构化数据存储在单个文件中。这种格式还指定了多个存储，每个存储都将消息对象表示为一个主要组件。这些存储包含许多表示该组件属性的流。也可以嵌套存储。

### OFT 属性

在 .msg 文件的顶层，存储包含在其中存储属性的流。属性可以分类如下：

* 固定长度属性
* 可变长度属性
* 多值属性

无论类别如何，属性要么是标记的，要么是命名的。但是，命名属性需要合适的映射信息，由它们的映射存储指定。

### OFT 存储

存储构成 Message 对象的关键组件。 MSG 文件格式规定了以下存储：

### 顶层结构

Message 对象表示整个 Msg 文件格式的顶层。根据类型、属性、收件人和附件对象的数量，消息对象可以在其相应的 .MSG 文件中具有不同的流存储。

#### 与其他结构的关系

MSG/OFT 文件格式与其他结构有以下关系：

* .msg 的基础是复合文件二进制文件格式。
* 此格式使用消息和附件对象协议使用的属性。

## 参考

* [[MS-OXMSG]: Outlook MSG 文件格式](https://msdn.microsoft.com/en-us/library/cc463912(v#exchg.80).aspx)

