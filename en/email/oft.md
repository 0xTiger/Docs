{
  "date": "2019-10-11",
  "author": {
    "display_name": "Kashif Iqbal"
  },
  "draft": "false",
  "toc": true,
  "title": "OFT - Microsoft Outlook Email Template File",
  "description": "Learn about OFT file format and APIs that can create and open OFT files.",
  "linktitle": "OFT",
  "menu": {
    "docs": {
      "parent": "email",
      "identifier": "email-oft"
    }
  },
  "lastmod": "2019-09-10"
}

## What is an OFT file?

Files with .oft extension are template files that are created using Microsoft Outlook. The pre-formatted layout set for message templates is then used for sending out emails with common information to save time. Such files can be generated by creating a new email, adding necessary information and then using the Save As Office Template (.oft) dropdown from Microsoft Outlook. Users can open the OFT files by double clicking on it and it will open in associated application on that particular system.

## OFT File Structure ##

The .OFT file format uses the [MSG](/email/msg/) file format at its base. The only difference is that OFT files have CLSID_TemplateMessage ({0006F046-0000-0000-C000-000000000046}) as the storage class (WriteClassStg), while MSG files use CLSID_MailMessage ({00020D0B-0000-0000-C000-000000000046}).

CFB_3 format is the base of MSG file. The paradigm is based on the storages and streams concepts, quite close to directories and files. Therefore a major difference in the former is the entire hierarchy, packaged into a distinct file, called a compound file. Objects constitute the message files and consist of a single property or its collections. This ability facilitates applications to store intricate, structured data in a single file. This format also specifies multiple storages, each storage represents the Message object as a major component. These storages contain a number of streams representing a property of that component. Nesting of storage is also possible.

### OFT Properties

At the top level of the .msg file, storages contain streams that store properties in them. Properties can be categorized as follows:

* Fixed length properties
* Variable length properties
* Multiple-valued properties

Irrespective of the category, a property is either a tagged or named. However, suitable mapping information is required for named properties as specified by their mapping storage.

### OFT Storages

Storages constitute the key components of the Message object. MSG file format states the following storages:

### Top Level Structure

Message object represents the entire top level of the Msg file format. Depending upon the type, properties, number of recipient and Attachment objects, a message object can have different stream storages in its corresponding .MSG file.

#### Relationship with Other Structures

The MSG/OFT file format has the following relationships to other structures:

* The base of .msg is Compound File Binary File Format.
* The properties used by Message and Attachment Object Protocol is used by this format.

## References

* [[MS-OXMSG]: Outlook MSG File Format](https://msdn.microsoft.com/en-us/library/cc463912(v#exchg.80).aspx)
